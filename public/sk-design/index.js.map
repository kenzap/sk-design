{"version":3,"file":"index.js","sources":["../../node_modules/@kenzap/k-cloud/index.js","../../src/_/_helpers.js","../../src/_/_cnt_product_edit_sk_design.js","../../src/_/_2d.js","../../src/sk-design/index.js"],"sourcesContent":["/**\n * @name initHeader\n * @description Initiates Kenzap Cloud extension header and related scripts. Verifies user sessions, handles SSO, does cloud space navigation, initializes i18n localization. \n * @param {object} response\n */\nexport const initHeader = (response) => {\n\n    // cache header from backend\n    if(response.header) localStorage.setItem('header', response.header);\n  \n    // load header to html if not present\n    if(!document.querySelector(\"#k-script\")){\n  \n        let child = document.createElement('div');\n        child.innerHTML = localStorage.getItem('header');\n        child = child.firstChild;\n        document.body.prepend(child);\n  \n        // run header scripts\n        Function(document.querySelector(\"#k-script\").innerHTML).call('test');\n    }\n  \n    // load locales if present\n    if(response.locale) window.i18n.init(response.locale); \n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nexport const __init = (locale) => {\n\n    if(typeof locale !== 'object' || locale === null) return;\n\n    if(typeof window.i18n === 'undefined') window.i18n = {};\n\n    if(typeof window.i18n.state === 'undefined') window.i18n.state = { locale: {} };\n   \n    window.i18n.state.locale = locale;\n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nexport const __ = (text, ...p) => {\n\n    let match = (input, pa) => {\n\n        pa.forEach((p, i) => { input = input.replace('%'+(i+1)+'$', p); }); \n        \n        return input;\n    }\n\n    if(typeof window.i18n === 'undefined') return match(text, p);\n    if(window.i18n.state.locale.values[text] === undefined) return match(text, p);\n\n\n\n    return match(window.i18n.state.locale.values[text], p);\n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param cb {Function} callback function to escape text variable\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nconst __esc = (text, cb, ...p) => {\n\n    let match = (input, pa) => {\n\n        pa.forEach((p, i) => { input = input.replace('%'+(i+1)+'$', p); }); \n        \n        return input;\n    }\n\n    if(typeof window.i18n === 'undefined') return match(text, p);\n    if(window.i18n.state.locale.values[text] === undefined) return match(text, p);\n\n    return match(cb(window.i18n.state.locale.values[text]), p);\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const attr = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&apos;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities and does translation\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __attr = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    let cb = (text) => {\n\n        return text.replace(/[<>'\"]/g, tag => (\n            {\n                '&': '&amp;',\n                '<': '&lt;',\n                '>': '&gt;',\n                \"'\": '&apos;',\n                '\"': '&quot;'\n            } [tag]));\n    }\n\n    return __esc(text, cb, ...p);\n}\n\n/*\n * Removes special characters `<`, `>`, `\"`, `'` from the link.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const src = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[<>'\"]/g, tag => (\n        {\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&apos;',\n            '\"': '&quot;'\n        } [tag]));\n    \n}\n\n/*\n * Converts special characters `<`, `>`, `\"`, `'` from the link and does translation\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __src = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    let cb = (text) => {\n\n        return text.replace(/[<>'\"]/g, tag => (\n            {\n                '<': '&lt;',\n                '>': '&gt;',\n                \"'\": '&apos;',\n                '\"': '&quot;'\n            } [tag]));\n    }\n\n    return __esc(text, cb, ...p);\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const html = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&apos;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities and does translations\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __html = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    let cb = (text) => {\n\n        return text.replace(/[&<>'\"]/g, tag => (\n            {\n                '&': '&amp;',\n                '<': '&lt;',\n                '>': '&gt;',\n                \"'\": '&apos;',\n                '\"': '&quot;'\n            } [tag]));\n    }\n\n    return __esc(text, cb, ...p);\n}\n\n/**\n * @name showLoader\n * @description Initiates full screen three dots loader.\n */\nexport const showLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'block';\n}\n\n/**\n * @name hideLoader\n * @description Removes full screen three dots loader.\n */\nexport const hideLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'none';\n}\n\n/**\n * @name initFooter\n * @description Removes full screen three dots loader.\n * @param {string} left - Text or html code to be present on the left bottom side of screen\n * @param {string} right - Text or html code to be present on the left bottom side of screen\n */\nexport const initFooter = (left, right) => {\n\n    document.querySelector(\"footer .row\").innerHTML = `\n    <div class=\"d-sm-flex justify-content-center justify-content-sm-between\">\n        <span class=\"text-muted text-center text-sm-left d-block d-sm-inline-block\">${left}</span>\n        <span class=\"float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted\">${right}</span>\n    </div>`;\n}\n\n/**\n * @name link\n * @description Handles Cloud navigation links between extensions and its pages. Takes care of custom url parameters.\n * @param {string} slug - Any inbound link\n * \n * @returns {string} link - Returns original link with kenzp cloud space ID identifier.\n */\nexport const link = (slug) => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let sid = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    let postfix = slug.indexOf('?') == -1 ? '?sid='+sid : '&sid='+sid;\n\n    return slug + postfix;\n}\n\n/**\n * @name getSiteId\n * @description Gets current Kenzap Cloud space ID identifier from the URL.\n * \n * @returns {string} id - Kenzap Cloud space ID.\n */\nexport const getSiteId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\n/**\n * @name spaceID\n * @description Gets current Kenzap Cloud space ID identifier from the URL.\n * \n * @returns {string} id - Kenzap Cloud space ID.\n */\n export const spaceID = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\n/**\n * @name setCookie\n * @description Set cookie by its name to all .kenzap.cloud subdomains\n * @param {string} name - Cookie name.\n * @param {string} value - Cookie value.\n * @param {string} days - Number of days when cookie expires.\n */\n export const setCookie = (name, value, days) => {\n\n    let expires = \"\";\n    if (days) {\n        let date = new Date();\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n        expires = \";expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + (escape(value) || \"\") + expires + \";path=/;domain=.kenzap.cloud\"; \n}\n\n/**\n * @name getCookie\n * @description Read cookie by its name.\n * @param {string} cname - Cookie name.\n * \n * @returns {string} value - Cookie value.\n */\nexport const getCookie = (cname) => {\n\n    let name = cname + \"=\";\n    let decodedCookie = decodeURIComponent(document.cookie);\n    let ca = decodedCookie.split(';');\n    for (let i = 0; i < ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n\n/**\n * @name checkHeader\n * @description This function tracks UI updates, creates header version checksum and compares it after every page reload\n * @param {object} object - API response.\n */\n export const checkHeader = () => {\n\n    let version = (localStorage.hasOwnProperty('header') && localStorage.hasOwnProperty('header-version')) ? localStorage.getItem('header-version') : 0;\n    let check = window.location.hostname + '/' + spaceID() + '/' + getCookie('locale');\n    if(check != getCookie('check')){ version = 0; console.log('refresh'); }\n    \n    setCookie('check', check, 5);\n\n    return version\n}\n\n/**\n * @name headers\n * @description Default headers object for all Kenzap Cloud fetch queries. \n * @param {object} headers\n */\n export const headers = {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json',\n    'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n    'Kenzap-Locale': getCookie('locale') ? getCookie('locale') : \"en\",\n    'Kenzap-Header': checkHeader(),\n    'Kenzap-Token': getCookie('kenzap_token'),\n    'Kenzap-Sid': spaceID(),\n}\n\n/**\n * @name parseApiError\n * @description Set default logics for different API Error responses.\n * @param {object} object - API response.\n */\n export const parseApiError = (data) => {\n\n    // outout to frontend console\n    console.log(data);\n\n    // unstructured failure\n    if(isNaN(data.code)){\n    \n        // structure failure data\n        let log = data;\n        try{ log = JSON.stringify(log); }catch(e){ }\n\n        let params = new URLSearchParams();\n        params.append(\"cmd\", \"report\");\n        params.append(\"sid\", spaceID());\n        params.append(\"token\", getCookie('kenzap_token'));\n        params.append(\"data\", log);\n        \n        // report error\n        fetch('https://api-v1.kenzap.cloud/error/', { method: 'post', headers: { 'Accept': 'application/json', 'Content-type': 'application/x-www-form-urlencoded', }, body: params });\n\n        alert('Can not connect to Kenzap Cloud');  \n        return;\n    }\n    \n    // handle cloud error codes\n    switch(data.code){\n\n        // unauthorized\n        case 401:\n\n            // dev mode\n            if(window.location.href.indexOf('localhost')!=-1){ \n\n                alert(data.reason); \n                return; \n            }\n\n            // production mode\n            location.href=\"https://auth.kenzap.com/?app=65432108792785&redirect=\"+window.location.href; break;\n        \n        // something else\n        default:\n\n            alert(data.reason); \n            break;\n    }\n}\n\n/**\n * @name initBreadcrumbs\n * @description Render ui breadcrumbs.\n * @param {array} data - List of link objects containing link text and url. If url is missing then renders breadcrumb as static text. Requires html holder with .bc class.\n */\nexport const initBreadcrumbs = (data) => {\n\n    let html = '<ol class=\"breadcrumb mt-2 mb-0\">';\n    for(let bc of data){\n        \n        if(typeof(bc.link) === 'undefined'){\n\n            html += `<li class=\"breadcrumb-item\">${ bc.text }</li>`;\n        }else{\n\n            html += `<li class=\"breadcrumb-item\"><a href=\"${ bc.link }\">${ bc.text }</a></li>`;\n        }\n    }\n    html += '</ol>';\n    \n    document.querySelector(\".bc\").innerHTML = html;\n}\n\n/**\n * @name onClick\n * @description One row click event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onClick = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\n/**\n * @name onKeyUp\n * @description One row key up event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onKeyUp = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('keyup', fn, true);\n        e.addEventListener('keyup', fn, true);\n    }\n}\n\n/**\n * @name onChange\n * @description One row change event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onChange = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('change', fn, true);\n        e.addEventListener('change', fn, true);\n    }\n}\n\n/**\n * @name loadScript\n * @description Asynchronous script loader function.\n * @param {string} url - HTML selector, id, class, etc.\n * @param {string} cb - callback function fired immediately after script is loaded.\n */\n export const loadScript = (url, cb) => {\n\n    if (!Array.from(document.querySelectorAll('script')).some(elm => elm.src == url)) {\n      let script = document.createElement('script')\n      script.onload = cb\n      script.src = url\n      document.getElementsByTagName('head')[0].appendChild(script)\n    }\n}\n\n/**\n * @name simulateClick\n * @description Trigger on click event without user interaction.\n * @param {string} elem - HTML selector, id, class, etc.\n */\n export const simulateClick = (elem) => {\n\n\t// create our event (with options)\n\tlet evt = new MouseEvent('click', {\n\t\tbubbles: true,\n\t\tcancelable: true,\n\t\tview: window\n\t});\n\n\t// if cancelled, don't dispatch the event\n\t!elem.dispatchEvent(evt);\n};\n\n/**\n * Create a web friendly URL slug from a string.\n *\n * Requires XRegExp (http://xregexp.com) with unicode add-ons for UTF-8 support.\n *\n * Although supported, transliteration is discouraged because\n *     1) most web browsers support UTF-8 characters in URLs\n *     2) transliteration causes a loss of information\n *\n * @author Sean Murphy <sean@iamseanmurphy.com>\n * @copyright Copyright 2012 Sean Murphy. All rights reserved.\n * @license http://creativecommons.org/publicdomain/zero/1.0/\n *\n * @param string s\n * @param object opt\n * @return string\n */\n export const slugify = (s, opt) => {\n\n\ts = String(s);\n\topt = Object(opt);\n\t\n\tvar defaults = {\n\t\t'delimiter': '-',\n\t\t'limit': undefined,\n\t\t'lowercase': true,\n\t\t'replacements': {},\n\t\t'transliterate': (typeof(XRegExp) === 'undefined') ? true : false\n\t};\n\t\n\t// Merge options\n\tfor (var k in defaults) {\n\t\tif (!opt.hasOwnProperty(k)) {\n\t\t\topt[k] = defaults[k];\n\t\t}\n\t}\n\t\n\tvar char_map = {\n\t\t// Latin\n\t\t'À': 'A', 'Á': 'A', 'Â': 'A', 'Ã': 'A', 'Ä': 'A', 'Å': 'A', 'Æ': 'AE', 'Ç': 'C', \n\t\t'È': 'E', 'É': 'E', 'Ê': 'E', 'Ë': 'E', 'Ì': 'I', 'Í': 'I', 'Î': 'I', 'Ï': 'I', \n\t\t'Ð': 'D', 'Ñ': 'N', 'Ò': 'O', 'Ó': 'O', 'Ô': 'O', 'Õ': 'O', 'Ö': 'O', 'Å': 'O', \n\t\t'Ø': 'O', 'Ù': 'U', 'Ú': 'U', 'Û': 'U', 'Ü': 'U', 'Å°': 'U', 'Ý': 'Y', 'Þ': 'TH', \n\t\t'ß': 'ss', \n\t\t'à': 'a', 'á': 'a', 'â': 'a', 'ã': 'a', 'ä': 'a', 'å': 'a', 'æ': 'ae', 'ç': 'c', \n\t\t'è': 'e', 'é': 'e', 'ê': 'e', 'ë': 'e', 'ì': 'i', 'í': 'i', 'î': 'i', 'ï': 'i', \n\t\t'ð': 'd', 'ñ': 'n', 'ò': 'o', 'ó': 'o', 'ô': 'o', 'õ': 'o', 'ö': 'o', 'Å': 'o', \n\t\t'ø': 'o', 'ù': 'u', 'ú': 'u', 'û': 'u', 'ü': 'u', 'Å±': 'u', 'ý': 'y', 'þ': 'th', \n\t\t'ÿ': 'y',\n\n\t\t// Latin symbols\n\t\t'©': '(c)',\n\n\t\t// Greek\n\t\t'Α': 'A', 'Β': 'B', 'Γ': 'G', 'Δ': 'D', 'Ε': 'E', 'Ζ': 'Z', 'Η': 'H', 'Θ': '8',\n\t\t'Ι': 'I', 'Κ': 'K', 'Λ': 'L', 'Μ': 'M', 'Ν': 'N', 'Ξ': '3', 'Ο': 'O', 'Π': 'P',\n\t\t'Ρ': 'R', 'Σ': 'S', 'Τ': 'T', 'Υ': 'Y', 'Φ': 'F', 'Χ': 'X', 'Ψ': 'PS', 'Ω': 'W',\n\t\t'Î': 'A', 'Î': 'E', 'Î': 'I', 'Î': 'O', 'Î': 'Y', 'Î': 'H', 'Î': 'W', 'Îª': 'I',\n\t\t'Î«': 'Y',\n\t\t'α': 'a', 'β': 'b', 'γ': 'g', 'δ': 'd', 'ε': 'e', 'ζ': 'z', 'η': 'h', 'θ': '8',\n\t\t'ι': 'i', 'κ': 'k', 'λ': 'l', 'μ': 'm', 'ν': 'n', 'ξ': '3', 'ο': 'o', 'π': 'p',\n\t\t'ρ': 'r', 'σ': 's', 'τ': 't', 'υ': 'y', 'φ': 'f', 'χ': 'x', 'ψ': 'ps', 'ω': 'w',\n\t\t'Î¬': 'a', 'Î­': 'e', 'Î¯': 'i', 'Ï': 'o', 'Ï': 'y', 'Î®': 'h', 'Ï': 'w', 'ς': 's',\n\t\t'Ï': 'i', 'Î°': 'y', 'Ï': 'y', 'Î': 'i',\n\n\t\t// Turkish\n\t\t'Å': 'S', 'Ä°': 'I', 'Ç': 'C', 'Ü': 'U', 'Ö': 'O', 'Ä': 'G',\n\t\t'Å': 's', 'Ä±': 'i', 'ç': 'c', 'ü': 'u', 'ö': 'o', 'Ä': 'g', \n\n\t\t// Russian\n\t\t'Ð': 'A', 'Ð': 'B', 'Ð': 'V', 'Ð': 'G', 'Ð': 'D', 'Ð': 'E', 'Ð': 'Yo', 'Ð': 'Zh',\n\t\t'Ð': 'Z', 'Ð': 'I', 'Ð': 'J', 'Ð': 'K', 'Ð': 'L', 'Ð': 'M', 'Ð': 'N', 'Ð': 'O',\n\t\t'Ð': 'P', 'Ð ': 'R', 'Ð¡': 'S', 'Ð¢': 'T', 'Ð£': 'U', 'Ð¤': 'F', 'Ð¥': 'H', 'Ð¦': 'C',\n\t\t'Ð§': 'Ch', 'Ð¨': 'Sh', 'Ð©': 'Sh', 'Ðª': '', 'Ð«': 'Y', 'Ð¬': '', 'Ð­': 'E', 'Ð®': 'Yu',\n\t\t'Ð¯': 'Ya',\n\t\t'Ð°': 'a', 'Ð±': 'b', 'Ð²': 'v', 'Ð³': 'g', 'Ð´': 'd', 'Ðµ': 'e', 'Ñ': 'yo', 'Ð¶': 'zh',\n\t\t'Ð·': 'z', 'Ð¸': 'i', 'Ð¹': 'j', 'Ðº': 'k', 'Ð»': 'l', 'Ð¼': 'm', 'Ð½': 'n', 'Ð¾': 'o',\n\t\t'Ð¿': 'p', 'Ñ': 'r', 'Ñ': 's', 'Ñ': 't', 'Ñ': 'u', 'Ñ': 'f', 'Ñ': 'h', 'Ñ': 'c',\n\t\t'Ñ': 'ch', 'Ñ': 'sh', 'Ñ': 'sh', 'Ñ': '', 'Ñ': 'y', 'Ñ': '', 'Ñ': 'e', 'Ñ': 'yu',\n\t\t'Ñ': 'ya',\n\n\t\t// Ukrainian\n\t\t'Ð': 'Ye', 'Ð': 'I', 'Ð': 'Yi', 'Ò': 'G',\n\t\t'Ñ': 'ye', 'Ñ': 'i', 'Ñ': 'yi', 'Ò': 'g',\n\n\t\t// Czech\n\t\t'Ä': 'C', 'Ä': 'D', 'Ä': 'E', 'Å': 'N', 'Å': 'R', 'Š': 'S', 'Å¤': 'T', 'Å®': 'U', \n\t\t'Å½': 'Z', \n\t\t'Ä': 'c', 'Ä': 'd', 'Ä': 'e', 'Å': 'n', 'Å': 'r', 'š': 's', 'Å¥': 't', 'Å¯': 'u',\n\t\t'Å¾': 'z', \n\n\t\t// Polish\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'e', 'Å': 'L', 'Å': 'N', 'Ó': 'o', 'Å': 'S', 'Å¹': 'Z', \n\t\t'Å»': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Å': 'l', 'Å': 'n', 'ó': 'o', 'Å': 's', 'Åº': 'z',\n\t\t'Å¼': 'z',\n\n\t\t// Latvian\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'E', 'Ä¢': 'G', 'Äª': 'i', 'Ä¶': 'k', 'Ä»': 'L', 'Å': 'N', \n\t\t'Š': 'S', 'Åª': 'u', 'Å½': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Ä£': 'g', 'Ä«': 'i', 'Ä·': 'k', 'Ä¼': 'l', 'Å': 'n',\n\t\t'š': 's', 'Å«': 'u', 'Å¾': 'z'\n\t};\n\t\n\t// Make custom replacements\n\tfor (var k in opt.replacements) {\n\t\ts = s.replace(RegExp(k, 'g'), opt.replacements[k]);\n\t}\n\t\n\t// Transliterate characters to ASCII\n\tif (opt.transliterate) {\n\t\tfor (var k in char_map) {\n\t\t\ts = s.replace(RegExp(k, 'g'), char_map[k]);\n\t\t}\n\t}\n\t\n\t// Replace non-alphanumeric characters with our delimiter\n\tvar alnum = (typeof(XRegExp) === 'undefined') ? RegExp('[^a-z0-9]+', 'ig') : XRegExp('[^\\\\p{L}\\\\p{N}]+', 'ig');\n\ts = s.replace(alnum, opt.delimiter);\n\t\n\t// Remove duplicate delimiters\n\ts = s.replace(RegExp('[' + opt.delimiter + ']{2,}', 'g'), opt.delimiter);\n\t\n\t// Truncate slug to max. characters\n\ts = s.substring(0, opt.limit);\n\t\n\t// Remove delimiter from ends\n\ts = s.replace(RegExp('(^' + opt.delimiter + '|' + opt.delimiter + '$)', 'g'), '');\n\t\n\treturn opt.lowercase ? s.toLowerCase() : s;\n}\n\n/**\n * @name toast\n * @description Triggers toast notification. Adds toast html to the page if missing.\n * @param {string} text - Toast notification.\n */\n export const toast = (text) => {\n\n    // only add once\n    if(!document.querySelector(\".toast\")){\n\n        let html = `\n        <div class=\"position-fixed bottom-0 p-2 m-4 end-0 align-items-center\">\n            <div class=\"toast hide align-items-center text-white bg-dark border-0\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\" data-bs-delay=\"3000\">\n                <div class=\"d-flex\">\n                    <div class=\"toast-body\"></div>\n                    <button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\n                </div>\n            </div>\n        </div>`;\n        if(document.querySelector('body > div')) document.querySelector('body > div').insertAdjacentHTML('afterend', html);\n    }\n\n    let toast = new bootstrap.Toast(document.querySelector('.toast'));\n    document.querySelector('.toast .toast-body').innerHTML = text;  \n    toast.show();\n}","import { getCookie, getSiteId, simulateClick, headers } from '@kenzap/k-cloud';\n\nexport const CDN = \"https://cdn.kenzap.cloud/\";\nexport const API_KEY = \"Qz3fOs8Ghi7rpaW8BOlNgUyo7ANWYoKbRoUa8UkYd2I4FlAgUYFqzPM33IxqoFYa\";\n\nexport const spaceID = () => {\n\n    return \"1002170\"\n}\n\nexport const sortAlphaNum = (a, b) => a['title'].localeCompare(b['title'], 'en', { numeric: true })\n\n/**\n* Generates a random string\n* \n* @param int length_\n* @return string\n*/\nexport const randomString = (length_) => {\n\n    let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz'.split('');\n    if (typeof length_ !== \"number\") {\n        length_ = Math.floor(Math.random() * chars.length_);\n    }\n    let str = '';\n    for (let i = 0; i < length_; i++) {\n        str += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return str;\n}\n\nexport const stringToHash = str => {\n\n    let hash = 0\n    for (let i = 0; i < str.length; ++i)\n        hash = Math.imul(31, hash) + str.charCodeAt(i)\n  \n    hash = 'c'+Math.abs(hash);\n    \n    // console.log(hash);\n\n    return hash;\n}\n\nexport const mt = (val) => {\n\n    return (\"\"+val).length < 2 ? \"0\"+val : val;\n}\n\nexport const getProductId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('id') ? urlParams.get('id') : \"\";\n    return id;\n}\n\nexport const getProductIdFromLink = () => {\n    \n    let url = new URL(window.location.href);\n    let id = url.pathname.trim().split('/').slice(-2)[0];\n    return id;\n}\n\nexport const replaceQueryParam = (param, newval, search) => {\n\n    let regex = new RegExp(\"([?;&])\" + param + \"[^&;]*[;&]?\");\n    let query = search.replace(regex, \"$1\").replace(/&$/, '');\n\n    return (query.length > 2 ? query + \"&\" : \"?\") + (newval ? param + \"=\" + newval : '');\n}\n\nexport const getPageNumberOld = () => {\n\n    let url = window.location.href.split('/');\n    let page = url[url.length-1];\n    let pageN = 1;\n    if(page.indexOf('page')==0){\n      pageN = page.replace('page', '').replace('#', '');\n    }\n    // console.log(pageN);\n    return parseInt(pageN);\n}\n\nexport const getPageNumber = () => {\n\n    let urlParams = new URLSearchParams(window.location.search);\n    let page = urlParams.get('page') ? urlParams.get('page') : 1;\n\n    return parseInt(page);\n}\n\nexport const getPagination = (__, meta, cb) => {\n\n    if(typeof(meta) === 'undefined'){ document.querySelector(\"#listing_info\").innerHTML = __('no records to display'); return; }\n\n    let offset = meta.limit+meta.offset;\n    if(offset>meta.total_records) offset = meta.total_records;\n\n    document.querySelector(\"#listing_info\").innerHTML = __(\"Showing %1$ to %2$ of %3$ entries\", (1+meta.offset), (offset), meta.total_records);\n    //  \"Showing \"+(1+meta.offset)+\" to \"+(offset)+\" of \"+meta.total_records+\" entries\";\n\n    let pbc = Math.ceil(meta.total_records / meta.limit);\n    document.querySelector(\"#listing_paginate\").style.display = (pbc < 2) ? \"none\" : \"block\";\n\n    let page = getPageNumber(); \n    let html = '<ul class=\"pagination d-flex justify-content-end pagination-flat mb-0\">';\n    html += '<li class=\"paginate_button page-item previous\" id=\"listing_previous\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"prev\" data-page=\"0\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&laquo;</span></li>';\n    let i = 0;\n    while(i<pbc){\n\n        i++; \n        if(((i >= page-3) && (i <= page)) || ((i <= page+3) && (i >=page))){\n\n            html += '<li class=\"paginate_button page-item '+((page==i)?'active':'')+'\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"page\" data-page=\"'+i+'\" tabindex=\"0\" class=\"page-link\">'+(page==i?i:i)+'</a></li>';      \n        }\n    }  \n    html += '<li class=\"paginate_button page-item next\" id=\"order-listing_next\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"next\" data-page=\"2\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&raquo;</span></a></li>';\n    html += '</ul>'\n\n    document.querySelector(\"#listing_paginate\").innerHTML = html;\n\n    let page_link = document.querySelectorAll(\".page-link\");\n    for (const l of page_link) {\n        \n        l.addEventListener('click', function(e) {\n\n            let p = parseInt(getPageNumber());\n            let ps = p;\n            switch(l.dataset.type){ \n                case 'prev': p-=1; if(p<1) p = 1; break;\n                case 'page': p=l.dataset.page; break;\n                case 'next': p+=1; if(p>pbc) p = pbc; break;\n            }\n            \n            // update url\n            if (window.history.replaceState) {\n\n                // let url = window.location.href.split('/page');\n                // let urlF = (url[0]+'/page'+p).replace('//page', '/page');\n\n                let str = window.location.search;\n                str = replaceQueryParam('page', p, str);\n                // window.location = window.location.pathname + str\n\n                // prevents browser from storing history with each change:\n                window.history.replaceState(\"kenzap-cloud\", document.title, window.location.pathname + str);\n            }\n\n            // only refresh if page differs\n            if(ps!=p) cb();\n            \n            e.preventDefault();\n            return false;\n        });\n    }\n}\n\nexport const formatStatus = (__, st) => {\n\n    st = parseInt(st); \n    switch(st){ \n      case 0: return '<div class=\"badge bg-warning text-dark fw-light\">' + __('Draft') + '</div>';\n      case 1: return '<div class=\"badge bg-primary fw-light\">' + __('Published') + '</div>';\n      case 3: return '<div class=\"badge bg-secondary fw-light\">' + __('Unpublished') + '</div>';\n      default: return '<div class=\"badge bg-secondary fw-light\">' + __('Drafts') + '</div>';\n    }\n}\n\n/**\n    * Render price\n    * @public\n    */\n export const priceFormat = function(_this, price) {\n\n    price = makeNumber(price);\n\n    price = (Math.round(parseFloat(price) * 100)/100).toFixed(2);\n    \n    switch(_this.state.settings.currency_symb_loc){\n        case 'left': price = _this.state.settings.currency_symb + price; break;\n        case 'right': price = price + _this.state.settings.currency_symb; break;\n        case 'left_space': price = _this.state.settings.currency_symb + ' ' + price; break;\n        case 'right_space': price = price + ' ' + _this.state.settings.currency_symb; break;\n    }\n\n    return price;\n}\n\nexport const makeNumber = function(price) {\n\n    price = price ? price : 0;\n    price = parseFloat(price);\n    price = Math.round(price * 100) / 100;\n    return price;\n}\n\nexport const formatTime = (__, timestamp) => {\n\t\n    const d = new Date(parseInt(timestamp) * 1000);\n    return d.toLocaleDateString();\n\n    let a = new Date(timestamp * 1000);\n    let months = [__('Jan'), __('Feb'), __('Mar'), __('Apr'), __('May'), __('Jun'), __('Jul'), __('Aug'), __('Sep'), __('Oct'), __('Nov'), __('Dec')];\n    let year = a.getFullYear();\n    let month = months[a.getMonth()];\n    let date = a.getDate();\n    let hour = a.getHours();\n    let min = a.getMinutes();\n    let sec = a.getSeconds();\n    let time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\n// numbers only with allowed exceptions\nexport const onlyNumbers = (sel, chars) => {\n\n    if(!document.querySelector(sel)) return;\n\n    for(let el of document.querySelectorAll(sel)){\n    \n        el.addEventListener('keypress', (e) => {\n\n            // console.log(e.which);\n\n            if((!chars.includes(e.which) && isNaN(String.fromCharCode(e.which))) || e.which == 32 || (document.querySelector(sel).value.includes(String.fromCharCode(e.which)) && chars.includes(e.which))){\n\n                // stop character from entering input\n                e.preventDefault(); \n                return false;\n            }\n        });\n    }\n}\n\n// nums only validation\nexport const numsOnly = (e, max) => {\n\n    // Only ASCII charactar in that range allowed \n    var ASCIICode = (e.which) ? e.which : e.keyCode \n    if (ASCIICode > 31 && ASCIICode != 46 && (ASCIICode < 48 || ASCIICode > 57)) \n    return false; \n\n    if(parseFloat(e.target.value)>max) \n    return false; \n\n    let dec = e.target.value.split('.');\n    if(dec.length>1)\n    if(dec[1].length>1)\n        return false;\n    \n    return true; \n}\n\nexport const onClick = (sel, fn) => {\n\n    // console.log('onClick');\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\n// time elapsed since creation \nexport const timeConverterAgo = (__, now, time) => {\n\n    now = parseInt(now);\n    time = parseInt(time);\n\n    // parse as elapsed time\n    let past = now - time;\n    if(past < 60) return __('moments ago');\n    if(past < 3600) return __('%1$ minutes ago', parseInt(past / 60));\n    if(past < 86400) return  __('%1$ hours ago', parseInt(past / 60 / 60));\n\n    // process as normal date\n    var a = new Date(time * 1000);\n    var months = [ __('Jan'), __('Feb'), __('Mar'), __('Apr'), __('May'), __('Jun'), __('Jul'), __('Aug'), __('Sep'), __('Oct'), __('Nov'), __('Dec') ];\n    var year = a.getFullYear();\n    var month = months[a.getMonth()];\n    var date = a.getDate();\n    var hour = a.getHours();\n    var min = a.getMinutes();\n    var sec = a.getSeconds();\n    var time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\nexport const parseVariations = (_this, product) => {\n\n    let html_vars = '';\n    if(typeof(product.variations !== 'undefined'))\n    for(let v in product.variations){\n\n        // variation type\n        let type = '';\t\n        if(product.variations[v].type=='checkbox') type = 'check';\n        if(product.variations[v].type=='radio')    type = 'radio';\n\n        // struct variation\n        html_vars += '\\\n        <b>' + __(product.variations[v].title) + (product.variations[v].required == '1' ? ' <span class=\"tag\">'+__('required')+'</span>':'')+'</b>\\\n        <div class=\"kp-'+type+'\" >';\n\n        // variation labels\n        for(let d in product.variations[v].data){\n\n            let checked = false;\n            // for public qr feed\n            // if(typeof(cart.state.product.variations[v]) !== 'undefined' && typeof(cart.state.product.variations[v].list) !== 'undefined' && typeof(cart.state.product.variations[v].list[\"_\"+d]) !== 'undefined'){ checked = true; }\n            \n            // verify variation price validity\n            product.variations[v].data[d]['price'] = makeNumber(product.variations[v].data[d]['price']);\n\n            switch(type){\n                case 'check':\n\n                html_vars += '\\\n                    <label>\\\n                        <input type=\"checkbox\" data-required=\"'+product.variations[v].required+'\" data-indexv=\"'+v+'\" data-index=\"'+d+'\" data-title=\"'+product.variations[v].data[d]['title']+'\" data-titlev=\"'+__(product.variations[v].title)+'\" data-price=\"'+product.variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+'>\\\n                        <div class=\"checkbox\">\\\n                            <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 20 20\">\\\n                                <path d=\"M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z\"></path>\\\n                                <polyline points=\"4 11 8 15 16 6\"></polyline>\\\n                            </svg>\\\n                        </div>\\\n                        <span>'+__(product.variations[v].data[d]['title'])+'</span>\\\n                        <div class=\"price\">+ '+priceFormat(_this, product.variations[v].data[d]['price'])+'</div>\\\n                    </label>';\n                \n                break;\n                case 'radio':\n\n                html_vars += '\\\n                    <label>\\\n                        <input type=\"radio\" data-required=\"'+product.variations[v].required+'\" data-indexv=\"'+v+'\" name=\"radio'+v+'\" data-index=\"'+d+'\" data-title=\"'+product.variations[v].data[d]['title']+'\" data-titlev=\"'+__(product.variations[v].title)+'\" data-price=\"'+product.variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+' />\\\n                        <span>'+__(product.variations[v].data[d]['title'])+'</span>\\\n                        <div class=\"price\">+ '+priceFormat(_this, product.variations[v].data[d]['price'])+'</div>\\\n                    </label>';\n                \n                break;\n            }\n        }\n\n        html_vars += '</div>';\n    }\n\n    return html_vars;\n}\n\nexport const escape = (htmlStr) => {\n\n    return htmlStr.replace(/&/g, \"&amp;\")\n          .replace(/</g, \"&lt;\")\n          .replace(/>/g, \"&gt;\")\n          .replace(/\"/g, \"&quot;\")\n          .replace(/'/g, \"&#39;\");        \n \n}\n\nexport const unescape = (htmlStr) => {\n\n    htmlStr = htmlStr.replace(/&lt;/g , \"<\");\t \n    htmlStr = htmlStr.replace(/&gt;/g , \">\");     \n    htmlStr = htmlStr.replace(/&quot;/g , \"\\\"\");  \n    htmlStr = htmlStr.replace(/&#39;/g , \"\\'\");   \n    htmlStr = htmlStr.replace(/&amp;/g , \"&\");\n    return htmlStr;\n}\n\nexport const ecommerceUpdates = (_this, source, cb) => {\n\n    // do API query\n    fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n        method: 'post',\n        headers: headers,\n        body: JSON.stringify({\n            query: {\n                updates: {\n                    type:       'updates',\n                    source:     source,\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if(response.success){\n\n            // do callback\n            cb(response);\n            \n            // parse notifications\n            renderNotifications(_this, response.messages);\n            \n        }else{\n\n\n        }\n    })\n    .catch(error => { // parseApiError(error); \n    });\n}\n\nexport const isMobile = () => {\n\n    const nav = navigator.userAgent.toLowerCase();\n    return (\n        nav.match(/iphone/i) || nav.match(/ipod/i) || nav.match(/ipad/i) || nav.match(/android/i)\n    );\n}\n\n// play notification sound. Ex.: when new order received\nexport const playSound = (_this, max) => {\n \n    // if(!max) max = _this.state.playSound.max_times;\n\n    _this.state.playSound.n = 0;\n\n    if(_this.state.playSound.timer) clearInterval(_this.state.playSound.timer);\n\n    if(_this.state.playSound.allowed) _this.state.playSound.audio.play();\n\n    console.log(\"playing \" + _this.state.playSound.allowed);\n\n    try{\n        if(_this.state.playSound.allowed && isMobile()) window.navigator.vibrate(200);\n    }catch{\n\n    }\n\n    if(max==1) return;\n\n    _this.state.playSound.timer = setInterval(() => {\n\n        if(!_this.state.playSound.allowed) return;\n         \n        _this.state.playSound.audio.play();\n\n        if(_this.state.playSound.n > max){ clearInterval(_this.state.playSound.timer) }\n\n        _this.state.playSound.n += 1;\n\n    }, 5000);\n\n    // console.log('playSound');\n}\n\nexport const lazyLoad = () => {\n\n    let lazyImages = [].slice.call(document.querySelectorAll(\"img.lazy\"));\n    if (document.querySelector(\"body\").dataset.lazyLoading != '1'){\n\n        document.querySelector(\"body\").dataset.lazyLoading = '1';\n        setTimeout(function() {\n            lazyImages.forEach(function(lazyImage) {\n                if ((lazyImage.getBoundingClientRect().top <= window.innerHeight && lazyImage.getBoundingClientRect().bottom >= 0) && getComputedStyle(lazyImage).display !== \"none\") {\n\n                    lazyImage.src = lazyImage.dataset.src;\n                    lazyImage.srcset = lazyImage.dataset.srcset;\n                    lazyImage.classList.remove(\"lazy\");\n                    lazyImages = lazyImages.filter(function(image) {\n                        return image !== lazyImage;\n                    });\n                }\n            });\n            document.querySelector(\"body\").dataset.lazyLoading = '0';\n        }, 0);\n    }\n}\n\nexport const renderNotifications = (_this, messages) => {\n\n    let html = '';\n\n    let play = false;\n\n    // html\n    messages.forEach(msg => {\n\n        if(!_this.state.playSound.nids.includes(msg._id)){ _this.state.playSound.nids.push(msg._id); play = true; }\n\n        if(!document.querySelector('#contents .container [data-id=\"'+msg._id+'\"]')){\n        \n            html += `\n\n            <div class=\"alert alert-${ msg.color } alert-dismissible fade show\" role=\"alert\" data-id=\"${ msg._id }\">\n                <div class=\"d-flex align-items-center\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-exclamation-square flex-shrink-0 me-2\" viewBox=\"0 0 16 16\">\n                        <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z\"/>\n                        <path d=\"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z\"/>\n                    </svg>\n                    <div>\n                    ${ msg.msg }\n                    </div>\n                </div>\n                <button type=\"button\" class=\"btn-close btn-dismiss-notify\" data-bs-dismiss=\"alert\" aria-label=\"Close\" data-id=\"${ msg._id }\"></button>\n            </div>`;\n        }\n    });\n\n    // play sound\n    if(play){ console.log('notify play sound'); playSound(_this, 1); _this.getData(); }\n\n    if(document.querySelector('#contents .container')) document.querySelector('#contents .container').insertAdjacentHTML(\"afterbegin\", html);\n\n    // listeners\n    onClick('.btn-dismiss-notify', (e) => {\n\n        // do API query\n        fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n            method: 'post',\n            headers: headers,\n            body: JSON.stringify({\n                query: {\n                    updates: {\n                        type:       'dismiss',\n                        id:         e.currentTarget.dataset.id,\n                    }\n                }\n            })\n        })\n        .then(response => response.json())\n        .then(response => {\n\n            if(response.success){\n\n\n\n            }else{\n\n\n            }\n        })\n        .catch(error => { // parseApiError(error); \n        });\n    });\n\n    // order open listener\n    if(document.querySelector('.order-details')) for( let el of document.querySelectorAll('.order-details') ){\n\n        if(el.dataset.assigned == \"1\") return;\n\n        el.dataset.assigned = 1;\n\n        el.addEventListener('click', (e) => {\n\n            let el = document.querySelector(\".view-order[data-id='\"+e.currentTarget.dataset.id+\"']\");\n\n            simulateClick(el);\n\n        }, true);\n    }\n}\n\nexport const printReceipt = (_this, order) => {\n\n    // vars\n    let o = order, data = {}, date = new Date();\n\n    // 58mm wide thermal printers are best to display 32 chars per line\n    let row = (txt, end_ofst) => {\n\n        let output = '', max_char = 32 - end_ofst, max_ofst = 4, ofst_prev = 0, ofst = 0, ci = 0;\n        // console.log(max_char);\n        for(let i = 0; i < Math.ceil(txt.length / max_char); i++){\n\n            // add new line print from second loop only\n            if(i>0) output += '\\n[L]';\n\n            // ofst store first available whitespace break in words\n            ofst = ci = 0;\n            for(let e = max_ofst; e > -1 * max_ofst; e--){\n\n                ci = ((max_char + ofst_prev) * i) + max_char + e; if(txt[ci] == ' ' || ci == txt.length){ ofst += e; break; }\n            }\n\n            // add line row\n            output += txt.substr((max_char + ofst_prev) * i, max_char + ofst);\n\n            // line ends earlier than expected, skip loop\n            if(ci == txt.length) break;\n\n            ofst_prev = ofst;\n        }\n\n        return output;\n    };\n\n    // debug vs actual print\n    data.debug = false;\n\n    // get receipt template\n    data.print = _this.state.settings.receipt_template;\n\n    console.log(data.print);\n\n    // order id\n    data.print = data.print.replace(/{{order_id}}/g, o.id);\n\n    // current time\n    data.print = data.print.replace(/{{date_time}}/g, date.toLocaleString([], { dateStyle: 'medium', timeStyle: 'short', }));\n\n    // order items\n    let items = '';\n    for(let i in o.items){\n\n        console.log(__(o.items[i].title));\n\n        let total = priceFormat(_this, o.items[i].total);\n        let end_ofst = (o.items[i].qty+\"\").length + (total+\"\").length + 3;\n        items += `[L]<b>${ o.items[i].qty } X ${ row(__(o.items[i].title), end_ofst) }</b>[R]${ total }\\n`;\n        for(let v in o.items[i].variations){\n\n            items += `[L] ${ row(__(o.items[i].variations[v].title), 1) }:`;\n            for(let l in  o.items[i].variations[v].list) items += ` ${ o.items[i].variations[v].list[l].title },`;\n\n            if(items.endsWith(',')) items = items.substring(0, items.length - 1) + '\\n';\n\n            // parse variation list\n            // let list = ''; for(let l in item[x].variations[v].list) list += item[x].variations[v].list[l].title + \" \";\n            // vars += '<div><b>' + item[x].variations[v].title + \"</b> <span>\" + list + \"</span></div> \";\n    \n            // // meal note\n            // if(item[x].variations[v].note !== undefined && item[x].variations[v].note.length > 0) vars += \"<div><b>\" + __('Note') + \"</b> \" + item[x].variations[v].note + \"</div> \";\n        }\n    }\n    if(items.endsWith('\\n')) items = items.substring(0, items.length - 2);\n    data.print = data.print.replace(/{{order_items}}/g, items);\n\n    // order note\n    let note = !o.note || o.note == '<br>' ? '' : o.note;\n    if(note.length>0){\n        //  data.print += '[C]================================';\n        data.print = data.print.replace(/{{order_note}}/g, '[C]================================\\n' + note + '\\n[C]================================\\n');\n    }\n    // if(note.length>0) data.print += '[C]================================';\n\n    // order totals\n    data.print = data.print.replace(/{{total}}/g, priceFormat(_this, o.price.total));\n    data.print = data.print.replace(/{{tax_total}}/g, priceFormat(_this, o.price.tax_total));\n    data.print = data.print.replace(/{{discount_total}}/g, priceFormat(_this, o.price.discount_total));\n    data.print = data.print.replace(/{{grand_total}}/g, priceFormat(_this, o.price.grand_total));\n\n\n    let order_totals  = '';\n    order_totals += '[L]Subtotal[R]' + priceFormat(_this, o.price.total) + '\\n';\n    if(o.price.discount_total > 0) order_totals += '[L]'+__('Discount')+'[R]-' + priceFormat(_this, o.price.discount_total) + '\\n';\n    if(o.price.fee_total > 0) order_totals += '[L]'+_this.state.settings.fee_display+'[R]' + priceFormat(_this, o.price.fee_total) + '\\n';\n    if(o.price.tax_total > 0) order_totals += '[L]'+_this.state.settings.tax_display+'[R]' + priceFormat(_this, o.price.tax_total) + '\\n';\n    if(o.price.grand_total > 0) order_totals += '[L]'+__('Grand Total')+'[R]' + priceFormat(_this, o.price.grand_total);\n\n    data.print = data.print.replace(/{{order_totals}}/g, order_totals);\n\n    // qr link\n    data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n    data.print = data.print.replace(/{{qr_number}}/g, document.querySelector('#qr-number').value);\n\n        \n    // let click = document.querySelector(\".print-order[data-id='\"+e.currentTarget.dataset.id+\"']\");\n\n    // click.setAttribute('href', 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data)));\n\n    // e.currentTarget.setAttribute('href', 'kenzapprint://kenzapprint.app?data='+JSON.stringify(data));\n\n    // alert(data.print);\n\n    let str = 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data));\n    \n    if(data.debug) { console.log(data.print); console.log(str); }\n\n    return str;\n}\n\nexport const printQR = (_this, order) => {\n\n    // vars\n    let o = order, data = {}, date = new Date();\n\n    // debug vs actual print\n    data.debug = false;\n\n    // get qr template\n    data.print = _this.state.settings.qr_template;\n\n    // qr link\n    data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n    data.print = data.print.replace(/{{qr_number}}/g, document.querySelector('#qr-number').value);\n\n    if(data.debug) { console.log(data.print); console.log(str); }\n\n    let str = 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data));\n\n    return str;\n}\n\n/**\n * Converts degrees to radians\n * \n * @param deg {Integer}\n * @returns {Integer} - radians\n */\nexport const degToRad = (deg) => {\n\n    return (deg - 90) * Math.PI / 180.0;\n}\n\n/*\n* Load additional JS or CSS depencies\n*\n* @param    dep       dependecy. Ex.: hiebee.min.js \n* @param    cb        function to call after script is loaded (optional)       \n* @return \t{Boolen} \tresult status \n* \n*/\nexport const loadAddon = (dep, version, cb) => {\n\n    // dependency already loaded, skip\n    if(document.getElementById(dep)){ if(typeof cb === 'function') cb.call(); return; }\n\n    // detect dependency type\n    let t = dep.split('.').slice(-1)[0];\n    // console.log(dep+'loadAddon'+t);\n    switch(t){\n      case 'js':\n        \n        let js = document.createElement(\"script\");\n        js.setAttribute(\"src\", dep);\n        js.id = dep;\n        js.onload = js.onreadystatechange = function() {\n \n          if(!this.readyState || this.readyState == 'complete')\n            if(typeof cb === 'function') cb.call();\n        };\n        document.body.appendChild(js);\n        \n      break;\n      case 'css':\n\n        var head  = document.getElementsByTagName('head')[0];\n        var css  = document.createElement('link');\n        css.id   = dep;\n        css.rel  = 'stylesheet';\n        css.type = 'text/css';\n        css.href = dep;\n        head.appendChild(css);\n\n      break;\n    }\n}\n\n/**\n * @name setCookie\n * @description Set cookie by its name to all .kenzap.cloud subdomains\n * @param {string} name - Cookie name.\n * @param {string} value - Cookie value.\n * @param {string} days - Number of days when cookie expires.\n */\n export const setCookie = (name, value, days) => {\n\n    let expires = \"\";\n    if (days) {\n        let date = new Date();\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n        expires = \";expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + (escape(value) || \"\") + expires + \";path=/\"; \n}\n\nexport const getCurrencies = () => {\n\n    // length 164\n    return [\n        {\"name\":\"Afghan Afghani\",\"code\":\"AFA\",\"symbol\":\"؋\"},\n        {\"name\":\"Albanian Lek\",\"code\":\"ALL\",\"symbol\":\"Lek\"},\n        {\"name\":\"Algerian Dinar\",\"code\":\"DZD\",\"symbol\":\"دج\"},\n        {\"name\":\"Angolan Kwanza\",\"code\":\"AOA\",\"symbol\":\"Kz\"},\n        {\"name\":\"Argentine Peso\",\"code\":\"ARS\",\"symbol\":\"$\"},\n        {\"name\":\"Armenian Dram\",\"code\":\"AMD\",\"symbol\":\"֏\"},\n        {\"name\":\"Aruban Florin\",\"code\":\"AWG\",\"symbol\":\"ƒ\"},\n        {\"name\":\"Australian Dollar\",\"code\":\"AUD\",\"symbol\":\"$\"},\n        {\"name\":\"Azerbaijani Manat\",\"code\":\"AZN\",\"symbol\":\"m\"},\n        {\"name\":\"Bahamian Dollar\",\"code\":\"BSD\",\"symbol\":\"B$\"},\n        {\"name\":\"Bahraini Dinar\",\"code\":\"BHD\",\"symbol\":\".د.ب\"},\n        {\"name\":\"Bangladeshi Taka\",\"code\":\"BDT\",\"symbol\":\"৳\"},\n        {\"name\":\"Barbadian Dollar\",\"code\":\"BBD\",\"symbol\":\"Bds$\"},\n        {\"name\":\"Belarusian Ruble\",\"code\":\"BYR\",\"symbol\":\"Br\"},\n        {\"name\":\"Belgian Franc\",\"code\":\"BEF\",\"symbol\":\"fr\"},\n        {\"name\":\"Belize Dollar\",\"code\":\"BZD\",\"symbol\":\"$\"},\n        {\"name\":\"Bermudan Dollar\",\"code\":\"BMD\",\"symbol\":\"$\"},\n        {\"name\":\"Bhutanese Ngultrum\",\"code\":\"BTN\",\"symbol\":\"Nu.\"},\n        {\"name\":\"Bitcoin\",\"code\":\"BTC\",\"symbol\":\"฿\"},\n        {\"name\":\"Bolivian Boliviano\",\"code\":\"BOB\",\"symbol\":\"Bs.\"},\n        {\"name\":\"Bosnia-Herzegovina Convertible Mark\",\"code\":\"BAM\",\"symbol\":\"KM\"},\n        {\"name\":\"Botswanan Pula\",\"code\":\"BWP\",\"symbol\":\"P\"},\n        {\"name\":\"Brazilian Real\",\"code\":\"BRL\",\"symbol\":\"R$\"},\n        {\"name\":\"British Pound Sterling\",\"code\":\"GBP\",\"symbol\":\"£\"},\n        {\"name\":\"Brunei Dollar\",\"code\":\"BND\",\"symbol\":\"B$\"},\n        {\"name\":\"Bulgarian Lev\",\"code\":\"BGN\",\"symbol\":\"Лв.\"},\n        {\"name\":\"Burundian Franc\",\"code\":\"BIF\",\"symbol\":\"FBu\"},\n        {\"name\":\"Cambodian Riel\",\"code\":\"KHR\",\"symbol\":\"KHR\"},\n        {\"name\":\"Canadian Dollar\",\"code\":\"CAD\",\"symbol\":\"$\"},\n        {\"name\":\"Cape Verdean Escudo\",\"code\":\"CVE\",\"symbol\":\"$\"},\n        {\"name\":\"Cayman Islands Dollar\",\"code\":\"KYD\",\"symbol\":\"$\"},\n        {\"name\":\"CFA Franc BCEAO\",\"code\":\"XOF\",\"symbol\":\"CFA\"},\n        {\"name\":\"CFA Franc BEAC\",\"code\":\"XAF\",\"symbol\":\"FCFA\"},\n        {\"name\":\"CFP Franc\",\"code\":\"XPF\",\"symbol\":\"₣\"},\n        {\"name\":\"Chilean Peso\",\"code\":\"CLP\",\"symbol\":\"$\"},\n        {\"name\":\"Chinese Yuan\",\"code\":\"CNY\",\"symbol\":\"¥\"},\n        {\"name\":\"Colombian Peso\",\"code\":\"COP\",\"symbol\":\"$\"},\n        {\"name\":\"Comorian Franc\",\"code\":\"KMF\",\"symbol\":\"CF\"},\n        {\"name\":\"Congolese Franc\",\"code\":\"CDF\",\"symbol\":\"FC\"},\n        {\"name\":\"Costa Rican Colón\",\"code\":\"CRC\",\"symbol\":\"₡\"},\n        {\"name\":\"Croatian Kuna\",\"code\":\"HRK\",\"symbol\":\"kn\"},\n        {\"name\":\"Cuban Convertible Peso\",\"code\":\"CUC\",\"symbol\":\"$, CUC\"},\n        {\"name\":\"Czech Republic Koruna\",\"code\":\"CZK\",\"symbol\":\"Kč\"},\n        {\"name\":\"Danish Krone\",\"code\":\"DKK\",\"symbol\":\"Kr.\"},\n        {\"name\":\"Djiboutian Franc\",\"code\":\"DJF\",\"symbol\":\"Fdj\"},\n        {\"name\":\"Dominican Peso\",\"code\":\"DOP\",\"symbol\":\"$\"},\n        {\"name\":\"East Caribbean Dollar\",\"code\":\"XCD\",\"symbol\":\"$\"},\n        {\"name\":\"Egyptian Pound\",\"code\":\"EGP\",\"symbol\":\"ج.م\"},\n        {\"name\":\"Eritrean Nakfa\",\"code\":\"ERN\",\"symbol\":\"Nfk\"},\n        {\"name\":\"Estonian Kroon\",\"code\":\"EEK\",\"symbol\":\"kr\"},\n        {\"name\":\"Ethiopian Birr\",\"code\":\"ETB\",\"symbol\":\"Nkf\"},\n        {\"name\":\"Euro\",\"code\":\"EUR\",\"symbol\":\"€\"},\n        {\"name\":\"Falkland Islands Pound\",\"code\":\"FKP\",\"symbol\":\"£\"},\n        {\"name\":\"Fijian Dollar\",\"code\":\"FJD\",\"symbol\":\"FJ$\"},\n        {\"name\":\"Gambian Dalasi\",\"code\":\"GMD\",\"symbol\":\"D\"},\n        {\"name\":\"Georgian Lari\",\"code\":\"GEL\",\"symbol\":\"ლ\"},\n        {\"name\":\"German Mark\",\"code\":\"DEM\",\"symbol\":\"DM\"},\n        {\"name\":\"Ghanaian Cedi\",\"code\":\"GHS\",\"symbol\":\"GH₵\"},\n        {\"name\":\"Gibraltar Pound\",\"code\":\"GIP\",\"symbol\":\"£\"},\n        {\"name\":\"Greek Drachma\",\"code\":\"GRD\",\"symbol\":\"₯, Δρχ, Δρ\"},\n        {\"name\":\"Guatemalan Quetzal\",\"code\":\"GTQ\",\"symbol\":\"Q\"},\n        {\"name\":\"Guinean Franc\",\"code\":\"GNF\",\"symbol\":\"FG\"},\n        {\"name\":\"Guyanaese Dollar\",\"code\":\"GYD\",\"symbol\":\"$\"},\n        {\"name\":\"Haitian Gourde\",\"code\":\"HTG\",\"symbol\":\"G\"},\n        {\"name\":\"Honduran Lempira\",\"code\":\"HNL\",\"symbol\":\"L\"},\n        {\"name\":\"Hong Kong Dollar\",\"code\":\"HKD\",\"symbol\":\"$\"},\n        {\"name\":\"Hungarian Forint\",\"code\":\"HUF\",\"symbol\":\"Ft\"},\n        {\"name\":\"Icelandic króna\",\"code\":\"ISK\",\"symbol\":\"kr\"},\n        {\"name\":\"Indian Rupee\",\"code\":\"INR\",\"symbol\":\"₹\"},\n        {\"name\":\"Indonesian Rupiah\",\"code\":\"IDR\",\"symbol\":\"Rp\"},\n        {\"name\":\"Iranian Rial\",\"code\":\"IRR\",\"symbol\":\"﷼\"},\n        {\"name\":\"Iraqi Dinar\",\"code\":\"IQD\",\"symbol\":\"د.ع\"},\n        {\"name\":\"Israeli New Sheqel\",\"code\":\"ILS\",\"symbol\":\"₪\"},\n        {\"name\":\"Italian Lira\",\"code\":\"ITL\",\"symbol\":\"L,£\"},\n        {\"name\":\"Jamaican Dollar\",\"code\":\"JMD\",\"symbol\":\"J$\"},\n        {\"name\":\"Japanese Yen\",\"code\":\"JPY\",\"symbol\":\"¥\"},\n        {\"name\":\"Jordanian Dinar\",\"code\":\"JOD\",\"symbol\":\"ا.د\"},\n        {\"name\":\"Kazakhstani Tenge\",\"code\":\"KZT\",\"symbol\":\"лв\"},\n        {\"name\":\"Kenyan Shilling\",\"code\":\"KES\",\"symbol\":\"KSh\"},\n        {\"name\":\"Kuwaiti Dinar\",\"code\":\"KWD\",\"symbol\":\"ك.د\"},\n        {\"name\":\"Kyrgystani Som\",\"code\":\"KGS\",\"symbol\":\"лв\"},\n        {\"name\":\"Laotian Kip\",\"code\":\"LAK\",\"symbol\":\"₭\"},\n        {\"name\":\"Latvian Lats\",\"code\":\"LVL\",\"symbol\":\"Ls\"},\n        {\"name\":\"Lebanese Pound\",\"code\":\"LBP\",\"symbol\":\"£\"},\n        {\"name\":\"Lesotho Loti\",\"code\":\"LSL\",\"symbol\":\"L\"},\n        {\"name\":\"Liberian Dollar\",\"code\":\"LRD\",\"symbol\":\"$\"},\n        {\"name\":\"Libyan Dinar\",\"code\":\"LYD\",\"symbol\":\"د.ل\"},\n        {\"name\":\"Lithuanian Litas\",\"code\":\"LTL\",\"symbol\":\"Lt\"},\n        {\"name\":\"Macanese Pataca\",\"code\":\"MOP\",\"symbol\":\"$\"},\n        {\"name\":\"Macedonian Denar\",\"code\":\"MKD\",\"symbol\":\"ден\"},\n        {\"name\":\"Malagasy Ariary\",\"code\":\"MGA\",\"symbol\":\"Ar\"},\n        {\"name\":\"Malawian Kwacha\",\"code\":\"MWK\",\"symbol\":\"MK\"},\n        {\"name\":\"Malaysian Ringgit\",\"code\":\"MYR\",\"symbol\":\"RM\"},\n        {\"name\":\"Maldivian Rufiyaa\",\"code\":\"MVR\",\"symbol\":\"Rf\"},\n        {\"name\":\"Mauritanian Ouguiya\",\"code\":\"MRO\",\"symbol\":\"MRU\"},\n        {\"name\":\"Mauritian Rupee\",\"code\":\"MUR\",\"symbol\":\"₨\"},\n        {\"name\":\"Mexican Peso\",\"code\":\"MXN\",\"symbol\":\"$\"},\n        {\"name\":\"Moldovan Leu\",\"code\":\"MDL\",\"symbol\":\"L\"},\n        {\"name\":\"Mongolian Tugrik\",\"code\":\"MNT\",\"symbol\":\"₮\"},\n        {\"name\":\"Moroccan Dirham\",\"code\":\"MAD\",\"symbol\":\"MAD\"},\n        {\"name\":\"Mozambican Metical\",\"code\":\"MZM\",\"symbol\":\"MT\"},\n        {\"name\":\"Myanmar Kyat\",\"code\":\"MMK\",\"symbol\":\"K\"},\n        {\"name\":\"Namibian Dollar\",\"code\":\"NAD\",\"symbol\":\"$\"},\n        {\"name\":\"Nepalese Rupee\",\"code\":\"NPR\",\"symbol\":\"₨\"},\n        {\"name\":\"Netherlands Antillean Guilder\",\"code\":\"ANG\",\"symbol\":\"ƒ\"},\n        {\"name\":\"New Taiwan Dollar\",\"code\":\"TWD\",\"symbol\":\"$\"},\n        {\"name\":\"New Zealand Dollar\",\"code\":\"NZD\",\"symbol\":\"$\"},\n        {\"name\":\"Nicaraguan Córdoba\",\"code\":\"NIO\",\"symbol\":\"C$\"},\n        {\"name\":\"Nigerian Naira\",\"code\":\"NGN\",\"symbol\":\"₦\"},\n        {\"name\":\"North Korean Won\",\"code\":\"KPW\",\"symbol\":\"₩\"},\n        {\"name\":\"Norwegian Krone\",\"code\":\"NOK\",\"symbol\":\"kr\"},\n        {\"name\":\"Omani Rial\",\"code\":\"OMR\",\"symbol\":\".ع.ر\"},\n        {\"name\":\"Pakistani Rupee\",\"code\":\"PKR\",\"symbol\":\"₨\"},\n        {\"name\":\"Panamanian Balboa\",\"code\":\"PAB\",\"symbol\":\"B/.\"},\n        {\"name\":\"Papua New Guinean Kina\",\"code\":\"PGK\",\"symbol\":\"K\"},\n        {\"name\":\"Paraguayan Guarani\",\"code\":\"PYG\",\"symbol\":\"₲\"},\n        {\"name\":\"Peruvian Nuevo Sol\",\"code\":\"PEN\",\"symbol\":\"S/.\"},\n        {\"name\":\"Philippine Peso\",\"code\":\"PHP\",\"symbol\":\"₱\"},\n        {\"name\":\"Polish Zloty\",\"code\":\"PLN\",\"symbol\":\"zł\"},\n        {\"name\":\"Qatari Rial\",\"code\":\"QAR\",\"symbol\":\"ق.ر\"},\n        {\"name\":\"Romanian Leu\",\"code\":\"RON\",\"symbol\":\"lei\"},\n        {\"name\":\"Russian Ruble\",\"code\":\"RUB\",\"symbol\":\"₽\"},\n        {\"name\":\"Rwandan Franc\",\"code\":\"RWF\",\"symbol\":\"FRw\"},\n        {\"name\":\"Salvadoran Colón\",\"code\":\"SVC\",\"symbol\":\"₡\"},\n        {\"name\":\"Samoan Tala\",\"code\":\"WST\",\"symbol\":\"SAT\"},\n        {\"name\":\"Saudi Riyal\",\"code\":\"SAR\",\"symbol\":\"﷼\"},\n        {\"name\":\"Serbian Dinar\",\"code\":\"RSD\",\"symbol\":\"din\"},\n        {\"name\":\"Seychellois Rupee\",\"code\":\"SCR\",\"symbol\":\"SRe\"},\n        {\"name\":\"Sierra Leonean Leone\",\"code\":\"SLL\",\"symbol\":\"Le\"},\n        {\"name\":\"Singapore Dollar\",\"code\":\"SGD\",\"symbol\":\"$\"},\n        {\"name\":\"Slovak Koruna\",\"code\":\"SKK\",\"symbol\":\"Sk\"},\n        {\"name\":\"Solomon Islands Dollar\",\"code\":\"SBD\",\"symbol\":\"Si$\"},\n        {\"name\":\"Somali Shilling\",\"code\":\"SOS\",\"symbol\":\"Sh.so.\"},\n        {\"name\":\"South African Rand\",\"code\":\"ZAR\",\"symbol\":\"R\"},\n        {\"name\":\"South Korean Won\",\"code\":\"KRW\",\"symbol\":\"₩\"},\n        {\"name\":\"Special Drawing Rights\",\"code\":\"XDR\",\"symbol\":\"SDR\"},\n        {\"name\":\"Sri Lankan Rupee\",\"code\":\"LKR\",\"symbol\":\"Rs\"},\n        {\"name\":\"St. Helena Pound\",\"code\":\"SHP\",\"symbol\":\"£\"},\n        {\"name\":\"Sudanese Pound\",\"code\":\"SDG\",\"symbol\":\".س.ج\"},\n        {\"name\":\"Surinamese Dollar\",\"code\":\"SRD\",\"symbol\":\"$\"},\n        {\"name\":\"Swazi Lilangeni\",\"code\":\"SZL\",\"symbol\":\"E\"},\n        {\"name\":\"Swedish Krona\",\"code\":\"SEK\",\"symbol\":\"kr\"},\n        {\"name\":\"Swiss Franc\",\"code\":\"CHF\",\"symbol\":\"CHf\"},\n        {\"name\":\"Syrian Pound\",\"code\":\"SYP\",\"symbol\":\"LS\"},\n        {\"name\":\"São Tomé and Príncipe Dobra\",\"code\":\"STD\",\"symbol\":\"Db\"},\n        {\"name\":\"Tajikistani Somoni\",\"code\":\"TJS\",\"symbol\":\"SM\"},\n        {\"name\":\"Tanzanian Shilling\",\"code\":\"TZS\",\"symbol\":\"TSh\"},\n        {\"name\":\"Thai Baht\",\"code\":\"THB\",\"symbol\":\"฿\"},\n        {\"name\":\"Tongan Pa'anga\",\"code\":\"TOP\",\"symbol\":\"$\"},\n        {\"name\":\"Trinidad & Tobago Dollar\",\"code\":\"TTD\",\"symbol\":\"$\"},\n        {\"name\":\"Tunisian Dinar\",\"code\":\"TND\",\"symbol\":\"ت.د\"},\n        {\"name\":\"Turkish Lira\",\"code\":\"TRY\",\"symbol\":\"₺\"},\n        {\"name\":\"Turkmenistani Manat\",\"code\":\"TMT\",\"symbol\":\"T\"},\n        {\"name\":\"Ugandan Shilling\",\"code\":\"UGX\",\"symbol\":\"USh\"},\n        {\"name\":\"Ukrainian Hryvnia\",\"code\":\"UAH\",\"symbol\":\"₴\"},\n        {\"name\":\"United Arab Emirates Dirham\",\"code\":\"AED\",\"symbol\":\"إ.د\"},\n        {\"name\":\"Uruguayan Peso\",\"code\":\"UYU\",\"symbol\":\"$\"},\n        {\"name\":\"US Dollar\",\"code\":\"USD\",\"symbol\":\"$\"},\n        {\"name\":\"Uzbekistan Som\",\"code\":\"UZS\",\"symbol\":\"лв\"},\n        {\"name\":\"Vanuatu Vatu\",\"code\":\"VUV\",\"symbol\":\"VT\"},\n        {\"name\":\"Venezuelan  Bolívar\",\"code\":\"VEF\",\"symbol\":\"Bs\"},\n        {\"name\":\"Vietnamese Dong\",\"code\":\"VND\",\"symbol\":\"₫\"},\n        {\"name\":\"Yemeni Rial\",\"code\":\"YER\",\"symbol\":\"﷼\"},\n        {\"name\":\"Zambian Kwacha\",\"code\":\"ZMK\",\"symbol\":\"ZK\"}\n    ];\n}","import { __, __html } from '@kenzap/k-cloud';\n\n// html product list loader\nexport const HTMLContent = () => {\n\nreturn `\n  <div class=\"container p-sk-edit mt-4\">\n    <div class=\"row\">\n        <div class=\"col-lg-9 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card\">\n            <div class=\"sections\" id=\"sections\" role=\"tablist\" style=\"width:100%;\">\n\n                <div class=\"row\">\n                    <div class=\"col-12 grid-margin stretch-card\">\n                        <div class=\"card border-white shadow-sm p-sm-3\">\n                            <div class=\"card-body\">\n\n                                <div class=\"landing_status\"></div>\n                                <input type=\"hidden\" class=\"form-control\" id=\"landing-slug\" value=\"\">\n\n                                <h4 id=\"sketch-h\" class=\"card-title mb-4\">${ __html('Sketch') }</h4>\n\n                                <div id=\"placeholders\">\n\n                                    <div class=\"mb-3\">\n                                        <label class=\"banner-descshort-l form-label d-none\" for=\"desc\">${ __html('Drawing') }</label>\n                                        <div class=\"btn-group mb-3\" role=\"group\" aria-label=\"Basic radio toggle button group\">\n                                            <input type=\"radio\" class=\"btn-check\" name=\"sketchmode\" id=\"preview\" autocomplete=\"off\" checked>\n                                            <label class=\"btn btn-outline-primary\" for=\"preview\">${ __html('Upload') }</label>\n\n                                            <input type=\"radio\" class=\"btn-check\" name=\"sketchmode\" id=\"drawing\" autocomplete=\"off\">\n                                            <label class=\"btn btn-outline-primary\" for=\"drawing\">${ __html('Drawing') }</label>\n\n                                            <input type=\"radio\" class=\"btn-check\" name=\"sketchmode\" id=\"editing\" autocomplete=\"off\">\n                                            <label class=\"btn btn-outline-primary\" for=\"editing\">${ __html('Editing') }</label>\n                                        </div>\n                                        <div class=\"drawing\"></div>\n                                        <div class=\"clearfix\"></div>\n                                    </div>\n\n                                    <div class=\"mb-3 \" style=\"max-width:600px;overflow:scroll;\">\n                                        <label class=\"banner-title-l form-label\" for=\"p-test\">${ __html('Input fields') }</label>\n                                        <div class=\"input-fields\">\n\n                                        </div>\n                                        <p class=\"form-text\"> </p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw\">\n                                        <label class=\"form-label\" for=\"calc_price\">${ __html('Calculate price') }</label>\n                                        <select id=\"calc_price\" class=\"form-select inp\" >\n                                            <option value=\"default\">${ __html('Default price') }</option>\n                                            <option value=\"variable\">${ __html('Variable') }</option>\n                                            <option value=\"sketch\">${ __html('By sketch') }</option>\n                                            <option value=\"formula\">${ __html('By formula') }</option>\n                                            <option value=\"complex\">${ __html('Complex product') }</option>\n                                        </select>\n                                        <p class=\"form-text\"> </p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw variable_prices_cont\">\n                                        <input type=\"hidden\" id=\"price\" value=\"\" />\n                                        <button class=\"btn btn-sm btn-outline-primary btn-view-variations mb-2\" type=\"button\">${ __html('View variations') }</button>\n                                        <p class=\"form-text\">${ __html('Override default prices by clicking on the button above.') }</p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw formula_cont d-none\">\n                                        <label class=\"form-label\" for=\"formula\">${ __html('Formula footage') }</label>\n                                        <input id=\"formula\" type=\"text\" class=\"form-control inp\" placeholder=\"${ __html('(A + B) * L') }\">\n                                        <p class=\"form-text formula-hint\">${ __html('Square formula to calculate price.') }</p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw fwl_cont\">\n                                        <div class=\"row\">\n                                            <div class=\"col-md-6\">\n                                                <label class=\"form-label\" for=\"formula\">${ __html('Formula width') }</label>\n                                                <input id=\"formula_width\" type=\"text\" class=\"form-control inp\" placeholder=\"${ __html('A + B + C') }\">\n                                                <p class=\"form-text formula_width-hint\">${ __html('Product width in mm.') }</p>\n                                            </div>\n                                            <div class=\"col-md-6\">\n                                                <label class=\"form-label\" for=\"formula\">${ __html('Formula length') }</label>\n                                                <input id=\"formula_length\" type=\"text\" class=\"form-control inp\" placeholder=\"${ __html('L') }\">\n                                                <p class=\"form-text formula_length-hint\">${ __html('Product length in mm.') }</p>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"mb-3 mw formula_price_cont d-none\">\n                                        <label class=\"form-label\" for=\"formula_price\">${ __html('Formula price') }</label>\n                                        <input id=\"formula_price\" type=\"text\" class=\"form-control inp\" placeholder=\"${ __html('B>1000?1.80:0.90') }\">\n                                        <p class=\"form-text formula_price-hint\">${ __html('Final price = Formula footage + Price formula.') }</p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw parts_cont d-none\">\n                                        <h4 id=\"parts-h\" class=\"card-title mb-4\">${ __html('Parts') }</h4>\n                                        <textarea id=\"parts\" class=\"form-control mw\" name=\"parts\" rows=\"6\" data-type=\"text\" style=\"font-size:13px;font-family: monospace;\"></textarea>\n                                        <p class=\"form-text formula_price-hint\">${ __html('Provide one product ID per line.') }</p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw \">\n                                        <input id=\"modelling\" class=\"form-check-input inp modelling\" name=\"modelling\" type=\"checkbox\" value=\"0\" data-type=\"checkbox\">\n                                        <label class=\"form-check-label\" for=\"modelling\">\n                                            ${ __html('3D Modelling') }\n                                        </label>\n                                        <p class=\"form-text\">${ __html('Enable 3D modelling options when product is previewed.') }</p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw \">\n                                        <label class=\"form-label\" for=\"tax_id\">${ __html('Tax ID') }</label>\n                                        <input id=\"tax_id\" class=\"form-control inp tax_id\" name=\"tax_id\" type=\"text\" value=\"0\" data-type=\"text\">\n                                        <p class=\"form-text\">${ __html('Tax code for 0 VAT rates.') }</p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw\">\n                                        <div class=\"list-wrapper\">\n                                            <ul class=\"d-flex flex-column-reverse\"> </ul>\n                                        </div>\n                                        <p class=\"form-text\"> </p>\n                                    </div>\n\n                                </div>\n\n                                <div class=\"desc-repeater-cont\">\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n\n            </div>\n        </div>\n    </div>\n  </div>\n\n  `;\n}","import { escape, unescape } from \"../_/_helpers.js\"\n\nexport class Polyline{\n    \n    constructor(data) {\n \n        this.data = data;\n\n        this.id = data.id ? data.id : this.genID(6);\n\n        this.mode = data.mode ? data.mode : 'drawing';\n\n        this.rect = data.rect ? data.rect : '';\n\n        this.selected = null;\n\n        this.style = { \n            stroke_width: '3px', \n            stroke: '#00F',\n            fill: 'rgba(255, 255, 255, 0)'\n        }\n\n        // console.log(this.id);\n\n        // if(this.id.includes('start')){\n        //     this.id = this.id.replace('start', '');    \n        //     this.rect = 'start';  \n        // }else if(this.id.includes('end')){\n        //     this.id = this.id.replace('end', '');\n        //     this.rect = 'end'; \n        // }else{\n        //     this.draw(data.points);\n        // }\n\n        this.draw(data.points);\n    }\n\n    /**\n     * Redraw this area with own or custom coordinates\n     * \n     * @param coords {Object} [coords=undefined]\n     * @returns {Area} - this area\n     */\n    draw = (points) => {\n        \n        if(this.mode != 'drawing') return;\n\n        let polyLine = `<g data-id=\"${ this.id }\" data-type=\"polyline\"><polyline data-id=\"${ this.id }\" points=\"${ this.polyPoints(points) }\" style=\"stroke-width:${ this.style.stroke_width };stroke:${ this.style.stroke };fill:${ this.style.fill };\"></polyline></g>`;\n        document.querySelector(\"#svg\").insertAdjacentHTML('beforeend', polyLine); \n\n        this.drawCircle('start', points);\n\n        // // remove listener\n        // let keypress = (e) => {\n\n        //     document.querySelector('#svg g[data-id=\"' + this.selected + '\"]').remove();\n\n        //     console.log(e.which);\n        // }\n\n        // // listener\n        // document.querySelector('#svg g[data-id=\"' + this.id + '\"]').addEventListener('click', (e) => {\n\n        //     this.selected = e.currentTarget.dataset.id;\n\n        //     document.removeEventListener('keydown', keypress, true);\n        //     document.addEventListener('keydown', keypress, true);\n\n        //     console.log('g:'+this.selected);\n        // });\n\n        // <rect class=\"helper pointer\" height=\"6\" width=\"6\" x=\"73\" y=\"179\"></rect><rect class=\"helper pointer\" height=\"6\" width=\"6\" x=\"144\" y=\"285\"></rect><rect class=\"helper pointer\" height=\"6\" width=\"6\" x=\"199\" y=\"248\"></rect><rect class=\"helper pointer\" height=\"6\" width=\"6\" x=\"129\" y=\"141\"></rect>\n\n        // this.setSVGCoords(coords ? coords : this._coords);\n        return this;\n    };\n\n    /**\n     * Set attributes for svg-elements of area by new parameters\n     * \n     * @param coords {Object} - Object with coords of this area, with field 'points'\n     */\n    setCoords = (data) => {\n\n        if(!document.querySelector('#svg polyline[data-id=\"'+this.id +'\"]')) return;\n\n        let poly_points = document.querySelector('#svg polyline[data-id=\"'+this.id +'\"]').getAttribute('points');\n\n        let poly_points_arr = poly_points.split(' ');\n\n        if(data.mode == 'drawing') {\n\n            if(poly_points_arr.length>3){ poly_points_arr = poly_points_arr.splice(0, 2); }\n\n            if(document.querySelector('#svg polyline[data-id=\"'+this.id +'\"]')) document.querySelector('#svg polyline[data-id=\"'+this.id +'\"]').setAttribute('points', (poly_points_arr.join(\" \") + \" \" + this.polyPoints(data.points)).trim());\n        }\n\n        if(data.mode == 'editing') {\n\n            switch(this.rect){\n\n                case 'start':\n                    poly_points_arr[0] = data.points[0].x;\n                    poly_points_arr[1] = data.points[0].y;\n                break;\n                case 'end':\n                    poly_points_arr[2] = data.points[0].x;\n                    poly_points_arr[3] = data.points[0].y;\n                break;\n            }\n\n            if(document.querySelector('#svg polyline[data-id=\"' + this.id + '\"]')) document.querySelector('#svg polyline[data-id=\"' + this.id + '\"]').setAttribute('points', poly_points_arr.join(\" \"));\n            if(document.querySelector('#svg rect[data-id=\"' + this.rect + this.id + '\"]')){\n\n                document.querySelector('#svg rect[data-id=\"' + this.rect + this.id + '\"]').setAttribute('x', data.points[0].x - 4);\n                document.querySelector('#svg rect[data-id=\"' + this.rect + this.id + '\"]').setAttribute('y', data.points[0].y - 4);\n            }\n\n            // console.log(this.rect + ' editing ' + this.id);\n        }\n    }\n\n    /**\n     * Set attributes for svg-elements of area by new parameters\n     * \n     * @param coords {Object} - Object with coords of this area, with field 'points'\n     */\n    setEndCoords = (points) => {\n\n        if(!document.querySelector('#svg polyline[data-id=\"'+this.id +'\"]')) return;\n\n        // console.log(points);\n        this.setCoords(points);\n        this.drawCircle('end', points.points);\n\n        // remove same dot lines \n        let poly_points = document.querySelector('#svg polyline[data-id=\"'+this.id +'\"]').getAttribute('points');\n        let poly_points_arr = poly_points.split(' ');\n\n        if(poly_points_arr[0]==poly_points_arr[2] && poly_points_arr[1]==poly_points_arr[3]) document.querySelector('#svg g[data-id=\"'+this.id +'\"]').remove();\n    }\n\n    /**\n     * Moving circle rect object\n     * \n     * @param coords {Object} - Object with coords of this area, with field 'points'\n     */\n    drawCircle = (type, points) => {\n\n        // console.log(points);\n\n        let rect = `<rect data-id=\"${ type + this.id }\" x=\"${ points[0].x - 4 }\" y=\"${ points[0].y - 4 }\" class=\"po\" data-type=\"polyline\" data-rect=\"${ type }\" width=\"8\" height=\"8\" rx=\"8\" style=\"stroke-width:2px;stroke:${ this.style.stroke };fill:rgba(255,255,255,1);\" />`;\n        if(document.querySelector('#svg g[data-id=\"'+this.id +'\"]')) document.querySelector('#svg g[data-id=\"' + this.id + '\"]').insertAdjacentHTML('beforeend', rect);\n    }\n\n    /**\n     * Converts polyline points from object to string. Example:\n     * [{x: 12, y: 100},{x: 15, y: 150}]\n     * 12 100 15 150\n     * @param points {Object} - Object with coords of this area, with field 'points'\n     * @returns {String} - string of points\n     */\n    polyPoints = (points) => {\n\n        return (points.reduce(function (previousValue, currentItem) {\n            return previousValue + currentItem.x + ' ' + currentItem.y + ' ';\n        }, '')).trim();\n    }\n\n    /**\n     * Set attributes for svg-elements of area by new parameters\n     * \n     * @param coords {Object} - Object with coords of this area, with field 'points'\n     * @returns {Polygon} - this area\n     */\n    setSVGCoords = (coords) => {\n\n        // let polygonPointsAttrValue = coords.points.reduce(function (previousValue, currentItem) {\n        //     return previousValue + currentItem.x + ' ' + currentItem.y + ' ';\n        // }, '');\n\n        // this._el.setAttribute('points', polygonPointsAttrValue);\n        // this.foreach(this._helpers.points, function (helper, i) {\n        //     helper.setCoords(coords.points[i].x, coords.points[i].y);\n        // });\n\n        return this;\n    };\n\n    /**\n     * Return current polyline id\n     * @returns {String} - string of points\n     */\n    getID = () => {\n\n        return this.id\n    }\n\n    /**\n     * Returns copy of original polygon, selected and moved by (10,10) from it\n     * \n     * @param len {Integer}\n     * @returns {Area} - a copy of original area\n     */\n    genID = (len) => {\n\n            let text = \"\";\n            let possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n    \n            for (let i = 0; i < len; i++)\n                text += possible.charAt(Math.floor(Math.random() * possible.length));\n    \n            return text;\n    };\n}\n\n\nexport class Arc {\n\n    constructor(data) {\n\n        this.data = data, \n\n        this.id = data.id ? data.id : this.genID(6);\n\n        this.mode = data.mode ? data.mode : 'drawing';\n\n        this.rect = data.rect ? data.rect : '';\n\n        this.style = { \n            stroke_width: '3px', \n            stroke: '#ff007d',\n            fill: 'rgba(255, 255, 255, 0)'\n        }\n\n        this.selected = null;\n\n        // console.log(data.params);\n\n        this.data.points = this.describeArc(data.params.x, data.params.y, data.params.radius, data.params.startAngle, data.params.endAngle);\n        \n        // console.log(\"draw arc\" + this.points);\n\n        // if(this.id.includes('start')){\n        //     this.id = this.id.replace('start', '');    \n        //     this.rect = 'start';  \n        // }else if(this.id.includes('end')){\n        //     this.id = this.id.replace('end', '');\n        //     this.rect = 'end'; \n        // }else{\n        //     this.draw(this.data);\n        // }\n\n        this.draw(this.data);\n    }\n\n    /**\n     * Redraw this area with own or custom coordinates\n     * \n     * @param coords {Object} [coords=undefined]\n     * @returns {Area} - this area\n     */\n    draw = (data) => {\n        \n        if(this.mode == 'drawing'){\n\n            let arc = `<g data-id=\"${ this.id }\" data-type=\"arc\" data-params=\"${ escape(JSON.stringify(data.params)) }\" ><path data-id=\"${ this.id }\" fill=\"transparent\" d=\"${ data.points }\" style=\"stroke-width:${ this.style.stroke_width };stroke:${ this.style.stroke };fill:${ this.style.fill };\"></path></g>`;\n            document.querySelector(\"#svg\").insertAdjacentHTML('beforeend', arc); \n\n            this.drawCircle('start', data);\n            this.drawCircle('end', data);\n        }\n\n        if(this.mode == 'editing'){\n\n            let params = JSON.parse(unescape(document.querySelector('#svg g[data-id=\"'+this.id +'\"]').dataset.params));\n\n            let a = params.x - data.params.x;\n            let b = params.y - data.params.y;\n \n            // let angle = this.rect == 'start' ? data.params.startAngle : data.params.endAngle;\n            let newDeg = (Math.atan2(a, b) * 180/Math.PI); newDeg = newDeg < 0 ? newDeg * (-1) : 360-newDeg; \n\n            // console.log('Deg start: ' + angle + ' Deg new: ' + newDeg);\n\n            if(this.rect == 'start') params.startAngle = newDeg;\n            if(this.rect == 'end') params.endAngle = newDeg;\n\n            this.data.points = this.describeArc(params.x, params.y, params.radius, params.startAngle, params.endAngle);\n\n            // update arc\n            document.querySelector('#svg g[data-id=\"'+this.id+'\"] path').setAttribute('d', this.data.points);\n            document.querySelector('#svg g[data-id=\"'+this.id+'\"]').dataset.params = escape(JSON.stringify(params));\n\n            // update circles\n            document.querySelector('#svg g[data-id=\"'+this.id+'\"] rect[data-rect=\"'+this.rect+'\"').setAttribute('x', params.x + (data.params.radius * Math.cos(this.degToRad(newDeg))) - 4);\n            document.querySelector('#svg g[data-id=\"'+this.id+'\"] rect[data-rect=\"'+this.rect+'\"').setAttribute('y', params.y + (data.params.radius * Math.sin(this.degToRad(newDeg))) - 4);\n        }\n\n        return this;\n    };\n\n    /**\n     * Moving circle rect object\n     * \n     * @param coords {Object} - Object with coords of this area, with field 'points'\n     */\n    drawCircle = (type, data) => {\n\n        var angleInRadians = 0;\n        \n        if(type == 'start') angleInRadians = this.degToRad(data.params.startAngle);\n        if(type == 'end') angleInRadians = this.degToRad(data.params.endAngle);\n        \n        let x = (data.params.x + (data.params.radius * Math.cos(angleInRadians))) - 4;\n        let y = (data.params.y + (data.params.radius * Math.sin(angleInRadians))) - 4;\n\n        // console.log('X: ' + x);\n        // console.log('Y: ' + y);\n\n        let rect = `<rect data-id=\"${ type + this.id }\" x=\"${ x }\" y=\"${ y }\" data-type=\"arc\" class=\"po\" data-rect=\"${ type }\" width=\"8\" height=\"8\" rx=\"8\" style=\"stroke-width:2px;stroke:${ this.style.stroke };fill:rgba(255,255,255,1);\" />`;\n        if(document.querySelector('#svg g[data-id=\"'+this.id +'\"]')) document.querySelector('#svg g[data-id=\"'+this.id +'\"]').insertAdjacentHTML('beforeend', rect);\n    }\n\n    polarToCartesian = (centerX, centerY, radius, angleInDegrees) => {\n\n        var angleInRadians = this.degToRad(angleInDegrees);\n\n        return {\n            x: centerX + (radius * Math.cos(angleInRadians)),\n            y: centerY + (radius * Math.sin(angleInRadians))\n        };\n    }\n\n    describeArc = (x, y, radius, startAngle, endAngle) => {\n\n        var endAngleOriginal = endAngle;\n        if (endAngleOriginal - startAngle === 360) {\n            endAngle = 359;\n        }\n\n        var start = this.polarToCartesian(x, y, radius, endAngle);\n        var end = this.polarToCartesian(x, y, radius, startAngle);\n\n        var arcSweep = endAngle - startAngle <= 180 ? \"0\" : \"1\";\n\n        if (endAngleOriginal - startAngle === 360) {\n            var d = [\n                \"M\", start.x, start.y,\n                \"A\", radius, radius, 0, arcSweep, 0, end.x, end.y, \"z\"\n            ].join(\" \");\n        }\n        else {\n            var d = [\n                \"M\", start.x, start.y,\n                \"A\", radius, radius, 0, arcSweep, 0, end.x, end.y\n            ].join(\" \");\n        }\n\n        return d;\n    }\n\n    /**\n     * Converts degrees to radians\n     * \n     * @param deg {Integer}\n     * @returns {Integer} - radians\n     */\n    degToRad = (deg) => {\n\n        return (deg - 90) * Math.PI / 180.0;\n    }\n\n    /**\n     * Returns copy of original polygon, selected and moved by (10,10) from it\n     * \n     * @param len {Integer}\n     * @returns {Area} - a copy of original area\n     */\n     genID = (len) => {\n\n        let text = \"\";\n        let possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n        for (let i = 0; i < len; i++)\n            text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n        return text;\n    };\n\n    getPath = () => {\n        \n        return this.points;\n    }\n\n    getID = () => {\n\n        return this.id;\n    }\n}","// js dependencies\nimport { headers, showLoader, hideLoader, parseApiError, getCookie, onClick, onChange, onKeyUp, simulateClick, spaceID, toast, link, __, __html } from '@kenzap/k-cloud';\nimport { getProductId, escape, unescape, onlyNumbers, priceFormat, degToRad } from \"../_/_helpers.js\"\nimport { HTMLContent } from \"../_/_cnt_product_edit_sk_design.js\"\nimport { Polyline, Arc } from \"../_/_2d.js\"\n\nconst CDN = 'https://kenzap-sites.oss-ap-southeast-1.aliyuncs.com/';\n\n// where everything happens\nconst _this = {\n\n    init: () => {\n        \n        _this.getData(); \n    },\n    state: {\n        ajaxQueue: 0,\n        settings: {}, // where all requested settings are cached\n        sk_settings: {}, // where all requested settings are cached\n        firstLoad: true,\n        product: { input_fields: [] },\n        sketch: { mode: 'preview', type: '', mousedown: false, last: { id: null }, angle: false }\n    },\n    getData: () => {\n\n        let id = getProductId();\n        let sid = spaceID();\n\n        fetch('https://api-v1.kenzap.cloud/', {\n            method: 'post',\n            headers: headers,\n            body: JSON.stringify({\n                query: {\n                    user: {\n                        type:       'authenticate',\n                        fields:     ['avatar'],\n                        token:      getCookie('kenzap_token')\n                    },\n                    product: {\n                        type:       'find',\n                        key:        'ecommerce-product',\n                        id:         id,   \n                        fields:     ['_id', 'id', 'test', 'modelling', 'tax_id', 'input_fields', 'formula', 'formula_price', 'formula_width', 'formula_length', 'calc_price', 'var_price', 'parts', 'updated']\n                    },\n                    settings: {\n                        type:       'get',\n                        key:        'ecommerce-settings',\n                        fields:     ['currency', 'currency_symb', 'currency_symb_loc', 'tax_calc', 'tax_auto_rate', 'tax_rate', 'tax_display'],\n                    },\n                    sk_settings: {\n                        type:       'get',\n                        key:        'sk-settings',\n                        fields:     ['var_parent', 'price'],\n                    },\n                    locale: {\n                        type:       'locale',\n                        source:      ['extension'],\n                        key:         'sk-design',\n                    }\n                }\n            }) \n        })\n        .then(response => response.json())\n        .then(response => {\n\n            // hide UI loader\n            hideLoader();\n\n            if (!response.success){ parseApiError(response); return; }\n\n            if (response.success){\n\n                _this.state.settings = response.settings;\n                _this.state.sk_settings = response.sk_settings;\n                _this.state.product = response.product;\n\n                // check product response\n                if (response.product.length == 0) { return; }\n\n                // get core html content \n                document.querySelector('#contents').insertAdjacentHTML('beforeend', HTMLContent()); // innerHTML = HTMLContent(__);\n\n                // load images if any\n                _this.loadDrawing(response.product);\n\n                // bind frontend data\n                _this.renderPage(response.product);\n\n                // init page listeners\n                _this.initListeners();\n            }\n        })\n        .catch(error => { parseApiError(error); });\n    },\n    renderPage: (product) => {\n\n        let d = document;\n\n        _this.state.sketch.mode = 'drawing';\n\n        // console.log(product);\n\n        // return;\n\n        // input fields\n        if(product.input_fields){\n            \n            simulateClick(document.querySelector('#editing')); \n\n            product.input_fields.forEach(obj => {\n\n                let html = _this.structInputRow(obj);\n\n                if(!document.querySelector('#field'+obj.id)) document.querySelector('.input-fields').insertAdjacentHTML('beforeend', html);\n                \n                if(!document.querySelector('#svg g[data-id=\"' + obj.id+ '\"]')){\n\n                    switch(obj.type){\n\n                        case 'polyline':\n\n                            let points_arr = obj.points.split(' ');\n                            _this.state.sketch.polyline = new Polyline({ points: [{x: points_arr[0], y: points_arr[1] }], mode: 'drawing', id: obj.id });\n                            _this.state.sketch.polyline.setCoords({ points: [{x: points_arr[2], y: points_arr[3] }], mode: 'drawing' });\n                            _this.state.sketch.polyline.setEndCoords({ points: [{x: points_arr[2], y: points_arr[3] }], mode: 'drawing' });\n                        break;\n                        case 'arc':\n\n                            // console.log(obj);\n\n                            obj.params = typeof(obj.params) == 'string' ? {} : obj.params;\n\n                            // obj.params = JSON.parse(unescape(obj.params)); \n                          \n                            _this.state.sketch.arc = new Arc({ params: { x: obj.params.x, y: obj.params.y, radius: obj.params.radius, startAngle: obj.params.startAngle, endAngle: obj.params.endAngle }, mode: 'drawing', id: obj.id });\n                        break;\n                    }\n                }\n            });\n\n            _this.refreshFields();\n        }\n\n        _this.listeners.inputFieldListeners();\n\n        _this.state.sketch.polyline = null;\n\n        // calculate prce\n        d.querySelector(\"#calc_price\").value = product.calc_price ? product.calc_price : 'default';\n\n        // formula\n        d.querySelector(\"#formula\").value = product.formula;\n        d.querySelector(\"#formula_price\").value = product.formula_price;\n        d.querySelector(\"#formula_width\").value = product.formula_width;\n        d.querySelector(\"#formula_length\").value = product.formula_length;\n\n        // variable prices\n        d.querySelector(\"#price\").value = JSON.stringify(product.var_price ? product.var_price : []);\n\n        // modelling mode\n        d.querySelector(\"#modelling\").checked = product.modelling == 1 ? true : false;\n        d.querySelector(\"#tax_id\").value = product.tax_id;\n\n        // price container visibility\n        _this.listeners.priceContVisibility();\n\n        // validate formula\n        document.querySelector(\"#formula\").addEventListener('keyup', (e) => {\n\n            let formula = e.currentTarget.value;\n            let labels = \"COATING \";\n\n            // selected coating price\n            formula = formula.replaceAll(\"COATING\", 1);\n\n            for(let div of document.querySelectorAll('.input-fields > div')){\n\n                labels += div.querySelector('.field-label').value + \" \";\n                formula = formula.replaceAll(div.querySelector('.field-label').value, parseFloat(div.querySelector('.field-default').value));\n            }\n            labels = labels.trim();\n\n            let result = 0;\n\n            try{\n                document.querySelector(\".formula-hint\").innerHTML = '';\n                result = eval(formula);\n                document.querySelector(\"#formula\").setCustomValidity(\"\");\n            }catch(e){\n                document.querySelector(\"#formula\").setCustomValidity( __(\"Invalid formula\") );\n                document.querySelector(\".formula-hint\").innerHTML = __(\"Invalid formula. Use one of the following letters only: \" + labels);\n            }\n\n            document.querySelector(\"#formula\").parentElement.classList.add('was-validated');\n            \n            if(result>0) document.querySelector(\".formula-hint\").innerHTML = __(\"Result: <b>\" + result / 1000000 + \" ㎡</b> based on the input fields default values\", result);\n        });\n\n        // validate formula price\n        document.querySelector(\"#formula_price\").addEventListener('keyup', (e) => {\n\n            let formula = e.currentTarget.value;\n            let labels = \"COATING \";\n\n            // selected coating price\n            formula = formula.replaceAll(\"COATING\", 1);\n\n            for(let price of _this.state.sk_settings.price){\n\n                if(price.id.length == 0) continue;\n\n                labels += price.id + \" \";\n                formula = formula.replaceAll(price.id, parseFloat(price.price));\n            }\n\n            for(let div of document.querySelectorAll('.input-fields > div')){\n\n                labels += div.querySelector('.field-label').value + \" \";\n                formula = formula.replaceAll(div.querySelector('.field-label').value, parseFloat(div.querySelector('.field-default').value));\n            }\n        \n            // console.log(formula);\n\n            labels = labels.trim();\n\n            let result = 0;\n\n            try{\n                document.querySelector(\".formula_price-hint\").innerHTML = '';\n                result = eval(formula);\n                document.querySelector(\"#formula_price\").setCustomValidity(\"\");\n            }catch(e){\n                document.querySelector(\"#formula_price\").setCustomValidity( __(\"Invalid price formula\") );\n                document.querySelector(\".formula_price-hint\").innerHTML = __(\"Invalid price formula. Use one of the following letters only: \" + labels);\n            }\n\n            document.querySelector(\"#formula_price\").parentElement.classList.add('was-validated');\n            \n            if(result>0) document.querySelector(\".formula_price-hint\").innerHTML = __(\"Result: <b>\" + priceFormat(_this, result) + \"</b> based on the input fields default values\", result);\n        });\n\n        // validate formula width\n        document.querySelector(\"#formula_width\").addEventListener('keyup', (e) => {\n\n            let formula = e.currentTarget.value;\n            let labels = \" \";\n            \n            for(let div of document.querySelectorAll('.input-fields > div')){\n\n                labels += div.querySelector('.field-label').value + \" \";\n                formula = formula.replaceAll(div.querySelector('.field-label').value, parseFloat(div.querySelector('.field-default').value));\n            }\n\n            labels = labels.trim();\n\n            let result = 0;\n\n            try{\n                document.querySelector(\".formula_width-hint\").innerHTML = '';\n                result = eval(formula);\n                document.querySelector(\"#formula_width\").setCustomValidity(\"\");\n            }catch(e){\n\n                console.log(e);\n                document.querySelector(\"#formula_width\").setCustomValidity( __(\"Invalid width formula\") );\n                document.querySelector(\".formula_width-hint\").innerHTML = __(\"Invalid width formula. Use one of the following letters only: \" + labels);\n            }\n\n            document.querySelector(\"#formula_width\").parentElement.classList.add('was-validated');\n        });\n\n        // validate formula length\n        document.querySelector(\"#formula_length\").addEventListener('keyup', (e) => {\n\n            let formula = e.currentTarget.value;\n            let labels = \" \";\n            \n            for(let div of document.querySelectorAll('.input-fields > div')){\n\n                labels += div.querySelector('.field-label').value + \" \";\n                formula = formula.replaceAll(div.querySelector('.field-label').value, parseFloat(div.querySelector('.field-default').value));\n            }\n\n            labels = labels.trim();\n\n            let result = 0;\n\n            try{\n                document.querySelector(\".formula_length-hint\").innerHTML = '';\n                result = eval(formula);\n                document.querySelector(\"#formula_length\").setCustomValidity(\"\");\n            }catch(e){\n\n                console.log(e);\n                document.querySelector(\"#formula_length\").setCustomValidity( __(\"Invalid length formula\") );\n                document.querySelector(\".formula_length-hint\").innerHTML = __(\"Invalid length formula. Use one of the following letters only: \" + labels);\n            }\n\n            document.querySelector(\"#formula_length\").parentElement.classList.add('was-validated');\n        });\n\n        // parts   \n        if(!product.parts) product.parts = [];\n        if(!Array.isArray(product.parts)) product.parts = [];\n\n        product.parts.forEach(part => {\n\n            document.querySelector(\"#parts\").value += part.id + '\\n';\n        });\n    },\n    initListeners: () => {\n\n        if(!_this.state.firstLoad) return;\n\n        // product save button\n        onClick('.btn-save', _this.listeners.saveProduct);\n        \n        // modal success button\n        onClick('.p-modal .btn-primary', _this.listeners.modalSuccessBtn);\n\n        // price type change\n        onChange('#calc_price', _this.listeners.priceChange);\n\n        _this.state.firstLoad = false;\n    },\n    listeners: {\n\n        priceChange: (e) => {\n\n            e.preventDefault();\n\n            _this.listeners.priceContVisibility();\n\n        },\n\n        priceContVisibility: () => {\n\n            document.querySelector('.formula_cont').classList.add(\"d-none\");\n            document.querySelector('.formula_price_cont').classList.add(\"d-none\");\n            document.querySelector('.parts_cont').classList.add(\"d-none\");\n            document.querySelector('.variable_prices_cont').classList.add(\"d-none\");\n\n            let calc_price = document.querySelector('#calc_price').value;\n\n            if(calc_price==\"variable\"){\n\n                document.querySelector('.variable_prices_cont').classList.remove(\"d-none\");\n            }\n\n            if(calc_price==\"formula\"){\n\n                document.querySelector('.formula_cont').classList.remove(\"d-none\");\n                document.querySelector('.formula_price_cont').classList.remove(\"d-none\");\n            }\n\n            if(calc_price==\"complex\"){\n\n                document.querySelector('.parts_cont').classList.remove(\"d-none\");\n            }\n        },\n\n        viewVariations: (e) => {\n\n            let modal = document.querySelector(\".modal\");\n            let modalCont = new bootstrap.Modal(modal);\n            \n            modal.querySelector(\".modal-dialog\").classList.add('modal-lg');\n            modal.querySelector(\".modal-title\").innerHTML = __html(\"Variations\");\n            modal.querySelector(\".btn-primary\").classList.add(\"d-none\");\n            modal.querySelector(\".btn-secondary\").innerHTML = __html('Close');\n\n            // console.log(_this.state.sk_settings);\n \n            let modalHTml = `\n\n                <div class=\"row\">\n                    <div class=\"col-sm-12\">\n                        <div class=\"table-responsive\">\n                            <table class=\"price-table order-form mb-3\">\n                                <theader>\n                                    <tr><th><div class=\"me-1 me-sm-3\">${ __html('Site') }</div></th><th class=\"qty\"><div class=\"me-1 me-sm-3\">${ __html('Code') }</div></th><th><div class=\"me-1 me-sm-3\">${ __html('Parent') }</div></th><th><div class=\"me-1 me-sm-3\">${ __html('Title') }</div></th><th class=\"tp\"><div class=\"me-1 me-sm-3\">${ __html('Price') }</div></th><th class=\"tp\"><div class=\"me-1 me-sm-3\">${ __html('Unit') }</div></th><th></th></tr>\n                                    <tr class=\"new-item-row\">\n                                        <td>\n            \n                                        </td>\n                                        <td class=\"tp\">\n                                            <div class=\"me-1 me-sm-3 mt-2\">\n                                                <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control price-id\" style=\"max-width:100px;\">\n                                            </div>\n                                        </td>\n                                        <td>\n                                            <div class=\"me-1 me-sm-3 mt-2\">\n                                                <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control price-parent\" style=\"max-width:120px;\">\n                                                <select class=\"form-select price-parent- inp d-none\" name=\"price_parent- \" data-type=\"select\">\n            \n                                                </select>\n                                            </div>\n                                        </td>\n                                        <td>\n                                        <div class=\"me-1 me-sm-3 mt-2\">\n                                            <input type=\"text\" value=\"\" autocomplete=\"off\" placeholder=\" \" class=\"form-control price-title\" data-id=\"\" data-index=\"\" list=\"item-suggestions\">\n                                        </div>\n                                        </td>\n                                        <td class=\"price\">\n                                            <div class=\"me-1 me-sm-3 mt-2\">\n                                                <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control text-right price-price\" style=\"max-width:80px;\">\n                                            </div>\n                                        </td>\n                                        <td class=\"price\">\n                                            <div class=\"me-1 me-sm-3 mt-2\">\n                                            <select class=\"form-select price-unit inp\" name=\"price_unit\" data-type=\"select\">\n                                                <option value=\"unit\" selected>${ __html('Unit') }</option>\n                                                <option value=\"length\">${ __html('Length') }</option>\n                                                <option value=\"m2\">${ __html('㎡') }</option>\n                                                <option value=\"hour\">${ __html('Hour') }</option>\n                                            </select>\n                                            </div>\n                                        </td>\n                                        <td class=\"align-middle text-center pt-2\"> \n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 16 16\" width=\"24\" height=\"24\" class=\"bi bi-plus-circle text-success align-middle add-price po\"><path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"></path><path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"></path></svg>\n                                        </td>\n                                    </tr>\n                                </theader>\n                                <tbody>`;\n\n                  modalHTml += `</tbody>\n                            </table>\n                        </div>\n                    </div>\n                </div>`;\n\n            // add generated HTML code to the modal body \n            modal.querySelector(\".modal-body\").innerHTML = modalHTml;\n\n            // price variations\n            // setup coatings and prices\n            let price = JSON.parse(document.querySelector('#price').value), var_parent = [];\n            let parent_options = '<option value=\"\">'+__('None')+'</option>';\n            if(price.length == 0) price = _this.state.sk_settings.price;\n            if(_this.state.sk_settings.var_parent) var_parent = _this.state.sk_settings.var_parent;\n\n            console.log(price);\n\n            if(Array.isArray(price)){\n\n                // pricing row parent\n                price.forEach((price, i) => {\n\n                    if(!price.parent){\n\n                        document.querySelector('.price-table > tbody').insertAdjacentHTML(\"beforeend\", _this.structCoatingRow(price, i));\n                        // parent_options += '<option value=\"'+price.id+'\">'+price.title+'</option>';\n                    }\n                });\n                \n                // pricing row\n                price.forEach((price, i) => {\n\n                    if(price.parent){\n\n                        // console.log('.price-table > tbody [data-parent=\"'+price.parent+'\"]');\n                        if(document.querySelector('.price-table > tbody [data-parent=\"'+price.parent+'\"]')) { \n                            document.querySelector('.price-table > tbody [data-parent=\"'+price.parent+'\"]').insertAdjacentHTML(\"afterend\", _this.structCoatingRow(price, i)); // :last-child\n                        }else{\n                            document.querySelector('.price-table > tbody').insertAdjacentHTML(\"beforeend\", _this.structCoatingRow(price, i));\n                        }\n                    }\n                });\n                                    \n            }else{\n                price = [];\n                document.querySelector('#price').value = '[]';\n            }\n\n            var_parent.split('\\n').forEach(el => {\n\n                parent_options += '<option value=\"'+el+'\">'+el+'</option>';\n            });\n            document.querySelector('.price-parent').innerHTML = parent_options;    \n\n            // add price listener\n            onClick('.remove-price', _this.listeners.removePrice);\n            \n            // only nums for price\n            onlyNumbers(\".price-price\", [8, 46]);\n\n            // update price\n            onKeyUp('.price-price', _this.listeners.updatePrice);\n            \n            // price public\n            onClick('.price-public', _this.listeners.publicPrice);\n\n            // cache prices\n            document.querySelector('#price').value = JSON.stringify(price);\n\n            // add price listener\n            onClick('.add-price', _this.listeners.addPrice);\n\n            // success buttton\n            // _this.listeners.modalSuccessBtnFunc = (e) => {\n\n            //     e.preventDefault();\n            // } \n            \n            modalCont.show();\n\n        },\n\n        editBlock: (e) => {\n\n            e.preventDefault();\n\n            let amb = document.querySelector('.add-mix-block');\n            amb.dataset.action = 'edit';\n            amb.dataset.index = e.currentTarget.dataset.index;\n            setTimeout(() => simulateClick(amb), 10);\n\n            console.log('editBlock');\n        },\n\n        inputFieldListeners: (e) => {\n            \n            onClick('.remove-input-field', _this.listeners.removeInputFields);\n            onlyNumbers('.field-default', [8, 46]);\n            onlyNumbers('.field-min', [8, 46]);\n            onlyNumbers('.field-max', [8, 46]);\n        },\n\n        removeBlock: (e) => {\n\n            e.preventDefault();\n\n            let c = confirm(__('Remove entire block?'));\n            if(c){ \n                e.currentTarget.parentNode.parentNode.remove();\n                // e.currentTarget.parentElement.parentElement.remove();\n             }\n\n            console.log('removeBlock');\n        },\n\n        removeInputFields: (e) => {\n\n            let c = confirm( __('Remove row?') );\n\n            if(!c) return;\n\n            let id = e.currentTarget.dataset.id;\n            \n            console.log('remove' + id);\n\n            if(document.querySelector('#svg g[data-id=\"' + id + '\"]')) document.querySelector('#svg g[data-id=\"' + id + '\"]').remove();\n            if(document.querySelector('.input-fields #field' + id)) document.querySelector('.input-fields #field' + id).remove();\n            if(document.querySelector('.svg-input[data-id=\"' + id + '\"]')) document.querySelector('.svg-input[data-id=\"' + id + '\"]').remove();\n        },\n\n        // sync select field label update with sketch labels \n        inputFieldChange: (e) => {\n\n            console.log(e.currentTarget.value);\n\n            let id = e.currentTarget.parentElement.parentElement.id.replace('field', '');\n\n            document.querySelector('.svg-input[data-id=\"' + id + '\"] > label').innerHTML = e.currentTarget.value;\n        },\n\n        saveProduct: (e) => {\n            \n            e.preventDefault();\n\n            // running updates cuncurrently causes data loss\n            setTimeout(() => {\n\n                let data = {};\n\n                data['input_fields'] = [];\n\n                // iterate through input fields\n                for(let div of document.querySelectorAll('.input-fields > div')){\n\n                    let obj = {};\n\n                    obj['id'] = div.id.replace('field','');\n                    obj['points'] = div.dataset.points;\n                    obj['type'] = div.dataset.type;\n                    obj['params'] = obj['type'] == 'arc' ? JSON.parse(unescape(div.dataset.params)) : {};\n                    obj['label'] = div.querySelector('.field-label').value;\n                    obj['label_pos'] = div.querySelector('.field-label-pos').value;\n                    obj['default'] = parseFloat(div.querySelector('.field-default').value);\n                    obj['min'] = parseFloat(div.querySelector('.field-min').value);\n                    obj['max'] = parseFloat(div.querySelector('.field-max').value);\n\n                    data['input_fields'].push(obj);\n                }\n\n                data['var_price'] = JSON.parse(document.querySelector('#price').value);\n                data['calc_price'] = document.querySelector('#calc_price').value;\n                data['formula'] = document.querySelector('#formula').value.trim();\n                data['formula_price'] = document.querySelector('#formula_price').value.trim();\n                data['formula_width'] = document.querySelector('#formula_width').value.trim();\n                data['formula_length'] = document.querySelector('#formula_length').value.trim();\n                data['modelling'] = document.querySelector('#modelling').checked ? 1 : 0;\n                data['tax_id'] = document.querySelector('#tax_id').value;\n                data['parts'] = [];\n                \n                // console.log(document.querySelector(\"#parts\"));\n\n                document.querySelector(\"#parts\").value.trim().split('\\n').forEach(el => {\n\n                    data['parts'].push({id: el});\n                }); \n                //  = product.parts.join('\\n');\n\n                console.log(data); \n            \n                let id = getProductId();\n                let sid = spaceID();\n\n                // showLoader();\n\n                // send data\n                fetch('https://api-v1.kenzap.cloud/', {\n                    method: 'post',\n                    headers: headers,\n                    body: JSON.stringify({\n                        query: {\n                            product: {\n                                type:       'update',\n                                key:        'ecommerce-product',\n                                id:         id,         \n                                sid:        sid,\n                                data:       data\n                            }\n                        }\n                    }) \n                })\n                .then(response => response.json())\n                .then(response => {\n\n                    if (response.success){\n\n                        // console.log('sk saved');\n\n                        // upload desc images\n                        _this.uploadImages();\n                        \n                    }else{\n\n                        parseApiError(response);\n                    }\n                })\n                .catch(error => { parseApiError(error); });\n\n            }, 1000);\n        },\n\n        openImage: (e) => {\n\n            e.preventDefault();\n\n            simulateClick(document.querySelector(\".aif-\"+e.currentTarget.dataset.index));\n        },\n\n        previewImage: (e) => {\n\n            e.preventDefault();\n\n            let input = e.currentTarget;\n\n            if (input.files && input.files[0]) {\n\n                // check image type\n                if(input.files[0].type != 'image/jpeg' && input.files[0].type != 'image/jpg' && input.files[0].type != 'image/png'){\n\n                    toast( __(\"Please provide image in JPEG format\") );\n                    return;\n                }\n          \n                // check image size\n                if(input.files[0].size > 5000000){\n\n                    toast( __(\"Please provide image less than 5 MB in size!\") );\n                    return;\n                }\n\n                let index = input.dataset.index;\n                let reader = new FileReader();\n                reader.onload = function(e) {\n                  \n                    document.querySelector('.images-'+index).setAttribute('src', e.currentTarget.result);\n                }\n                reader.readAsDataURL(input.files[0]);\n\n                e.currentTarget.parentElement.querySelector('.remove').classList.remove(\"hd\");\n            }\n        },\n\n        removeImage: (e) => {\n\n            let index = e.currentTarget.parentElement.dataset.index;\n            document.querySelector('.aif-' + index).value = '';\n            document.querySelector('.images-'+index).setAttribute('src', 'https://account.kenzap.com/images/placeholder.jpg');\n            e.currentTarget.classList.add(\"hd\");\n        },\n\n        sketchMode: (e) => {\n\n            _this.state.sketch.mode = e.currentTarget.id;\n\n            // console.log('sketchMode'+e.currentTarget.id);\n\n            if(e.currentTarget.id == 'preview'){ document.querySelector(\"#svg\").style.zIndex = '-2'; }else{ document.querySelector(\"#svg\").style.zIndex = '2'; }\n            \n            document.querySelector(\".sketch-cont\").dataset.mode = e.currentTarget.id;     \n        },\n\n        modalSuccessBtn: (e) => {\n            \n            console.log('calling modalSuccessBtnFunc');\n            _this.listeners.modalSuccessBtnFunc(e);\n        },\n\n        stockManagement: (e) => {\n\n            for(let el of document.querySelectorAll('.stock-cont')){\n                e.currentTarget.checked ? el.classList.remove('d-none') : el.classList.add('d-none');\n                e.currentTarget.value = e.currentTarget.checked ? \"1\" : \"0\";\n            }\n        },\n\n        addPrice: (e) => {\n\n            let obj = {}\n\n            obj.id = document.querySelector('.price-id').value; // document.querySelector('.price-id').value = '';\n            obj.title = document.querySelector('.price-title').value; document.querySelector('.price-title').value = '';\n            obj.parent = document.querySelector('.price-parent').value; // document.querySelector('.price-parent').value = '';\n            obj.price = document.querySelector('.price-price').value; // document.querySelector('.price-price').value = '';\n            obj.unit = document.querySelector('.price-unit').value; // document.querySelector('.price-unit').value = '';\n            obj.public = true;\n\n            if(obj.title.length < 1 || obj.price.length < 1) return false;\n\n            // console.log(obj);\n\n            let prices = document.querySelector('#price').value;\n\n            // console.log(prices);\n\n            if(prices){ prices = JSON.parse(prices); }else{ prices = []; }\n            if(Array.isArray(prices)){ prices.push(obj); }else{ prices = []; }\n            document.querySelector('#price').value = JSON.stringify(prices);\n\n            if(document.querySelector('.price-table > tbody [data-parent=\"'+obj.parent+'\"]:last-child')){ \n                document.querySelector('.price-table > tbody [data-parent=\"'+obj.parent+'\"]:last-child').insertAdjacentHTML(\"afterend\", _this.structCoatingRow(obj, prices.length-1));\n            }else{\n                document.querySelector('.price-table').insertAdjacentHTML(\"beforeend\", _this.structCoatingRow(obj, prices.length-1));\n            }\n\n            // add price listener\n            onClick('.remove-price', _this.listeners.removePrice);\n\n            // only nums for price\n            onlyNumbers(\".price-price\", [8, 46]);\n\n            // update price\n            onKeyUp('.price-price', _this.listeners.updatePrice);\n            // onChange('.price-price', _this.listeners.updatePrice);\n\n            // price public\n            onClick('.price-public', _this.listeners.publicPrice);\n        },\n\n        removePrice: (e) => {\n\n            e.preventDefault();\n\n            let c = confirm( __('Remove this record?') );\n\n            if(!c) return;\n\n            let hash = e.currentTarget.parentElement.parentElement.dataset.hash;\n\n            let prices = JSON.parse(document.querySelector('#price').value);\n\n            prices = prices.filter((obj) => { return escape(obj.id+obj.title+obj.parent) != hash });\n\n            document.querySelector('#price').value = JSON.stringify(prices);\n\n            e.currentTarget.parentElement.parentElement.remove();\n\n        },\n\n        updatePrice: (e) => {\n\n            e.preventDefault();\n\n            // let i = e.currentTarget.dataset.i;\n\n            let hash = (e.currentTarget.parentElement.parentElement.parentElement.dataset.hash);\n\n            if(!hash) return;\n\n            let prices = JSON.parse(document.querySelector('#price').value);\n\n            prices.forEach((obj, i) => { if(escape(obj.id+obj.title+obj.parent) == hash){ prices[i].price = e.currentTarget.value; } });\n\n            // prices[i].price = e.currentTarget.value;\n\n            console.log(e.currentTarget.value);\n\n            // console.log(prices);\n\n            document.querySelector('#price').value = JSON.stringify(prices);\n\n            // console.log(e.currentTarget.value);\n        },\n\n        publicPrice: (e) => {\n\n            // let i = e.currentTarget.dataset.i;\n            let hash = (e.currentTarget.parentElement.parentElement.dataset.hash);\n\n            let prices = JSON.parse(document.querySelector('#price').value);\n\n            prices.forEach((obj, i) => { if(escape(obj.id+obj.title+obj.parent) == hash){ prices[i].public = e.currentTarget.checked ? true : false; } });\n\n            // console.log(i);\n\n            // prices[i].public = e.currentTarget.checked ? true : false;\n\n            // prices[i].public = e.currentTarget.value;\n\n            document.querySelector('#price').value = JSON.stringify(prices);\n\n        },\n\n        modalSuccessBtnFunc: null\n    },\n    // get next available label number\n    getNextLabel: (type) => {\n\n        let alphabet_lines = [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"];\n        let alphabet_angles = [\"α\",\"β\",\"γ\",\"δ\",\"ε\",\"ζ\",\"η\",\"θ\",\"ι\",\"κ\",\"λ\"];\n        let alphabet;\n\n        // prevent same label being used twice\n        for(let label of document.querySelectorAll('.input-fields > div .field-label[data-type=\"polyline\"]')){ alphabet_lines = alphabet_lines.filter(function(el) { return el !== label.value }) }\n        for(let label of document.querySelectorAll('.input-fields > div .field-label[data-type=\"arc\"]')){ alphabet_angles = alphabet_angles.filter(function(el) { return el !== label.value }) }\n        \n        return alphabet = type == \"polyline\" ? alphabet_lines : alphabet_angles;\n    },\n    structInputRow: (obj) => {\n\n        // available labels\n        let alphabet = _this.getNextLabel(obj.type);\n\n        // labels select\n        let options = ''; alphabet.forEach((el) => { options += '<option value=\"' + el + '\" '+(obj.label==el ? 'selected':'')+'>' + el + '</option>'; });\n\n        return`\n                <div id=\"field${ obj.id }\" class=\"d-flex flex-row bd-highlight mb-0\" data-type=\"${ obj.type }\" data-points=\"${ obj.points }\" data-params=\"${ escape(JSON.stringify(obj.params ? obj.params : {})) }\">\n                    <div class=\"me-3\" >\n                        <select class=\"form-select form-select-sm field-label\" style=\"width:64px\" data-type=\"${ obj.type }\" aria-label=\"Default select example\">\n                            ${ options }\n                        </select>\n                        <p class=\"form-text\">${ __('label') }</p>\n                    </div>\n                    <div class=\"me-3\" >\n                        <select class=\"form-select form-select-sm field-label-pos\" style=\"width:150px\" data-type=\"${ obj.type }\" aria-label=\"Default select example\">\n                            <option value=\"botom_right\" ${ (obj.label_pos=='botom_right' || !obj.label_pos ? 'selected':'') }>${ __html('Bottom right') }</option>\n                            <option value=\"bottom_left\" ${ (obj.label_pos=='bottom_left' ? 'selected':'') }>${ __html('Bottom left') }</option>\n                            <option value=\"top_right\" ${ (obj.label_pos=='top_right' ? 'selected':'') }>${ __html('Top right') }</option>\n                            <option value=\"top_left\" ${ (obj.label_pos=='top_left' ? 'selected':'') }>${ __html('Top left') }</option>\n                            <option value=\"left\" ${ (obj.label_pos=='left' ? 'selected':'') }>${ __html('Left') }</option>\n                            <option value=\"right\" ${ (obj.label_pos=='right' ? 'selected':'') }>${ __html('Right') }</option>\n                        </select>\n                        <p class=\"form-text\">${ __('label position') }</p>\n                    </div>\n                    <div class=\"me-3\">\n                        <input type=\"text\" class=\"form-control form-control-sm field-default\" placeholder=\"${ __('0') }\" value=\"${ obj.default }\"></input>\n                        <p class=\"form-text\">${ __('default value') }</p>\n                    </div>\n                    <div class=\"me-3\">\n                        <input type=\"text\" class=\"form-control form-control-sm field-min\" placeholder=\"${ __('0') }\" value=\"${ obj.min }\"></input>\n                        <p class=\"form-text\">${ __('min value') }</p>\n                    </div>\n                    <div class=\"me-3\">\n                        <input type=\"text\" class=\"form-control form-control-sm field-max\" placeholder=\"${ __('1000') }\" value=\"${ obj.max }\"></input>\n                        <p class=\"form-text\">${ __('max value') }</p>\n                    </div>\n                    <a href=\"javascript:void(0);\" onclick=\"javascript:;\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"#ff0079\" class=\"remove-input-field bi bi-x-circle mt-1\" data-id=\"${ obj.id }\" viewBox=\"0 0 16 16\">\n                            <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"></path>\n                            <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"></path>\n                        </svg>\n                    </a>\n                </div>\n            `;\n    },\n    loadDrawing: (product) => {\n\n        // console.log(product);\n\n        let d = document;\n        let id = getProductId();\n        let sid = spaceID();\n        let t = '';\n        for(let i=0;i<1;i++){\n     \n          let img = 'https://account.kenzap.com/images/placeholder.jpg';\n          t+=`\n          <div class=\"p-img-cont sketch-cont float-start\" data-mode=\"preview\" style=\"max-width:100%;\">\n            <div data-index=\"sketch${i}\" class=\"pe-3\" style=\"position: relative;\">\n              <img class=\"p-img images-sketch${i}\" data-index=\"sketch${i}\" src=\"${img}\" style=\"max-width:500px;max-height:500px;\"/>\n              <svg id=\"svg\" xmlns=\"http://www.w3.org/2000/svg\" style=\"width: 100%; height: 100%;display: block; position: absolute; top: 0; left: 0; z-index: -2;\">\n                \n              </svg>\n              <span class=\"remove po hd\" title=\"${ __('Remove') }\">×</span>\n              <div class=\"labels\">\n\n              </div>\n            </div>\n            <input type=\"file\" name=\"img[]\" data-type=\"search\" data-index=\"sketch${i}\" class=\"sketchfile aif-sketch${i} d-none\">\n          </div>`;\n        }\n        \n        d.querySelector(\".drawing\").innerHTML = t;\n    \n        // new image listener\n        onClick('.drawing img', _this.listeners.openImage);\n\n        // new remove listener\n        onClick('.drawing .remove', _this.listeners.removeImage);\n\n        // image preview listener\n        onChange('.drawing .sketchfile', _this.listeners.previewImage);\n\n        // sketch mode \n        onClick('[name=\"sketchmode\"]', _this.listeners.sketchMode);\n\n        // view variations\n        onClick(\".btn-view-variations\", _this.listeners.viewVariations);\n\n        // line draw listener start\n        d.querySelector(\"#svg\").addEventListener('mousedown', function (e) {\n\n            e.preventDefault();\n\n            _this.state.sketch.mousedown = true;\n            // console.log(\"andgle\" + _this.state.sketch.requestAngle);\n \n            if(_this.state.sketch.mode == 'drawing' && _this.state.sketch.requestAngle){ _this.state.sketch.arc = new Arc({ params: { x: e.offsetX, y: e.offsetY, radius: 25, startAngle: 60, endAngle: 170 }, mode: 'drawing'}); _this.state.sketch.type = \"arc\"; return; }\n\n            if(_this.state.sketch.mode == 'drawing'){ _this.state.sketch.polyline = new Polyline({ points: [{x: e.offsetX, y: e.offsetY }], mode: 'drawing' }); _this.state.sketch.type = \"polyline\"; }\n            \n            if(_this.state.sketch.mode == 'editing' && _this.state.sketch.type == \"polyline\"){ _this.state.sketch.polyline = new Polyline({ points: [{x: e.offsetX, y: e.offsetY }], mode: 'editing', id: _this.state.sketch.last.id, rect: _this.state.sketch.rect }); _this.state.sketch.type = \"polyline\"; }\n            \n            if(_this.state.sketch.mode == 'editing' && _this.state.sketch.type == \"arc\"){ _this.state.sketch.arc = new Arc({ params: { x: e.offsetX, y: e.offsetY, radius: 25, startAngle: 60, endAngle: 170 }, mode: 'editing', id: _this.state.sketch.last.id, rect: _this.state.sketch.rect }); _this.state.sketch.type = \"arc\"; }\n\n            // console.log(_this.state.sketch.last.id + \"mousedown\" + _this.state.sketch.last.id);\n            // console.log(e);\n        });\n\n        // line draw listener move\n        d.querySelector(\"#svg\").addEventListener('mousemove', function (e) {\n\n            e.preventDefault();\n\n            if(_this.state.sketch.polyline && _this.state.sketch.mode == 'drawing' && _this.state.sketch.type == \"polyline\") _this.state.sketch.polyline.setCoords({ points: [{x: e.offsetX, y: e.offsetY }], mode: 'drawing' });\n\n            if(_this.state.sketch.polyline && _this.state.sketch.mode == 'editing' && _this.state.sketch.type == \"polyline\") _this.state.sketch.polyline.setCoords({ points: [{x: e.offsetX, y: e.offsetY }], mode: 'editing' });\n\n            if(_this.state.sketch.arc && _this.state.sketch.mode == 'editing' && _this.state.sketch.type == \"arc\"){ _this.state.sketch.arc = new Arc({ params: { x: e.offsetX, y: e.offsetY, radius: 25, startAngle: 60, endAngle: 170 }, mode: 'editing', id: _this.state.sketch.last.id, rect: _this.state.sketch.rect }); _this.state.sketch.type = \"arc\"; }\n\n        });\n\n        // line draw listener end\n        d.querySelector(\"#svg\").addEventListener('mouseup', function (e) {\n\n            e.preventDefault();\n\n            _this.state.sketch.mousedown = false;\n\n            if(_this.state.sketch.polyline && _this.state.sketch.mode == 'drawing'){\n\n                _this.state.sketch.polyline.setEndCoords({ points: [{x: e.offsetX, y: e.offsetY }], mode: 'drawing' });\n            }\n\n            if((_this.state.sketch.polyline || _this.state.sketch.arc) && (_this.state.sketch.mode == 'drawing' || _this.state.sketch.mode == 'editing')){\n                _this.refreshFields();\n            }\n            \n            _this.state.sketch.polyline = null;\n            _this.state.sketch.arc = null;\n\n            // circle mouse in out listener\n            if(document.querySelector('#svg rect')) for( let el of document.querySelectorAll('#svg rect') ){\n\n                el.onmouseover = (e) => {\n\n                    if(_this.state.sketch.mousedown) return;\n\n                    _this.state.sketch.rect = e.currentTarget.dataset.rect;\n                    _this.state.sketch.last.id = e.currentTarget.dataset.id.replace('start','').replace('end','');\n                    _this.state.sketch.type = e.currentTarget.dataset.type;\n                };\n\n                el.onmouseleave = (e) => {\n\n                    if(_this.state.sketch.mousedown) return;\n\n                    _this.state.sketch.rect = null;\n                };\n            }\n\n            // line mouse in out listener\n            if(document.querySelector('#svg polyline')) for( let el of document.querySelectorAll('#svg polyline') ){\n\n                el.onmouseover = (e) => {\n\n                    if(_this.state.sketch.mousedown) return;\n\n                    _this.state.sketch.last.id = e.currentTarget.dataset.id;\n                };\n            }\n\n            // path arc mouse in out listener\n            if(document.querySelector('#svg path')) for( let el of document.querySelectorAll('#svg path') ){\n\n                el.onmouseover = (e) => {\n\n                    if(_this.state.sketch.mousedown) return;\n\n                    // console.log(\"over \" + e.currentTarget.dataset.id);\n                    _this.state.sketch.last.id = e.currentTarget.dataset.id;\n                };\n            }\n        });\n\n        document.querySelector('#svg').onmouseover = (e) => {\n\n            _this.state.sketch.hover = true;\n        };\n\n        document.querySelector('#svg').onmouseleave = (e) => {\n\n            _this.state.sketch.hover = false;\n        };\n\n        // remove listener\n        let keypress = (e) => {\n\n            // console.log('key' + e.which);\n\n            // request angle drawing\n            if(e.which == 65 && _this.state.sketch.mode == 'drawing'){  _this.state.sketch.requestAngle = true; console.log('REQUESTING'); setTimeout(() => { _this.state.sketch.requestAngle = false }, 2000); }\n            \n            // cancel drawing on del or ESC buttons\n            if((e.which == 8 || e.which == 27) && _this.state.sketch.mode == 'drawing' && _this.state.sketch.polyline){ console.log('removing'); document.querySelector('#svg g[data-id=\"' + _this.state.sketch.polyline.getID() + '\"]').remove(); }\n            \n            if(e.which != 8 || _this.state.sketch.mode != 'editing' || !_this.state.sketch.hover) return;\n\n            // delete lines\n            if(document.querySelector('#svg g[data-id=\"' + _this.state.sketch.last.id + '\"]')) document.querySelector('#svg g[data-id=\"' + _this.state.sketch.last.id + '\"]').remove();\n            if(document.querySelector('.input-fields #field' + _this.state.sketch.last.id)) document.querySelector('.input-fields #field' + _this.state.sketch.last.id).remove();\n            if(document.querySelector('.svg-input[data-id=\"' + _this.state.sketch.last.id + '\"]')) document.querySelector('.svg-input[data-id=\"' + _this.state.sketch.last.id + '\"]').remove();\n        }\n        document.removeEventListener('keydown', keypress, true);\n        document.addEventListener('keydown', keypress, true);\n        \n        // iterate all images\n        for(let fi=0; fi<1; fi++){\n    \n            // async load image to verify if it exists on CDN \n            let image_url = CDN+'/S'+sid+'/sketch-'+id+'-'+(parseInt(fi)+1)+'-500x500.jpeg?'+product.updated;\n            setTimeout(function(img, sel, _fi){\n        \n                let allow = true;\n                if(typeof(product.img)!==\"undefined\"){ if(!product.img[_fi]) allow = false; }\n                if(allow){\n\n                    let i = new Image();\n                    i.onload = function(){\n                        \n                        d.querySelector(sel+_fi).setAttribute('src', img);\n                        d.querySelector(sel+_fi).parentElement.querySelector('.remove').classList.remove('hd');\n                    };\n                    i.src=img;\n                }\n            }, 300, image_url, \".images-sketch\", fi );\n        }\n    },\n    // sync html lines with HTML fields\n    refreshFields: () => {\n\n        // console.log('refreshFields');\n\n        let htmlLabels = \"\";\n\n        let refreshAgain = false;\n\n        // get all lines\n        if(document.querySelector('#svg g')) for(let el of document.querySelectorAll('#svg g')){\n\n            let id = el.dataset.id, obj = {}, x, y;\n            let label = document.querySelector('#field'+id+' .field-label') ? document.querySelector('#field'+id+' .field-label').value : _this.getNextLabel(el.dataset.type)[0];\n\n            // if(label == '...') refreshAgain = true;\n\n            switch(el.dataset.type){\n\n                case 'polyline':\n                    obj = { id:id, label:label, default:0, min:0, max:0, type:el.dataset.type, params:{}, points:el.querySelector('polyline').getAttribute('points') };\n         \n                    let points = obj.points.split(' ');\n                    x = (parseFloat(points[0]) + parseFloat(points[2])) / 2;\n                    y = (parseFloat(points[1]) + parseFloat(points[3])) / 2;\n                    \n                    htmlLabels += `\n                    <div class=\"svg-input m-2 lable-line\" style=\"left:${ x }px;top:${ y }px;\" data-id=\"${ obj.id }\">\n                        <label for=\"input${ obj.label }\">${ obj.label }</label>\n                    </div>\n                    `;\n                    \n                    break;\n                case 'arc':\n                    obj = { id:id, label:label, default:0, min:0, max:0, type:el.dataset.type, params:JSON.parse(unescape(el.dataset.params)), points:el.querySelector('path').getAttribute('d') };\n\n                    let newDeg = obj.params.startAngle + ((obj.params.endAngle - obj.params.startAngle) / 2); // newDeg = newDeg < 0 ? newDeg * (-1) : 360-newDeg; \n\n                    // console.log(obj.params.startAngle + \" \" + obj.params.endAngle);\n                    // console.log(newDeg);\n\n                    x = obj.params.x + obj.params.radius / 2 + (((obj.params.radius*2) * Math.cos(degToRad(newDeg)))) + 5;\n                    y = obj.params.y + obj.params.radius / 2 + (((obj.params.radius*2) * Math.sin(degToRad(newDeg)))) - 5;\n\n                    // x = obj.params.x + 40;\n                    // y = obj.params.y + 40;\n\n                    htmlLabels += `\n                    <div class=\"svg-input m-2 lable-angle\" style=\"left:${ x }px;top:${ y }px;\" data-id=\"${ obj.id }\">\n                        <label for=\"input${ obj.label }\">${ obj.label }°</label>\n                    </div>\n                    `;\n\n                    break;\n            }\n\n            // struct field\n            let html = _this.structInputRow(obj);\n\n            if(!document.querySelector('#field'+id)){ \n                \n                // new field block\n                document.querySelector('.input-fields').insertAdjacentHTML('beforeend', html); \n            }else{\n\n                // update existing fields with new points only\n                document.querySelector('#field'+id).setAttribute('data-points', obj.points);\n                document.querySelector('#field'+id).setAttribute('data-params', escape(JSON.stringify(obj.params)));\n            }\n\n            _this.listeners.inputFieldListeners();\n        }\n\n        document.querySelector('.labels').innerHTML = htmlLabels;\n\n        onChange('.field-label', _this.listeners.inputFieldChange);\n    },\n    structCoatingRow: (obj, i) => {\n\n        return `\n        <tr class=\"new-item-row ${ obj.parent ? \"pr-parent\" : \"\" }\" data-parent=\"${ obj.parent ? obj.parent : \"\" }\" data-title=\"${ obj.title }\" data-hash=\"${ escape(obj.id+obj.title+obj.parent) }\">\n            <td style=\"max-width:25px;\">\n                <input class=\"form-check-input price-public\" type=\"checkbox\" value=\"\" data-i=\"${i}\" ${ obj.public ? 'checked' : \"\" } >\n            </td>\n            <td class=\"tp\">\n                <div class=\"me-1 me-sm-3 my-1 \">\n                    ${ obj.id }\n                </div>\n            </td>\n            <td>\n                <div class=\"me-1 me-sm-3 my-1\">\n                    ${ obj.parent ? obj.parent : \"\" }\n                </div>\n            </td>\n            <td>\n                <div class=\"me-1 me-sm-3 my-1\">\n                    ${ obj.title }\n                </div>\n            </td>\n            <td class=\"price\">\n                <div class=\"me-1 me-sm-3 my-1\" >\n                    <input type=\"text\" autocomplete=\"off\" class=\"form-control form-control-sm text-right price-price\" style=\"max-width:80px;\" data-i=\"${ i }\" value=\"${ obj.price }\">\n                    <span class=\"d-none\"> ${ priceFormat(_this, obj.price) } </span>\n                </div>\n            </td>\n            <td class=\"price\">\n                <div class=\"me-1 me-sm-3 my-1\">\n                    ${ obj.unit }\n                </div>\n            </td>\n            <td class=\"align-middle text-center pt-2\"> \n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"#ff0079\" class=\"remove-price bi bi-x-circle po\" data-i=\"${ i }\" viewBox=\"0 0 16 16\">\n                    <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"></path>\n                    <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"></path>\n                </svg>\n            </td>\n        </tr>`;\n\n    },\n    // general method for image upload\n    uploadImages: () => {\n\n        if( document.querySelector(\".imgupnote\") ) document.querySelector(\".imgupnote\").remove();\n\n        let fi = 0;\n        for( let fileEl of document.querySelectorAll(\".sketchfile\") ){\n\n            fi += 1;\n\n            let id = getProductId();\n            let sid = spaceID();\n\n            // console.log(file);\n            let file = fileEl.files[0];\n            if(typeof(file) === \"undefined\") continue;\n\n            // TODO add global sizes setting \n            let fd = new FormData();\n            // let sizes = document.querySelector(\"body\").dataset.sizes;\n            let sizes = '1000|500x500|250x250|100x100';\n\n            fd.append('id', id);\n            fd.append('sid', sid);\n            fd.append('pid', id);\n            fd.append('key', 'image');\n            fd.append('sizes', sizes);\n            fd.append('file', file);\n            fd.append('slug', 'sketch-'+id+'-'+fi);\n            fd.append('token', getCookie('kenzap_token'));\n\n            // clear input file so that its not updated again\n            file.value = '';\n\n            _this.state.ajaxQueue+=1;\n\n            fetch(\"https://api-v1.kenzap.cloud/upload/\",{\n                body: fd,\n                method: \"post\"\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                _this.state.ajaxQueue -= 1;\n                if(response.success && _this.state.ajaxQueue == 0){\n\n                    toast( __(\"Sketch updated\") );\n\n                    // hide UI loader\n                    hideLoader();\n                }\n            });\n        }\n        \n        // image upload notice\n        if(_this.state.ajaxQueue == 0){\n\n            toast( __(\"Product updated\") );\n\n            hideLoader();\n        }\n    },\n}\n\n_this.init();"],"names":["getProductId","urlParams","URLSearchParams","window","location","search","id","get","priceFormat","_this","price","makeNumber","Math","round","parseFloat","toFixed","state","settings","currency_symb_loc","currency_symb","onlyNumbers","sel","chars","document","querySelector","querySelectorAll","el","addEventListener","e","includes","which","isNaN","String","fromCharCode","value","preventDefault","escape","htmlStr","replace","unescape","degToRad","deg","PI","HTMLContent","__html","Polyline","data","points","mode","polyLine","polyPoints","style","stroke_width","stroke","fill","insertAdjacentHTML","drawCircle","poly_points","getAttribute","poly_points_arr","split","length","splice","setAttribute","join","trim","rect","x","y","setCoords","remove","type","reduce","previousValue","currentItem","coords","len","text","possible","i","charAt","floor","random","genID","selected","draw","Arc","arc","JSON","stringify","params","parse","dataset","a","b","newDeg","atan2","startAngle","endAngle","describeArc","radius","cos","sin","angleInRadians","centerX","centerY","angleInDegrees","endAngleOriginal","start","polarToCartesian","end","arcSweep","d","CDN","init","getData","ajaxQueue","sk_settings","firstLoad","product","input_fields","sketch","mousedown","last","angle","spaceID","fetch","method","headers","body","query","user","fields","token","getCookie","key","locale","source","then","response","json","hideLoader","success","parseApiError","loadDrawing","renderPage","initListeners","error","simulateClick","forEach","obj","html","structInputRow","points_arr","polyline","setEndCoords","refreshFields","listeners","inputFieldListeners","calc_price","formula","formula_price","formula_width","formula_length","var_price","checked","modelling","tax_id","priceContVisibility","currentTarget","labels","replaceAll","div","result","innerHTML","eval","setCustomValidity","__","parentElement","classList","add","console","log","parts","Array","isArray","part","onClick","saveProduct","modalSuccessBtn","onChange","priceChange","viewVariations","modal","modalCont","bootstrap","Modal","modalHTml","var_parent","parent_options","parent","structCoatingRow","removePrice","onKeyUp","updatePrice","publicPrice","addPrice","show","editBlock","amb","action","index","setTimeout","removeInputFields","removeBlock","c","confirm","parentNode","inputFieldChange","push","sid","uploadImages","openImage","previewImage","input","files","toast","size","reader","FileReader","onload","readAsDataURL","removeImage","sketchMode","zIndex","modalSuccessBtnFunc","stockManagement","title","unit","prices","hash","filter","getNextLabel","alphabet_lines","alphabet_angles","label","alphabet","options","label_pos","min","max","t","img","requestAngle","offsetX","offsetY","onmouseover","onmouseleave","hover","keypress","getID","removeEventListener","fi","image_url","parseInt","updated","_fi","allow","Image","src","htmlLabels","fileEl","file","fd","FormData","sizes","append"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;EACA;EACA;AAuCA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,EAAE,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,KAAK;AAClC;EACA,IAAI,IAAI,KAAK,GAAG,CAAC,KAAK,EAAE,EAAE,KAAK;AAC/B;EACA,QAAQ,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3E;EACA,QAAQ,OAAO,KAAK,CAAC;EACrB,MAAK;AACL;EACA,IAAI,GAAG,OAAO,MAAM,CAAC,IAAI,KAAK,WAAW,EAAE,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EACjE,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AAClF;AACA;AACA;EACA,IAAI,OAAO,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;EAC3D,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,MAAM,KAAK,GAAG,CAAC,IAAI,EAAE,EAAE,EAAE,GAAG,CAAC,KAAK;AAClC;EACA,IAAI,IAAI,KAAK,GAAG,CAAC,KAAK,EAAE,EAAE,KAAK;AAC/B;EACA,QAAQ,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3E;EACA,QAAQ,OAAO,KAAK,CAAC;EACrB,MAAK;AACL;EACA,IAAI,GAAG,OAAO,MAAM,CAAC,IAAI,KAAK,WAAW,EAAE,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EACjE,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AAClF;EACA,IAAI,OAAO,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAC/D,EAAC;AAkID;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,MAAM,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,KAAK;AACtC;EACA,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;AACxB;EACA,IAAI,GAAG,IAAI,CAAC,MAAM,KAAK,CAAC,CAAC;EACzB,EAAE,OAAO,EAAE,CAAC;EACZ,EAAE;AACF;EACA,IAAI,IAAI,EAAE,GAAG,CAAC,IAAI,KAAK;AACvB;EACA,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG;EAC3C,YAAY;EACZ,gBAAgB,GAAG,EAAE,OAAO;EAC5B,gBAAgB,GAAG,EAAE,MAAM;EAC3B,gBAAgB,GAAG,EAAE,MAAM;EAC3B,gBAAgB,GAAG,EAAE,QAAQ;EAC7B,gBAAgB,GAAG,EAAE,QAAQ;EAC7B,aAAa,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;EACtB,MAAK;AACL;EACA,IAAI,OAAO,KAAK,CAAC,IAAI,EAAE,EAAE,EAAE,GAAG,CAAC,CAAC,CAAC;EACjC,EAAC;AAWD;EACA;EACA;EACA;EACA;EACO,MAAM,UAAU,GAAG,MAAM;AAChC;EACA,IAAI,IAAI,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;EAC/C,IAAI,IAAI,EAAE,EAAE,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;EACtC,EAAC;AA+CD;EACA;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,OAAO,GAAG,MAAM;EAC9B;EACA,IAAI,IAAI,SAAS,GAAG,IAAI,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;EAChE,IAAI,IAAI,EAAE,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;AAC9D;EACA,IAAI,OAAO,EAAE,CAAC;EACd,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,SAAS,GAAG,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,KAAK;AACjD;EACA,IAAI,IAAI,OAAO,GAAG,EAAE,CAAC;EACrB,IAAI,IAAI,IAAI,EAAE;EACd,QAAQ,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;EAC9B,QAAQ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC;EACpE,QAAQ,OAAO,GAAG,WAAW,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;EACnD,KAAK;EACL,IAAI,QAAQ,CAAC,MAAM,GAAG,IAAI,GAAG,GAAG,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,GAAG,OAAO,GAAG,8BAA8B,CAAC;EACpG,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,SAAS,GAAG,CAAC,KAAK,KAAK;AACpC;EACA,IAAI,IAAI,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC;EAC3B,IAAI,IAAI,aAAa,GAAG,kBAAkB,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;EAC5D,IAAI,IAAI,EAAE,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EACtC,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACxC,QAAQ,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;EACtB,QAAQ,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE;EACnC,YAAY,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;EAC/B,SAAS;EACT,QAAQ,IAAI,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;EAClC,YAAY,OAAO,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;EACtD,SAAS;EACT,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,WAAW,GAAG,MAAM;AAClC;EACA,IAAI,IAAI,OAAO,GAAG,CAAC,YAAY,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,YAAY,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,YAAY,CAAC,OAAO,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;EACxJ,IAAI,IAAI,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,GAAG,GAAG,GAAG,OAAO,EAAE,GAAG,GAAG,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAC;EACvF,IAAI,GAAG,KAAK,IAAI,SAAS,CAAC,OAAO,CAAC,CAAC,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE;EAC3E;EACA,IAAI,SAAS,CAAC,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;AACjC;EACA,IAAI,OAAO,OAAO;EAClB,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,OAAO,GAAG;EACxB,IAAI,QAAQ,EAAE,kBAAkB;EAChC,IAAI,cAAc,EAAE,kBAAkB;EACtC,IAAI,eAAe,EAAE,SAAS,GAAG,SAAS,CAAC,gBAAgB,CAAC;EAC5D,IAAI,eAAe,EAAE,SAAS,CAAC,QAAQ,CAAC,GAAG,SAAS,CAAC,QAAQ,CAAC,GAAG,IAAI;EACrE,IAAI,eAAe,EAAE,WAAW,EAAE;EAClC,IAAI,cAAc,EAAE,SAAS,CAAC,cAAc,CAAC;EAC7C,IAAI,YAAY,EAAE,OAAO,EAAE;EAC3B,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,aAAa,GAAG,CAAC,IAAI,KAAK;AACxC;EACA;EACA,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACtB;EACA;EACA,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACxB;EACA;EACA,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC;EACvB,QAAQ,GAAG,EAAE,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,GAAG;AACpD;EACA,QAAQ,IAAI,MAAM,GAAG,IAAI,eAAe,EAAE,CAAC;EAC3C,QAAQ,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EACvC,QAAQ,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;EACxC,QAAQ,MAAM,CAAC,MAAM,CAAC,OAAO,EAAE,SAAS,CAAC,cAAc,CAAC,CAAC,CAAC;EAC1D,QAAQ,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;EACnC;EACA;EACA,QAAQ,KAAK,CAAC,oCAAoC,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,QAAQ,EAAE,kBAAkB,EAAE,cAAc,EAAE,mCAAmC,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;AACvL;EACA,QAAQ,KAAK,CAAC,iCAAiC,CAAC,CAAC;EACjD,QAAQ,OAAO;EACf,KAAK;EACL;EACA;EACA,IAAI,OAAO,IAAI,CAAC,IAAI;AACpB;EACA;EACA,QAAQ,KAAK,GAAG;AAChB;EACA;EACA,YAAY,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;AAC7D;EACA,gBAAgB,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EACnC,gBAAgB,OAAO;EACvB,aAAa;AACb;EACA;EACA,YAAY,QAAQ,CAAC,IAAI,CAAC,uDAAuD,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM;EAC9G;EACA;EACA,QAAQ;AACR;EACA,YAAY,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EAC/B,YAAY,MAAM;EAClB,KAAK;EACL,EAAC;AAwBD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,OAAO,GAAG,CAAC,GAAG,EAAE,EAAE,KAAK;AACpC;EACA,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,QAAQ,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;AAClF;EACA,QAAQ,CAAC,CAAC,mBAAmB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EACjD,QAAQ,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAC9C,KAAK;EACL,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,OAAO,GAAG,CAAC,GAAG,EAAE,EAAE,KAAK;AACpC;EACA,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,QAAQ,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;AAClF;EACA,QAAQ,CAAC,CAAC,mBAAmB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EACjD,QAAQ,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAC9C,KAAK;EACL,EAAC;AACD;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAM,QAAQ,GAAG,CAAC,GAAG,EAAE,EAAE,KAAK;AACrC;EACA,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,QAAQ,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;AAClF;EACA,QAAQ,CAAC,CAAC,mBAAmB,CAAC,QAAQ,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAClD,QAAQ,CAAC,CAAC,gBAAgB,CAAC,QAAQ,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;EAC/C,KAAK;EACL,EAAC;AAiBD;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,aAAa,GAAG,CAAC,IAAI,KAAK;AACxC;EACA;EACA,CAAC,IAAI,GAAG,GAAG,IAAI,UAAU,CAAC,OAAO,EAAE;EACnC,EAAE,OAAO,EAAE,IAAI;EACf,EAAE,UAAU,EAAE,IAAI;EAClB,EAAE,IAAI,EAAE,MAAM;EACd,EAAE,CAAC,CAAC;AACJ;EACA;EACA,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EAC1B,CAAC,CAAC;AAqIF;EACA;EACA;EACA;EACA;EACA;EACA,CAAQ,MAAM,KAAK,GAAG,CAAC,IAAI,KAAK;AAChC;EACA;EACA,IAAI,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AACzC;EACA,QAAQ,IAAI,IAAI,GAAG,CAAC;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,CAAC,CAAC;EAChB,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,kBAAkB,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;EAC3H,KAAK;AACL;EACA,IAAI,IAAI,KAAK,GAAG,IAAI,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC;EACtE,IAAI,QAAQ,CAAC,aAAa,CAAC,oBAAoB,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC;EAClE,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;EACjB;;EC1pBO,IAAMA,YAAY,GAAG,SAAfA,YAAe,GAAM;IAE9B,IAAIC,SAAS,GAAG,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAhB,CAAA;EACA,EAAA,IAAIC,EAAE,GAAGL,SAAS,CAACM,GAAV,CAAc,IAAd,CAAsBN,GAAAA,SAAS,CAACM,GAAV,CAAc,IAAd,CAAtB,GAA4C,EAArD,CAAA;EACA,EAAA,OAAOD,EAAP,CAAA;EACH,CALM,CAAA;EA2HC,IAAME,WAAW,GAAG,SAAdA,WAAc,CAASC,KAAT,EAAgBC,KAAhB,EAAuB;EAE/CA,EAAAA,KAAK,GAAGC,UAAU,CAACD,KAAD,CAAlB,CAAA;EAEAA,EAAAA,KAAK,GAAG,CAACE,IAAI,CAACC,KAAL,CAAWC,UAAU,CAACJ,KAAD,CAAV,GAAoB,GAA/B,CAAoC,GAAA,GAArC,EAA0CK,OAA1C,CAAkD,CAAlD,CAAR,CAAA;;EAEA,EAAA,QAAON,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBC,iBAA5B;EACI,IAAA,KAAK,MAAL;QAAaR,KAAK,GAAGD,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBE,aAArB,GAAqCT,KAA7C,CAAA;EAAoD,MAAA,MAAA;;EACjE,IAAA,KAAK,OAAL;QAAcA,KAAK,GAAGA,KAAK,GAAGD,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBE,aAArC,CAAA;EAAoD,MAAA,MAAA;;EAClE,IAAA,KAAK,YAAL;QAAmBT,KAAK,GAAGD,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBE,aAArB,GAAqC,GAArC,GAA2CT,KAAnD,CAAA;EAA0D,MAAA,MAAA;;EAC7E,IAAA,KAAK,aAAL;QAAoBA,KAAK,GAAGA,KAAK,GAAG,GAAR,GAAcD,KAAK,CAACO,KAAN,CAAYC,QAAZ,CAAqBE,aAA3C,CAAA;EAA0D,MAAA,MAAA;EAJlF,GAAA;;EAOA,EAAA,OAAOT,KAAP,CAAA;EACH,CAdO,CAAA;EAgBD,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAASD,KAAT,EAAgB;EAEtCA,EAAAA,KAAK,GAAGA,KAAK,GAAGA,KAAH,GAAW,CAAxB,CAAA;EACAA,EAAAA,KAAK,GAAGI,UAAU,CAACJ,KAAD,CAAlB,CAAA;IACAA,KAAK,GAAGE,IAAI,CAACC,KAAL,CAAWH,KAAK,GAAG,GAAnB,CAAA,GAA0B,GAAlC,CAAA;EACA,EAAA,OAAOA,KAAP,CAAA;EACH,CANM,CAAA;EA0BA,IAAMU,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,KAAN,EAAgB;EAEvC,EAAA,IAAG,CAACC,QAAQ,CAACC,aAAT,CAAuBH,GAAvB,CAAJ,EAAiC,OAAA;;EAFM,EAAA,IAAA,UAAA,GAAA,0BAAA,CAIzBE,QAAQ,CAACE,gBAAT,CAA0BJ,GAA1B,CAJyB,CAAA;EAAA,MAAA,MAAA,CAAA;;EAAA,EAAA,IAAA;MAIvC,KAA6C,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,MAAA,IAArCK,EAAqC,GAAA,MAAA,CAAA,KAAA,CAAA;EAEzCA,MAAAA,EAAE,CAACC,gBAAH,CAAoB,UAApB,EAAgC,UAACC,CAAD,EAAO;UAInC,IAAI,CAACN,KAAK,CAACO,QAAN,CAAeD,CAAC,CAACE,KAAjB,CAAD,IAA4BC,KAAK,CAACC,MAAM,CAACC,YAAP,CAAoBL,CAAC,CAACE,KAAtB,CAAD,CAAlC,IAAqEF,CAAC,CAACE,KAAF,IAAW,EAAhF,IAAuFP,QAAQ,CAACC,aAAT,CAAuBH,GAAvB,CAAA,CAA4Ba,KAA5B,CAAkCL,QAAlC,CAA2CG,MAAM,CAACC,YAAP,CAAoBL,CAAC,CAACE,KAAtB,CAA3C,CAAA,IAA4ER,KAAK,CAACO,QAAN,CAAeD,CAAC,CAACE,KAAjB,CAAtK,EAA+L;EAG3LF,UAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EACA,UAAA,OAAO,KAAP,CAAA;EACH,SAAA;SATL,CAAA,CAAA;EAWH,KAAA;EAjBsC,GAAA,CAAA,OAAA,GAAA,EAAA;EAAA,IAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,GAAA,SAAA;EAAA,IAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,GAAA;EAkB1C,CAlBM,CAAA;EAwIA,IAAMC,QAAM,GAAG,SAATA,MAAS,CAACC,OAAD,EAAa;EAE/B,EAAA,OAAOA,OAAO,CAACC,OAAR,CAAgB,IAAhB,EAAsB,OAAtB,CAAA,CACAA,OADA,CACQ,IADR,EACc,MADd,CAEAA,CAAAA,OAFA,CAEQ,IAFR,EAEc,MAFd,CAGAA,CAAAA,OAHA,CAGQ,IAHR,EAGc,QAHd,CAAA,CAIAA,OAJA,CAIQ,IAJR,EAIc,OAJd,CAAP,CAAA;EAMH,CARM,CAAA;EAUA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACF,OAAD,EAAa;IAEjCA,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,OAAhB,EAA0B,GAA1B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,OAAhB,EAA0B,GAA1B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,SAAhB,EAA4B,IAA5B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,QAAhB,EAA2B,IAA3B,CAAV,CAAA;IACAD,OAAO,GAAGA,OAAO,CAACC,OAAR,CAAgB,QAAhB,EAA2B,GAA3B,CAAV,CAAA;EACA,EAAA,OAAOD,OAAP,CAAA;EACH,CARM,CAAA;EAuVA,IAAMG,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD,EAAS;IAE7B,OAAO,CAACA,GAAG,GAAG,EAAP,IAAa7B,IAAI,CAAC8B,EAAlB,GAAuB,KAA9B,CAAA;EACH,CAHM;;EC5rBA,IAAMC,WAAW,GAAG,SAAdA,WAAc,GAAM;EAEjC,EAAA,OAAA,yvBAAA,CAAA,MAAA,CAc6EC,MAAM,CAAC,QAAD,CAdnF,EAAA,6OAAA,CAAA,CAAA,MAAA,CAmB0GA,MAAM,CAAC,SAAD,CAnBhH,EAAA,+YAAA,CAAA,CAAA,MAAA,CAsBoGA,MAAM,CAAC,QAAD,CAtB1G,EAAA,mQAAA,CAAA,CAAA,MAAA,CAyBoGA,MAAM,CAAC,SAAD,CAzB1G,EAAA,mQAAA,CAAA,CAAA,MAAA,CA4BoGA,MAAM,CAAC,SAAD,CA5B1G,EAAA,icAAA,CAAA,CAAA,MAAA,CAmCiGA,MAAM,CAAC,cAAD,CAnCvG,EAAA,4YAAA,CAAA,CAAA,MAAA,CA2CsFA,MAAM,CAAC,iBAAD,CA3C5F,EAAA,iLAAA,CAAA,CAAA,MAAA,CA6CuEA,MAAM,CAAC,eAAD,CA7C7E,EAAA,oFAAA,CAAA,CAAA,MAAA,CA8CwEA,MAAM,CAAC,UAAD,CA9C9E,EAAA,kFAAA,CAAA,CAAA,MAAA,CA+CsEA,MAAM,CAAC,WAAD,CA/C5E,EAAA,mFAAA,CAAA,CAAA,MAAA,CAgDuEA,MAAM,CAAC,YAAD,CAhD7E,EAAA,mFAAA,CAAA,CAAA,MAAA,CAiDuEA,MAAM,CAAC,iBAAD,CAjD7E,EAAA,meAAA,CAAA,CAAA,MAAA,CAwDiIA,MAAM,CAAC,iBAAD,CAxDvI,EAAA,4EAAA,CAAA,CAAA,MAAA,CAyDgEA,MAAM,CAAC,0DAAD,CAzDtE,EAAA,2NAAA,CAAA,CAAA,MAAA,CA6DmFA,MAAM,CAAC,iBAAD,CA7DzF,EA8DiHA,iIAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,aAAD,CA9DvH,EA+D6EA,mFAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,oCAAD,CA/DnF,EAqE2FA,2VAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,eAAD,CArEjG,EAsE+HA,+IAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,WAAD,CAtErI,EAuE2FA,iGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,sBAAD,CAvEjG,EA0E2FA,8NAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,gBAAD,CA1EjG,EA2EgIA,gJAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,GAAD,CA3EtI,EA4E4FA,kGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,uBAAD,CA5ElG,EAkFyFA,2UAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,eAAD,CAlF/F,EAmFuHA,uIAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,kBAAD,CAnF7H,EAoFmFA,yFAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,gDAAD,CApFzF,EAwFoFA,0NAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,OAAD,CAxF1F,EA0FmFA,+RAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,kCAAD,CA1FzF,EAgG+CA,ibAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,cAAD,CAhGrD,EAkGgEA,qHAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,wDAAD,CAlGtE,EAsGkFA,uMAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,QAAD,CAtGxF,oPAwGgEA,MAAM,CAAC,2BAAD,CAxGtE,EAAA,4wBAAA,CAAA,CAAA;EAmIC,CArIM;;ECDP,IAAaC,QAAb,GAAA,YAAA,CAEI,SAAYC,QAAAA,CAAAA,KAAZ,EAAkB;EAAA,EAAA,IAAA,KAAA,GAAA,IAAA,CAAA;;EAAA,EAAA,eAAA,CAAA,IAAA,EAAA,QAAA,CAAA,CAAA;;IAAA,eAuCX,CAAA,IAAA,EAAA,MAAA,EAAA,UAACC,MAAD,EAAY;EAEf,IAAA,IAAG,KAAI,CAACC,IAAL,IAAa,SAAhB,EAA2B,OAAA;EAE3B,IAAA,IAAIC,QAAQ,GAAA,eAAA,CAAA,MAAA,CAAmB,KAAI,CAAC3C,EAAxB,EAAyE,gDAAA,CAAA,CAAA,MAAA,CAAA,KAAI,CAACA,EAA9E,yBAA+F,KAAI,CAAC4C,UAAL,CAAgBH,MAAhB,CAA/F,EAAA,0BAAA,CAAA,CAAA,MAAA,CAAiJ,KAAI,CAACI,KAAL,CAAWC,YAA5J,EAAA,UAAA,CAAA,CAAA,MAAA,CAAqL,KAAI,CAACD,KAAL,CAAWE,MAAhM,mBAAiN,KAAI,CAACF,KAAL,CAAWG,IAA5N,EAAZ,qBAAA,CAAA,CAAA;MACA/B,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+B+B,kBAA/B,CAAkD,WAAlD,EAA+DN,QAA/D,CAAA,CAAA;;EAEA,IAAA,KAAI,CAACO,UAAL,CAAgB,OAAhB,EAAyBT,MAAzB,CAAA,CAAA;;EAwBA,IAAA,OAAO,KAAP,CAAA;KAtEc,CAAA,CAAA;;IAAA,eA8EN,CAAA,IAAA,EAAA,WAAA,EAAA,UAACD,IAAD,EAAU;EAElB,IAAA,IAAG,CAACvB,QAAQ,CAACC,aAAT,CAAuB,yBAAA,GAA0B,KAAI,CAAClB,EAA/B,GAAmC,IAA1D,CAAJ,EAAqE,OAAA;EAErE,IAAA,IAAImD,WAAW,GAAGlC,QAAQ,CAACC,aAAT,CAAuB,yBAA0B,GAAA,KAAI,CAAClB,EAA/B,GAAmC,IAA1D,CAAA,CAAgEoD,YAAhE,CAA6E,QAA7E,CAAlB,CAAA;EAEA,IAAA,IAAIC,eAAe,GAAGF,WAAW,CAACG,KAAZ,CAAkB,GAAlB,CAAtB,CAAA;;EAEA,IAAA,IAAGd,IAAI,CAACE,IAAL,IAAa,SAAhB,EAA2B;EAEvB,MAAA,IAAGW,eAAe,CAACE,MAAhB,GAAuB,CAA1B,EAA4B;UAAEF,eAAe,GAAGA,eAAe,CAACG,MAAhB,CAAuB,CAAvB,EAA0B,CAA1B,CAAlB,CAAA;EAAiD,OAAA;;QAE/E,IAAGvC,QAAQ,CAACC,aAAT,CAAuB,4BAA0B,KAAI,CAAClB,EAA/B,GAAmC,IAA1D,CAAH,EAAoEiB,QAAQ,CAACC,aAAT,CAAuB,4BAA0B,KAAI,CAAClB,EAA/B,GAAmC,IAA1D,CAAA,CAAgEyD,YAAhE,CAA6E,QAA7E,EAAuF,CAACJ,eAAe,CAACK,IAAhB,CAAqB,GAArB,CAA4B,GAAA,GAA5B,GAAkC,KAAI,CAACd,UAAL,CAAgBJ,IAAI,CAACC,MAArB,CAAnC,EAAiEkB,IAAjE,EAAvF,CAAA,CAAA;EACvE,KAAA;;EAED,IAAA,IAAGnB,IAAI,CAACE,IAAL,IAAa,SAAhB,EAA2B;QAEvB,QAAO,KAAI,CAACkB,IAAZ;EAEI,QAAA,KAAK,OAAL;YACIP,eAAe,CAAC,CAAD,CAAf,GAAqBb,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAA,CAAeoB,CAApC,CAAA;YACAR,eAAe,CAAC,CAAD,CAAf,GAAqBb,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAA,CAAeqB,CAApC,CAAA;EACJ,UAAA,MAAA;;EACA,QAAA,KAAK,KAAL;YACIT,eAAe,CAAC,CAAD,CAAf,GAAqBb,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAA,CAAeoB,CAApC,CAAA;YACAR,eAAe,CAAC,CAAD,CAAf,GAAqBb,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAA,CAAeqB,CAApC,CAAA;EACJ,UAAA,MAAA;EATJ,OAAA;;EAYA,MAAA,IAAG7C,QAAQ,CAACC,aAAT,CAAuB,4BAA4B,KAAI,CAAClB,EAAjC,GAAsC,IAA7D,CAAH,EAAuEiB,QAAQ,CAACC,aAAT,CAAuB,yBAA4B,GAAA,KAAI,CAAClB,EAAjC,GAAsC,IAA7D,EAAmEyD,YAAnE,CAAgF,QAAhF,EAA0FJ,eAAe,CAACK,IAAhB,CAAqB,GAArB,CAA1F,CAAA,CAAA;;EACvE,MAAA,IAAGzC,QAAQ,CAACC,aAAT,CAAuB,wBAAwB,KAAI,CAAC0C,IAA7B,GAAoC,KAAI,CAAC5D,EAAzC,GAA8C,IAArE,CAAH,EAA8E;UAE1EiB,QAAQ,CAACC,aAAT,CAAuB,qBAAwB,GAAA,KAAI,CAAC0C,IAA7B,GAAoC,KAAI,CAAC5D,EAAzC,GAA8C,IAArE,EAA2EyD,YAA3E,CAAwF,GAAxF,EAA6FjB,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAA,CAAeoB,CAAf,GAAmB,CAAhH,CAAA,CAAA;UACA5C,QAAQ,CAACC,aAAT,CAAuB,qBAAwB,GAAA,KAAI,CAAC0C,IAA7B,GAAoC,KAAI,CAAC5D,EAAzC,GAA8C,IAArE,EAA2EyD,YAA3E,CAAwF,GAAxF,EAA6FjB,IAAI,CAACC,MAAL,CAAY,CAAZ,CAAA,CAAeqB,CAAf,GAAmB,CAAhH,CAAA,CAAA;EACH,OAAA;EAGJ,KAAA;KAnHa,CAAA,CAAA;;IAAA,eA2HH,CAAA,IAAA,EAAA,cAAA,EAAA,UAACrB,MAAD,EAAY;EAEvB,IAAA,IAAG,CAACxB,QAAQ,CAACC,aAAT,CAAuB,yBAAA,GAA0B,KAAI,CAAClB,EAA/B,GAAmC,IAA1D,CAAJ,EAAqE,OAAA;;MAGrE,KAAI,CAAC+D,SAAL,CAAetB,MAAf,CAAA,CAAA;;EACA,IAAA,KAAI,CAACS,UAAL,CAAgB,KAAhB,EAAuBT,MAAM,CAACA,MAA9B,CAAA,CAAA;;EAGA,IAAA,IAAIU,WAAW,GAAGlC,QAAQ,CAACC,aAAT,CAAuB,yBAA0B,GAAA,KAAI,CAAClB,EAA/B,GAAmC,IAA1D,CAAA,CAAgEoD,YAAhE,CAA6E,QAA7E,CAAlB,CAAA;EACA,IAAA,IAAIC,eAAe,GAAGF,WAAW,CAACG,KAAZ,CAAkB,GAAlB,CAAtB,CAAA;EAEA,IAAA,IAAGD,eAAe,CAAC,CAAD,CAAf,IAAoBA,eAAe,CAAC,CAAD,CAAnC,IAA0CA,eAAe,CAAC,CAAD,CAAf,IAAoBA,eAAe,CAAC,CAAD,CAAhF,EAAqFpC,QAAQ,CAACC,aAAT,CAAuB,kBAAmB,GAAA,KAAI,CAAClB,EAAxB,GAA4B,IAAnD,EAAyDgE,MAAzD,EAAA,CAAA;KAvIvE,CAAA,CAAA;;EAAA,EAAA,eAAA,CAAA,IAAA,EAAA,YAAA,EA+IL,UAACC,IAAD,EAAOxB,MAAP,EAAkB;EAI3B,IAAA,IAAImB,IAAI,GAAA,kBAAA,CAAA,MAAA,CAAsBK,IAAI,GAAG,KAAI,CAACjE,EAAlC,EAA8CyC,SAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,CAAD,CAAN,CAAUoB,CAAV,GAAc,CAA5D,EAAuEpB,SAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,CAAD,CAAN,CAAUqB,CAAV,GAAc,CAArF,EAAwIG,qDAAAA,CAAAA,CAAAA,MAAAA,CAAAA,IAAxI,kFAA8M,KAAI,CAACpB,KAAL,CAAWE,MAAzN,EAAR,iCAAA,CAAA,CAAA;MACA,IAAG9B,QAAQ,CAACC,aAAT,CAAuB,kBAAA,GAAmB,KAAI,CAAClB,EAAxB,GAA4B,IAAnD,CAAH,EAA6DiB,QAAQ,CAACC,aAAT,CAAuB,kBAAA,GAAqB,KAAI,CAAClB,EAA1B,GAA+B,IAAtD,CAAA,CAA4DiD,kBAA5D,CAA+E,WAA/E,EAA4FW,IAA5F,CAAA,CAAA;KApJ/C,CAAA,CAAA;;IAAA,eA8JL,CAAA,IAAA,EAAA,YAAA,EAAA,UAACnB,MAAD,EAAY;MAErB,OAAQA,MAAM,CAACyB,MAAP,CAAc,UAAUC,aAAV,EAAyBC,WAAzB,EAAsC;EACxD,MAAA,OAAOD,aAAa,GAAGC,WAAW,CAACP,CAA5B,GAAgC,GAAhC,GAAsCO,WAAW,CAACN,CAAlD,GAAsD,GAA7D,CAAA;EACH,KAFO,EAEL,EAFK,CAAD,CAECH,IAFD,EAAP,CAAA;KAhKc,CAAA,CAAA;;IAAA,eA2KH,CAAA,IAAA,EAAA,cAAA,EAAA,UAACU,MAAD,EAAY;EAWvB,IAAA,OAAO,KAAP,CAAA;KAtLc,CAAA,CAAA;;EAAA,EAAA,eAAA,CAAA,IAAA,EAAA,OAAA,EA6LV,YAAM;MAEV,OAAO,KAAI,CAACrE,EAAZ,CAAA;KA/Lc,CAAA,CAAA;;IAAA,eAwMV,CAAA,IAAA,EAAA,OAAA,EAAA,UAACsE,GAAD,EAAS;MAET,IAAIC,IAAI,GAAG,EAAX,CAAA;MACA,IAAIC,QAAQ,GAAG,gEAAf,CAAA;;MAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,GAApB,EAAyBG,CAAC,EAA1B,EAAA;EACIF,MAAAA,IAAI,IAAIC,QAAQ,CAACE,MAAT,CAAgBpE,IAAI,CAACqE,KAAL,CAAWrE,IAAI,CAACsE,MAAL,EAAA,GAAgBJ,QAAQ,CAACjB,MAApC,CAAhB,CAAR,CAAA;EADJ,KAAA;;EAGA,IAAA,OAAOgB,IAAP,CAAA;KAhNU,CAAA,CAAA;;IAEd,IAAK/B,CAAAA,IAAL,GAAYA,KAAZ,CAAA;EAEA,EAAA,IAAA,CAAKxC,EAAL,GAAUwC,KAAI,CAACxC,EAAL,GAAUwC,KAAI,CAACxC,EAAf,GAAoB,IAAA,CAAK6E,KAAL,CAAW,CAAX,CAA9B,CAAA;IAEA,IAAKnC,CAAAA,IAAL,GAAYF,KAAI,CAACE,IAAL,GAAYF,KAAI,CAACE,IAAjB,GAAwB,SAApC,CAAA;IAEA,IAAKkB,CAAAA,IAAL,GAAYpB,KAAI,CAACoB,IAAL,GAAYpB,KAAI,CAACoB,IAAjB,GAAwB,EAApC,CAAA;IAEA,IAAKkB,CAAAA,QAAL,GAAgB,IAAhB,CAAA;EAEA,EAAA,IAAA,CAAKjC,KAAL,GAAa;EACTC,IAAAA,YAAY,EAAE,KADL;EAETC,IAAAA,MAAM,EAAE,MAFC;EAGTC,IAAAA,IAAI,EAAE,wBAAA;KAHV,CAAA;EAkBA,EAAA,IAAA,CAAK+B,IAAL,CAAUvC,KAAI,CAACC,MAAf,CAAA,CAAA;EACH,CAjCL,CAAA,CAAA;EAuNA,IAAauC,GAAb,GAAA,YAAA,CAEI,SAAYxC,GAAAA,CAAAA,MAAZ,EAAkB;EAAA,EAAA,IAAA,MAAA,GAAA,IAAA,CAAA;;EAAA,EAAA,eAAA,CAAA,IAAA,EAAA,GAAA,CAAA,CAAA;;IAAA,eA2CX,CAAA,IAAA,EAAA,MAAA,EAAA,UAACA,IAAD,EAAU;EAEb,IAAA,IAAG,MAAI,CAACE,IAAL,IAAa,SAAhB,EAA0B;EAEtB,MAAA,IAAIuC,GAAG,GAAmB,eAAA,CAAA,MAAA,CAAA,MAAI,CAACjF,EAAxB,EAAA,qCAAA,CAAA,CAAA,MAAA,CAA8D8B,QAAM,CAACoD,IAAI,CAACC,SAAL,CAAe3C,IAAI,CAAC4C,MAApB,CAAD,CAApE,EAAA,sBAAA,CAAA,CAAA,MAAA,CAAwH,MAAI,CAACpF,EAA7H,yCAA4JwC,IAAI,CAACC,MAAjK,EAAkM,0BAAA,CAAA,CAAA,MAAA,CAAA,MAAI,CAACI,KAAL,CAAWC,YAA7M,EAAsO,UAAA,CAAA,CAAA,MAAA,CAAA,MAAI,CAACD,KAAL,CAAWE,MAAjP,EAAkQ,QAAA,CAAA,CAAA,MAAA,CAAA,MAAI,CAACF,KAAL,CAAWG,IAA7Q,EAAP,iBAAA,CAAA,CAAA;QACA/B,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+B+B,kBAA/B,CAAkD,WAAlD,EAA+DgC,GAA/D,CAAA,CAAA;;EAEA,MAAA,MAAI,CAAC/B,UAAL,CAAgB,OAAhB,EAAyBV,IAAzB,CAAA,CAAA;;EACA,MAAA,MAAI,CAACU,UAAL,CAAgB,KAAhB,EAAuBV,IAAvB,CAAA,CAAA;EACH,KAAA;;EAED,IAAA,IAAG,MAAI,CAACE,IAAL,IAAa,SAAhB,EAA0B;QAEtB,IAAI0C,MAAM,GAAGF,IAAI,CAACG,KAAL,CAAWpD,QAAQ,CAAChB,QAAQ,CAACC,aAAT,CAAuB,kBAAmB,GAAA,MAAI,CAAClB,EAAxB,GAA4B,IAAnD,EAAyDsF,OAAzD,CAAiEF,MAAlE,CAAnB,CAAb,CAAA;QAEA,IAAIG,CAAC,GAAGH,MAAM,CAACvB,CAAP,GAAWrB,IAAI,CAAC4C,MAAL,CAAYvB,CAA/B,CAAA;QACA,IAAI2B,CAAC,GAAGJ,MAAM,CAACtB,CAAP,GAAWtB,IAAI,CAAC4C,MAAL,CAAYtB,CAA/B,CAAA;EAGA,MAAA,IAAI2B,MAAM,GAAInF,IAAI,CAACoF,KAAL,CAAWH,CAAX,EAAcC,CAAd,CAAmB,GAAA,GAAnB,GAAuBlF,IAAI,CAAC8B,EAA1C,CAAA;QAA+CqD,MAAM,GAAGA,MAAM,GAAG,CAAT,GAAaA,MAAM,GAAI,CAAC,CAAxB,GAA6B,GAAA,GAAIA,MAA1C,CAAA;QAI/C,IAAG,MAAI,CAAC7B,IAAL,IAAa,OAAhB,EAAyBwB,MAAM,CAACO,UAAP,GAAoBF,MAApB,CAAA;QACzB,IAAG,MAAI,CAAC7B,IAAL,IAAa,KAAhB,EAAuBwB,MAAM,CAACQ,QAAP,GAAkBH,MAAlB,CAAA;EAEvB,MAAA,MAAI,CAACjD,IAAL,CAAUC,MAAV,GAAmB,MAAI,CAACoD,WAAL,CAAiBT,MAAM,CAACvB,CAAxB,EAA2BuB,MAAM,CAACtB,CAAlC,EAAqCsB,MAAM,CAACU,MAA5C,EAAoDV,MAAM,CAACO,UAA3D,EAAuEP,MAAM,CAACQ,QAA9E,CAAnB,CAAA;EAGA3E,MAAAA,QAAQ,CAACC,aAAT,CAAuB,qBAAmB,MAAI,CAAClB,EAAxB,GAA2B,SAAlD,CAA6DyD,CAAAA,YAA7D,CAA0E,GAA1E,EAA+E,MAAI,CAACjB,IAAL,CAAUC,MAAzF,CAAA,CAAA;QACAxB,QAAQ,CAACC,aAAT,CAAuB,kBAAA,GAAmB,MAAI,CAAClB,EAAxB,GAA2B,IAAlD,CAAwDsF,CAAAA,OAAxD,CAAgEF,MAAhE,GAAyEtD,QAAM,CAACoD,IAAI,CAACC,SAAL,CAAeC,MAAf,CAAD,CAA/E,CAAA;EAGAnE,MAAAA,QAAQ,CAACC,aAAT,CAAuB,qBAAmB,MAAI,CAAClB,EAAxB,GAA2B,qBAA3B,GAAiD,MAAI,CAAC4D,IAAtD,GAA2D,GAAlF,EAAuFH,YAAvF,CAAoG,GAApG,EAAyG2B,MAAM,CAACvB,CAAP,GAAYrB,IAAI,CAAC4C,MAAL,CAAYU,MAAZ,GAAqBxF,IAAI,CAACyF,GAAL,CAAS,MAAI,CAAC7D,QAAL,CAAcuD,MAAd,CAAT,CAAjC,GAAoE,CAA7K,CAAA,CAAA;EACAxE,MAAAA,QAAQ,CAACC,aAAT,CAAuB,qBAAmB,MAAI,CAAClB,EAAxB,GAA2B,qBAA3B,GAAiD,MAAI,CAAC4D,IAAtD,GAA2D,GAAlF,EAAuFH,YAAvF,CAAoG,GAApG,EAAyG2B,MAAM,CAACtB,CAAP,GAAYtB,IAAI,CAAC4C,MAAL,CAAYU,MAAZ,GAAqBxF,IAAI,CAAC0F,GAAL,CAAS,MAAI,CAAC9D,QAAL,CAAcuD,MAAd,CAAT,CAAjC,GAAoE,CAA7K,CAAA,CAAA;EACH,KAAA;;EAED,IAAA,OAAO,MAAP,CAAA;KAhFc,CAAA,CAAA;;EAAA,EAAA,eAAA,CAAA,IAAA,EAAA,YAAA,EAwFL,UAACxB,IAAD,EAAOzB,IAAP,EAAgB;MAEzB,IAAIyD,cAAc,GAAG,CAArB,CAAA;EAEA,IAAA,IAAGhC,IAAI,IAAI,OAAX,EAAoBgC,cAAc,GAAG,MAAI,CAAC/D,QAAL,CAAcM,IAAI,CAAC4C,MAAL,CAAYO,UAA1B,CAAjB,CAAA;EACpB,IAAA,IAAG1B,IAAI,IAAI,KAAX,EAAkBgC,cAAc,GAAG,MAAI,CAAC/D,QAAL,CAAcM,IAAI,CAAC4C,MAAL,CAAYQ,QAA1B,CAAjB,CAAA;MAElB,IAAI/B,CAAC,GAAIrB,IAAI,CAAC4C,MAAL,CAAYvB,CAAZ,GAAiBrB,IAAI,CAAC4C,MAAL,CAAYU,MAAZ,GAAqBxF,IAAI,CAACyF,GAAL,CAASE,cAAT,CAAvC,GAAoE,CAA5E,CAAA;MACA,IAAInC,CAAC,GAAItB,IAAI,CAAC4C,MAAL,CAAYtB,CAAZ,GAAiBtB,IAAI,CAAC4C,MAAL,CAAYU,MAAZ,GAAqBxF,IAAI,CAAC0F,GAAL,CAASC,cAAT,CAAvC,GAAoE,CAA5E,CAAA;EAKA,IAAA,IAAIrC,IAAI,GAAsBK,kBAAAA,CAAAA,MAAAA,CAAAA,IAAI,GAAG,MAAI,CAACjE,EAAlC,EAA8C6D,SAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAA9C,oBAAyDC,CAAzD,EAAA,gDAAA,CAAA,CAAA,MAAA,CAAuGG,IAAvG,EAA6K,uEAAA,CAAA,CAAA,MAAA,CAAA,MAAI,CAACpB,KAAL,CAAWE,MAAxL,EAAR,iCAAA,CAAA,CAAA;MACA,IAAG9B,QAAQ,CAACC,aAAT,CAAuB,kBAAA,GAAmB,MAAI,CAAClB,EAAxB,GAA4B,IAAnD,CAAH,EAA6DiB,QAAQ,CAACC,aAAT,CAAuB,kBAAA,GAAmB,MAAI,CAAClB,EAAxB,GAA4B,IAAnD,CAAA,CAAyDiD,kBAAzD,CAA4E,WAA5E,EAAyFW,IAAzF,CAAA,CAAA;KAtG/C,CAAA,CAAA;;IAAA,eAyGC,CAAA,IAAA,EAAA,kBAAA,EAAA,UAACsC,OAAD,EAAUC,OAAV,EAAmBL,MAAnB,EAA2BM,cAA3B,EAA8C;EAE7D,IAAA,IAAIH,cAAc,GAAG,MAAI,CAAC/D,QAAL,CAAckE,cAAd,CAArB,CAAA;;MAEA,OAAO;QACHvC,CAAC,EAAEqC,OAAO,GAAIJ,MAAM,GAAGxF,IAAI,CAACyF,GAAL,CAASE,cAAT,CADpB;QAEHnC,CAAC,EAAEqC,OAAO,GAAIL,MAAM,GAAGxF,IAAI,CAAC0F,GAAL,CAASC,cAAT,CAAA;OAF3B,CAAA;KA7Gc,CAAA,CAAA;;IAAA,eAmHJ,CAAA,IAAA,EAAA,aAAA,EAAA,UAACpC,CAAD,EAAIC,CAAJ,EAAOgC,MAAP,EAAeH,UAAf,EAA2BC,QAA3B,EAAwC;MAElD,IAAIS,gBAAgB,GAAGT,QAAvB,CAAA;;EACA,IAAA,IAAIS,gBAAgB,GAAGV,UAAnB,KAAkC,GAAtC,EAA2C;EACvCC,MAAAA,QAAQ,GAAG,GAAX,CAAA;EACH,KAAA;;EAED,IAAA,IAAIU,KAAK,GAAG,MAAI,CAACC,gBAAL,CAAsB1C,CAAtB,EAAyBC,CAAzB,EAA4BgC,MAA5B,EAAoCF,QAApC,CAAZ,CAAA;;EACA,IAAA,IAAIY,GAAG,GAAG,MAAI,CAACD,gBAAL,CAAsB1C,CAAtB,EAAyBC,CAAzB,EAA4BgC,MAA5B,EAAoCH,UAApC,CAAV,CAAA;;MAEA,IAAIc,QAAQ,GAAGb,QAAQ,GAAGD,UAAX,IAAyB,GAAzB,GAA+B,GAA/B,GAAqC,GAApD,CAAA;;EAEA,IAAA,IAAIU,gBAAgB,GAAGV,UAAnB,KAAkC,GAAtC,EAA2C;EACvC,MAAA,IAAIe,CAAC,GAAG,CACJ,GADI,EACCJ,KAAK,CAACzC,CADP,EACUyC,KAAK,CAACxC,CADhB,EAEJ,GAFI,EAECgC,MAFD,EAESA,MAFT,EAEiB,CAFjB,EAEoBW,QAFpB,EAE8B,CAF9B,EAEiCD,GAAG,CAAC3C,CAFrC,EAEwC2C,GAAG,CAAC1C,CAF5C,EAE+C,GAF/C,EAGNJ,IAHM,CAGD,GAHC,CAAR,CAAA;EAIH,KALD,MAMK;EACD,MAAA,IAAIgD,CAAC,GAAG,CACJ,GADI,EACCJ,KAAK,CAACzC,CADP,EACUyC,KAAK,CAACxC,CADhB,EAEJ,GAFI,EAECgC,MAFD,EAESA,MAFT,EAEiB,CAFjB,EAEoBW,QAFpB,EAE8B,CAF9B,EAEiCD,GAAG,CAAC3C,CAFrC,EAEwC2C,GAAG,CAAC1C,CAF5C,CAAA,CAGNJ,IAHM,CAGD,GAHC,CAAR,CAAA;EAIH,KAAA;;EAED,IAAA,OAAOgD,CAAP,CAAA;KA5Ic,CAAA,CAAA;;IAAA,eAqJP,CAAA,IAAA,EAAA,UAAA,EAAA,UAACvE,GAAD,EAAS;MAEhB,OAAO,CAACA,GAAG,GAAG,EAAP,IAAa7B,IAAI,CAAC8B,EAAlB,GAAuB,KAA9B,CAAA;KAvJc,CAAA,CAAA;;IAAA,eAgKT,CAAA,IAAA,EAAA,OAAA,EAAA,UAACkC,GAAD,EAAS;MAEd,IAAIC,IAAI,GAAG,EAAX,CAAA;MACA,IAAIC,QAAQ,GAAG,gEAAf,CAAA;;MAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,GAApB,EAAyBG,CAAC,EAA1B,EAAA;EACIF,MAAAA,IAAI,IAAIC,QAAQ,CAACE,MAAT,CAAgBpE,IAAI,CAACqE,KAAL,CAAWrE,IAAI,CAACsE,MAAL,EAAA,GAAgBJ,QAAQ,CAACjB,MAApC,CAAhB,CAAR,CAAA;EADJ,KAAA;;EAGA,IAAA,OAAOgB,IAAP,CAAA;KAxKc,CAAA,CAAA;;EAAA,EAAA,eAAA,CAAA,IAAA,EAAA,SAAA,EA2KR,YAAM;MAEZ,OAAO,MAAI,CAAC9B,MAAZ,CAAA;KA7Kc,CAAA,CAAA;;EAAA,EAAA,eAAA,CAAA,IAAA,EAAA,OAAA,EAgLV,YAAM;MAEV,OAAO,MAAI,CAACzC,EAAZ,CAAA;KAlLc,CAAA,CAAA;;EAEd,EAAA,IAAA,CAAKwC,IAAL,GAAYA,MAAZ,EAEA,IAAKxC,CAAAA,EAAL,GAAUwC,MAAI,CAACxC,EAAL,GAAUwC,MAAI,CAACxC,EAAf,GAAoB,KAAK6E,KAAL,CAAW,CAAX,CAF9B,CAAA;IAIA,IAAKnC,CAAAA,IAAL,GAAYF,MAAI,CAACE,IAAL,GAAYF,MAAI,CAACE,IAAjB,GAAwB,SAApC,CAAA;IAEA,IAAKkB,CAAAA,IAAL,GAAYpB,MAAI,CAACoB,IAAL,GAAYpB,MAAI,CAACoB,IAAjB,GAAwB,EAApC,CAAA;EAEA,EAAA,IAAA,CAAKf,KAAL,GAAa;EACTC,IAAAA,YAAY,EAAE,KADL;EAETC,IAAAA,MAAM,EAAE,SAFC;EAGTC,IAAAA,IAAI,EAAE,wBAAA;KAHV,CAAA;IAMA,IAAK8B,CAAAA,QAAL,GAAgB,IAAhB,CAAA;EAIA,EAAA,IAAA,CAAKtC,IAAL,CAAUC,MAAV,GAAmB,IAAA,CAAKoD,WAAL,CAAiBrD,MAAI,CAAC4C,MAAL,CAAYvB,CAA7B,EAAgCrB,MAAI,CAAC4C,MAAL,CAAYtB,CAA5C,EAA+CtB,MAAI,CAAC4C,MAAL,CAAYU,MAA3D,EAAmEtD,MAAI,CAAC4C,MAAL,CAAYO,UAA/E,EAA2FnD,MAAI,CAAC4C,MAAL,CAAYQ,QAAvG,CAAnB,CAAA;IAcA,IAAKb,CAAAA,IAAL,CAAU,IAAA,CAAKvC,IAAf,CAAA,CAAA;EACH,CArCL,CAAA;;ECnNA,IAAMmE,GAAG,GAAG,uDAAZ,CAAA;EAGA,IAAMxG,KAAK,GAAG;EAEVyG,EAAAA,IAAI,EAAE,SAAM,IAAA,GAAA;EAERzG,IAAAA,KAAK,CAAC0G,OAAN,EAAA,CAAA;KAJM;EAMVnG,EAAAA,KAAK,EAAE;EACHoG,IAAAA,SAAS,EAAE,CADR;EAEHnG,IAAAA,QAAQ,EAAE,EAFP;EAGHoG,IAAAA,WAAW,EAAE,EAHV;EAIHC,IAAAA,SAAS,EAAE,IAJR;EAKHC,IAAAA,OAAO,EAAE;EAAEC,MAAAA,YAAY,EAAE,EAAA;OALtB;EAMHC,IAAAA,MAAM,EAAE;EAAEzE,MAAAA,IAAI,EAAE,SAAR;EAAmBuB,MAAAA,IAAI,EAAE,EAAzB;EAA6BmD,MAAAA,SAAS,EAAE,KAAxC;EAA+CC,MAAAA,IAAI,EAAE;EAAErH,QAAAA,EAAE,EAAE,IAAA;SAA3D;EAAmEsH,MAAAA,KAAK,EAAE,KAAA;EAA1E,KAAA;KAZF;EAcVT,EAAAA,OAAO,EAAE,SAAM,OAAA,GAAA;MAEX,IAAI7G,EAAE,GAAGN,YAAY,EAArB,CAAA;MACU6H,OAAO,GAAjB;MAEAC,KAAK,CAAC,8BAAD,EAAiC;EAClCC,MAAAA,MAAM,EAAE,MAD0B;EAElCC,MAAAA,OAAO,EAAEA,OAFyB;EAGlCC,MAAAA,IAAI,EAAEzC,IAAI,CAACC,SAAL,CAAe;EACjByC,QAAAA,KAAK,EAAE;EACHC,UAAAA,IAAI,EAAE;EACF5D,YAAAA,IAAI,EAAQ,cADV;cAEF6D,MAAM,EAAM,CAAC,QAAD,CAFV;cAGFC,KAAK,EAAOC,SAAS,CAAC,cAAD,CAAA;aAJtB;EAMHf,UAAAA,OAAO,EAAE;EACLhD,YAAAA,IAAI,EAAQ,MADP;EAELgE,YAAAA,GAAG,EAAS,mBAFP;EAGLjI,YAAAA,EAAE,EAAUA,EAHP;EAIL8H,YAAAA,MAAM,EAAM,CAAC,KAAD,EAAQ,IAAR,EAAc,MAAd,EAAsB,WAAtB,EAAmC,QAAnC,EAA6C,cAA7C,EAA6D,SAA7D,EAAwE,eAAxE,EAAyF,eAAzF,EAA0G,gBAA1G,EAA4H,YAA5H,EAA0I,WAA1I,EAAuJ,OAAvJ,EAAgK,SAAhK,CAAA;aAVb;EAYHnH,UAAAA,QAAQ,EAAE;EACNsD,YAAAA,IAAI,EAAQ,KADN;EAENgE,YAAAA,GAAG,EAAS,oBAFN;EAGNH,YAAAA,MAAM,EAAM,CAAC,UAAD,EAAa,eAAb,EAA8B,mBAA9B,EAAmD,UAAnD,EAA+D,eAA/D,EAAgF,UAAhF,EAA4F,aAA5F,CAAA;aAfb;EAiBHf,UAAAA,WAAW,EAAE;EACT9C,YAAAA,IAAI,EAAQ,KADH;EAETgE,YAAAA,GAAG,EAAS,aAFH;EAGTH,YAAAA,MAAM,EAAM,CAAC,YAAD,EAAe,OAAf,CAAA;aApBb;EAsBHI,UAAAA,MAAM,EAAE;EACJjE,YAAAA,IAAI,EAAQ,QADR;cAEJkE,MAAM,EAAO,CAAC,WAAD,CAFT;EAGJF,YAAAA,GAAG,EAAU,WAAA;EAHT,WAAA;EAtBL,SAAA;SADL,CAAA;EAH4B,KAAjC,CAAL,CAkCCG,IAlCD,CAkCM,UAAAC,QAAQ,EAAA;QAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,KAlCd,CAmCCF,CAAAA,IAnCD,CAmCM,UAAAC,QAAQ,EAAI;QAGdE,UAAU,EAAA,CAAA;;EAEV,MAAA,IAAI,CAACF,QAAQ,CAACG,OAAd,EAAsB;UAAEC,aAAa,CAACJ,QAAD,CAAb,CAAA;EAAyB,QAAA,OAAA;EAAS,OAAA;;QAE1D,IAAIA,QAAQ,CAACG,OAAb,EAAqB;EAEjBrI,QAAAA,KAAK,CAACO,KAAN,CAAYC,QAAZ,GAAuB0H,QAAQ,CAAC1H,QAAhC,CAAA;EACAR,QAAAA,KAAK,CAACO,KAAN,CAAYqG,WAAZ,GAA0BsB,QAAQ,CAACtB,WAAnC,CAAA;EACA5G,QAAAA,KAAK,CAACO,KAAN,CAAYuG,OAAZ,GAAsBoB,QAAQ,CAACpB,OAA/B,CAAA;;EAGA,QAAA,IAAIoB,QAAQ,CAACpB,OAAT,CAAiB1D,MAAjB,IAA2B,CAA/B,EAAkC;EAAE,UAAA,OAAA;EAAS,SAAA;;UAG7CtC,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAA,CAAoC+B,kBAApC,CAAuD,WAAvD,EAAoEZ,WAAW,EAA/E,CAAA,CAAA;;EAGAlC,QAAAA,KAAK,CAACuI,WAAN,CAAkBL,QAAQ,CAACpB,OAA3B,CAAA,CAAA;;EAGA9G,QAAAA,KAAK,CAACwI,UAAN,CAAiBN,QAAQ,CAACpB,OAA1B,CAAA,CAAA;;EAGA9G,QAAAA,KAAK,CAACyI,aAAN,EAAA,CAAA;EACH,OAAA;OA9DL,CAAA,CAAA,OAAA,CAAA,CAgEO,UAAAC,KAAK,EAAI;QAAEJ,aAAa,CAACI,KAAD,CAAb,CAAA;OAhElB,CAAA,CAAA;KAnBM;IAqFVF,UAAU,EAAE,SAAC1B,UAAAA,CAAAA,OAAD,EAAa;MAErB,IAAIP,CAAC,GAAGzF,QAAR,CAAA;EAEAd,IAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,GAA0B,SAA1B,CAAA;;MAOA,IAAGuE,OAAO,CAACC,YAAX,EAAwB;EAEpB4B,MAAAA,aAAa,CAAC7H,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAD,CAAb,CAAA;EAEA+F,MAAAA,OAAO,CAACC,YAAR,CAAqB6B,OAArB,CAA6B,UAAAC,GAAG,EAAI;EAEhC,QAAA,IAAIC,IAAI,GAAG9I,KAAK,CAAC+I,cAAN,CAAqBF,GAArB,CAAX,CAAA;;UAEA,IAAG,CAAC/H,QAAQ,CAACC,aAAT,CAAuB,QAAS8H,GAAAA,GAAG,CAAChJ,EAApC,CAAJ,EAA6CiB,QAAQ,CAACC,aAAT,CAAuB,eAAvB,EAAwC+B,kBAAxC,CAA2D,WAA3D,EAAwEgG,IAAxE,CAAA,CAAA;;EAE7C,QAAA,IAAG,CAAChI,QAAQ,CAACC,aAAT,CAAuB,kBAAA,GAAqB8H,GAAG,CAAChJ,EAAzB,GAA6B,IAApD,CAAJ,EAA8D;YAE1D,QAAOgJ,GAAG,CAAC/E,IAAX;EAEI,YAAA,KAAK,UAAL;gBAEI,IAAIkF,UAAU,GAAGH,GAAG,CAACvG,MAAJ,CAAWa,KAAX,CAAiB,GAAjB,CAAjB,CAAA;gBACAnD,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,GAA8B,IAAI7G,QAAJ,CAAa;EAAEE,gBAAAA,MAAM,EAAE,CAAC;EAACoB,kBAAAA,CAAC,EAAEsF,UAAU,CAAC,CAAD,CAAd;oBAAmBrF,CAAC,EAAEqF,UAAU,CAAC,CAAD,CAAA;EAAhC,iBAAD,CAAV;EAAmDzG,gBAAAA,IAAI,EAAE,SAAzD;kBAAoE1C,EAAE,EAAEgJ,GAAG,CAAChJ,EAAAA;EAA5E,eAAb,CAA9B,CAAA;;gBACAG,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,CAA4BrF,SAA5B,CAAsC;EAAEtB,gBAAAA,MAAM,EAAE,CAAC;EAACoB,kBAAAA,CAAC,EAAEsF,UAAU,CAAC,CAAD,CAAd;oBAAmBrF,CAAC,EAAEqF,UAAU,CAAC,CAAD,CAAA;EAAhC,iBAAD,CAAV;EAAmDzG,gBAAAA,IAAI,EAAE,SAAA;iBAA/F,CAAA,CAAA;;gBACAvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,CAA4BC,YAA5B,CAAyC;EAAE5G,gBAAAA,MAAM,EAAE,CAAC;EAACoB,kBAAAA,CAAC,EAAEsF,UAAU,CAAC,CAAD,CAAd;oBAAmBrF,CAAC,EAAEqF,UAAU,CAAC,CAAD,CAAA;EAAhC,iBAAD,CAAV;EAAmDzG,gBAAAA,IAAI,EAAE,SAAA;iBAAlG,CAAA,CAAA;;EACJ,cAAA,MAAA;;EACA,YAAA,KAAK,KAAL;EAIIsG,cAAAA,GAAG,CAAC5D,MAAJ,GAAa,OAAO4D,GAAG,CAAC5D,MAAX,IAAsB,QAAtB,GAAiC,EAAjC,GAAsC4D,GAAG,CAAC5D,MAAvD,CAAA;gBAIAjF,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlC,GAAnB,GAAyB,IAAID,GAAJ,CAAQ;EAAEI,gBAAAA,MAAM,EAAE;EAAEvB,kBAAAA,CAAC,EAAEmF,GAAG,CAAC5D,MAAJ,CAAWvB,CAAhB;EAAmBC,kBAAAA,CAAC,EAAEkF,GAAG,CAAC5D,MAAJ,CAAWtB,CAAjC;EAAoCgC,kBAAAA,MAAM,EAAEkD,GAAG,CAAC5D,MAAJ,CAAWU,MAAvD;EAA+DH,kBAAAA,UAAU,EAAEqD,GAAG,CAAC5D,MAAJ,CAAWO,UAAtF;EAAkGC,kBAAAA,QAAQ,EAAEoD,GAAG,CAAC5D,MAAJ,CAAWQ,QAAAA;mBAAjI;EAA6IlD,gBAAAA,IAAI,EAAE,SAAnJ;kBAA8J1C,EAAE,EAAEgJ,GAAG,CAAChJ,EAAAA;EAAtK,eAAR,CAAzB,CAAA;EACJ,cAAA,MAAA;EAlBJ,WAAA;EAoBH,SAAA;SA5BL,CAAA,CAAA;;EA+BAG,MAAAA,KAAK,CAACmJ,aAAN,EAAA,CAAA;EACH,KAAA;;MAEDnJ,KAAK,CAACoJ,SAAN,CAAgBC,mBAAhB,EAAA,CAAA;;EAEArJ,IAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,GAA8B,IAA9B,CAAA;EAGA1C,IAAAA,CAAC,CAACxF,aAAF,CAAgB,aAAhB,EAA+BU,KAA/B,GAAuCqF,OAAO,CAACwC,UAAR,GAAqBxC,OAAO,CAACwC,UAA7B,GAA0C,SAAjF,CAAA;MAGA/C,CAAC,CAACxF,aAAF,CAAgB,UAAhB,EAA4BU,KAA5B,GAAoCqF,OAAO,CAACyC,OAA5C,CAAA;MACAhD,CAAC,CAACxF,aAAF,CAAgB,gBAAhB,EAAkCU,KAAlC,GAA0CqF,OAAO,CAAC0C,aAAlD,CAAA;MACAjD,CAAC,CAACxF,aAAF,CAAgB,gBAAhB,EAAkCU,KAAlC,GAA0CqF,OAAO,CAAC2C,aAAlD,CAAA;MACAlD,CAAC,CAACxF,aAAF,CAAgB,iBAAhB,EAAmCU,KAAnC,GAA2CqF,OAAO,CAAC4C,cAAnD,CAAA;MAGAnD,CAAC,CAACxF,aAAF,CAAgB,QAAhB,EAA0BU,KAA1B,GAAkCsD,IAAI,CAACC,SAAL,CAAe8B,OAAO,CAAC6C,SAAR,GAAoB7C,OAAO,CAAC6C,SAA5B,GAAwC,EAAvD,CAAlC,CAAA;EAGApD,IAAAA,CAAC,CAACxF,aAAF,CAAgB,YAAhB,EAA8B6I,OAA9B,GAAwC9C,OAAO,CAAC+C,SAAR,IAAqB,CAArB,GAAyB,IAAzB,GAAgC,KAAxE,CAAA;MACAtD,CAAC,CAACxF,aAAF,CAAgB,SAAhB,EAA2BU,KAA3B,GAAmCqF,OAAO,CAACgD,MAA3C,CAAA;;MAGA9J,KAAK,CAACoJ,SAAN,CAAgBW,mBAAhB,EAAA,CAAA;;MAGAjJ,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAA,CAAmCG,gBAAnC,CAAoD,OAApD,EAA6D,UAACC,CAAD,EAAO;EAEhE,MAAA,IAAIoI,OAAO,GAAGpI,CAAC,CAAC6I,aAAF,CAAgBvI,KAA9B,CAAA;QACA,IAAIwI,MAAM,GAAG,UAAb,CAAA;QAGAV,OAAO,GAAGA,OAAO,CAACW,UAAR,CAAmB,SAAnB,EAA8B,CAA9B,CAAV,CAAA;;EANgE,MAAA,IAAA,SAAA,GAAA,0BAAA,CAQjDpJ,QAAQ,CAACE,gBAAT,CAA0B,qBAA1B,CARiD,CAAA;EAAA,UAAA,KAAA,CAAA;;EAAA,MAAA,IAAA;UAQhE,KAAgE,SAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,KAAA,GAAA,SAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAAxDmJ,GAAwD,GAAA,KAAA,CAAA,KAAA,CAAA;YAE5DF,MAAM,IAAIE,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAAlC,GAA0C,GAApD,CAAA;YACA8H,OAAO,GAAGA,OAAO,CAACW,UAAR,CAAmBC,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAArD,EAA4DpB,UAAU,CAAC8J,GAAG,CAACpJ,aAAJ,CAAkB,gBAAlB,CAAA,CAAoCU,KAArC,CAAtE,CAAV,CAAA;EACH,SAAA;EAZ+D,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,SAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,SAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;;EAahEwI,MAAAA,MAAM,GAAGA,MAAM,CAACzG,IAAP,EAAT,CAAA;QAEA,IAAI4G,MAAM,GAAG,CAAb,CAAA;;QAEA,IAAG;EACCtJ,QAAAA,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAwCsJ,CAAAA,SAAxC,GAAoD,EAApD,CAAA;EACAD,QAAAA,MAAM,GAAGE,IAAI,CAACf,OAAD,CAAb,CAAA;EACAzI,QAAAA,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAmCwJ,CAAAA,iBAAnC,CAAqD,EAArD,CAAA,CAAA;SAHJ,CAIC,OAAMpJ,CAAN,EAAQ;UACLL,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAA,CAAmCwJ,iBAAnC,CAAsDC,EAAE,CAAC,iBAAD,CAAxD,CAAA,CAAA;UACA1J,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAA,CAAwCsJ,SAAxC,GAAoDG,EAAE,CAAC,0DAA6DP,GAAAA,MAA9D,CAAtD,CAAA;EACH,OAAA;;QAEDnJ,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAA,CAAmC0J,aAAnC,CAAiDC,SAAjD,CAA2DC,GAA3D,CAA+D,eAA/D,CAAA,CAAA;QAEA,IAAGP,MAAM,GAAC,CAAV,EAAatJ,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAwCsJ,CAAAA,SAAxC,GAAoDG,EAAE,CAAC,gBAAgBJ,MAAM,GAAG,OAAzB,GAAmC,iDAApC,EAAuFA,MAAvF,CAAtD,CAAA;OA5BjB,CAAA,CAAA;MAgCAtJ,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCG,gBAAzC,CAA0D,OAA1D,EAAmE,UAACC,CAAD,EAAO;EAEtE,MAAA,IAAIoI,OAAO,GAAGpI,CAAC,CAAC6I,aAAF,CAAgBvI,KAA9B,CAAA;QACA,IAAIwI,MAAM,GAAG,UAAb,CAAA;QAGAV,OAAO,GAAGA,OAAO,CAACW,UAAR,CAAmB,SAAnB,EAA8B,CAA9B,CAAV,CAAA;;EANsE,MAAA,IAAA,UAAA,GAAA,0BAAA,CAQrDlK,KAAK,CAACO,KAAN,CAAYqG,WAAZ,CAAwB3G,KAR6B,CAAA;EAAA,UAAA,MAAA,CAAA;;EAAA,MAAA,IAAA;UAQtE,KAA+C,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAAvCA,KAAuC,GAAA,MAAA,CAAA,KAAA,CAAA;EAE3C,UAAA,IAAGA,KAAK,CAACJ,EAAN,CAASuD,MAAT,IAAmB,CAAtB,EAAyB,SAAA;EAEzB6G,UAAAA,MAAM,IAAIhK,KAAK,CAACJ,EAAN,GAAW,GAArB,CAAA;EACA0J,UAAAA,OAAO,GAAGA,OAAO,CAACW,UAAR,CAAmBjK,KAAK,CAACJ,EAAzB,EAA6BQ,UAAU,CAACJ,KAAK,CAACA,KAAP,CAAvC,CAAV,CAAA;EACH,SAAA;EAdqE,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;;EAAA,MAAA,IAAA,UAAA,GAAA,0BAAA,CAgBvDa,QAAQ,CAACE,gBAAT,CAA0B,qBAA1B,CAhBuD,CAAA;EAAA,UAAA,MAAA,CAAA;;EAAA,MAAA,IAAA;UAgBtE,KAAgE,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAAxDmJ,GAAwD,GAAA,MAAA,CAAA,KAAA,CAAA;YAE5DF,MAAM,IAAIE,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAAlC,GAA0C,GAApD,CAAA;YACA8H,OAAO,GAAGA,OAAO,CAACW,UAAR,CAAmBC,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAArD,EAA4DpB,UAAU,CAAC8J,GAAG,CAACpJ,aAAJ,CAAkB,gBAAlB,CAAA,CAAoCU,KAArC,CAAtE,CAAV,CAAA;EACH,SAAA;EApBqE,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;;EAwBtEwI,MAAAA,MAAM,GAAGA,MAAM,CAACzG,IAAP,EAAT,CAAA;QAEA,IAAI4G,MAAM,GAAG,CAAb,CAAA;;QAEA,IAAG;EACCtJ,QAAAA,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAA8CsJ,CAAAA,SAA9C,GAA0D,EAA1D,CAAA;EACAD,QAAAA,MAAM,GAAGE,IAAI,CAACf,OAAD,CAAb,CAAA;EACAzI,QAAAA,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAyCwJ,CAAAA,iBAAzC,CAA2D,EAA3D,CAAA,CAAA;SAHJ,CAIC,OAAMpJ,CAAN,EAAQ;UACLL,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCwJ,iBAAzC,CAA4DC,EAAE,CAAC,uBAAD,CAA9D,CAAA,CAAA;UACA1J,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAAA,CAA8CsJ,SAA9C,GAA0DG,EAAE,CAAC,gEAAmEP,GAAAA,MAApE,CAA5D,CAAA;EACH,OAAA;;QAEDnJ,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyC0J,aAAzC,CAAuDC,SAAvD,CAAiEC,GAAjE,CAAqE,eAArE,CAAA,CAAA;QAEA,IAAGP,MAAM,GAAC,CAAV,EAAatJ,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAAA,CAA8CsJ,SAA9C,GAA0DG,EAAE,CAAC,aAAA,GAAgBzK,WAAW,CAACC,KAAD,EAAQoK,MAAR,CAA3B,GAA6C,+CAA9C,EAA+FA,MAA/F,CAA5D,CAAA;OAvCjB,CAAA,CAAA;MA2CAtJ,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCG,gBAAzC,CAA0D,OAA1D,EAAmE,UAACC,CAAD,EAAO;EAEtE,MAAA,IAAIoI,OAAO,GAAGpI,CAAC,CAAC6I,aAAF,CAAgBvI,KAA9B,CAAA;QACA,IAAIwI,MAAM,GAAG,GAAb,CAAA;;EAHsE,MAAA,IAAA,UAAA,GAAA,0BAAA,CAKvDnJ,QAAQ,CAACE,gBAAT,CAA0B,qBAA1B,CALuD,CAAA;EAAA,UAAA,MAAA,CAAA;;EAAA,MAAA,IAAA;UAKtE,KAAgE,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAAxDmJ,GAAwD,GAAA,MAAA,CAAA,KAAA,CAAA;YAE5DF,MAAM,IAAIE,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAAlC,GAA0C,GAApD,CAAA;YACA8H,OAAO,GAAGA,OAAO,CAACW,UAAR,CAAmBC,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAArD,EAA4DpB,UAAU,CAAC8J,GAAG,CAACpJ,aAAJ,CAAkB,gBAAlB,CAAA,CAAoCU,KAArC,CAAtE,CAAV,CAAA;EACH,SAAA;EATqE,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;;EAWtEwI,MAAAA,MAAM,GAAGA,MAAM,CAACzG,IAAP,EAAT,CAAA;QAEA,IAAI4G,MAAM,GAAG,CAAb,CAAA;;QAEA,IAAG;EACCtJ,QAAAA,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAA8CsJ,CAAAA,SAA9C,GAA0D,EAA1D,CAAA;EACAD,QAAAA,MAAM,GAAGE,IAAI,CAACf,OAAD,CAAb,CAAA;EACAzI,QAAAA,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAyCwJ,CAAAA,iBAAzC,CAA2D,EAA3D,CAAA,CAAA;SAHJ,CAIC,OAAMpJ,CAAN,EAAQ;UAELyJ,OAAO,CAACC,GAAR,CAAY1J,CAAZ,CAAA,CAAA;UACAL,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCwJ,iBAAzC,CAA4DC,EAAE,CAAC,uBAAD,CAA9D,CAAA,CAAA;UACA1J,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAAA,CAA8CsJ,SAA9C,GAA0DG,EAAE,CAAC,gEAAmEP,GAAAA,MAApE,CAA5D,CAAA;EACH,OAAA;;QAEDnJ,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyC0J,aAAzC,CAAuDC,SAAvD,CAAiEC,GAAjE,CAAqE,eAArE,CAAA,CAAA;OA1BJ,CAAA,CAAA;MA8BA7J,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAAA,CAA0CG,gBAA1C,CAA2D,OAA3D,EAAoE,UAACC,CAAD,EAAO;EAEvE,MAAA,IAAIoI,OAAO,GAAGpI,CAAC,CAAC6I,aAAF,CAAgBvI,KAA9B,CAAA;QACA,IAAIwI,MAAM,GAAG,GAAb,CAAA;;EAHuE,MAAA,IAAA,UAAA,GAAA,0BAAA,CAKxDnJ,QAAQ,CAACE,gBAAT,CAA0B,qBAA1B,CALwD,CAAA;EAAA,UAAA,MAAA,CAAA;;EAAA,MAAA,IAAA;UAKvE,KAAgE,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAAxDmJ,GAAwD,GAAA,MAAA,CAAA,KAAA,CAAA;YAE5DF,MAAM,IAAIE,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAAlC,GAA0C,GAApD,CAAA;YACA8H,OAAO,GAAGA,OAAO,CAACW,UAAR,CAAmBC,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAArD,EAA4DpB,UAAU,CAAC8J,GAAG,CAACpJ,aAAJ,CAAkB,gBAAlB,CAAA,CAAoCU,KAArC,CAAtE,CAAV,CAAA;EACH,SAAA;EATsE,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;;EAWvEwI,MAAAA,MAAM,GAAGA,MAAM,CAACzG,IAAP,EAAT,CAAA;QAEA,IAAI4G,MAAM,GAAG,CAAb,CAAA;;QAEA,IAAG;EACCtJ,QAAAA,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,CAA+CsJ,CAAAA,SAA/C,GAA2D,EAA3D,CAAA;EACAD,QAAAA,MAAM,GAAGE,IAAI,CAACf,OAAD,CAAb,CAAA;EACAzI,QAAAA,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAA0CwJ,CAAAA,iBAA1C,CAA4D,EAA5D,CAAA,CAAA;SAHJ,CAIC,OAAMpJ,CAAN,EAAQ;UAELyJ,OAAO,CAACC,GAAR,CAAY1J,CAAZ,CAAA,CAAA;UACAL,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAAA,CAA0CwJ,iBAA1C,CAA6DC,EAAE,CAAC,wBAAD,CAA/D,CAAA,CAAA;UACA1J,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,CAAA,CAA+CsJ,SAA/C,GAA2DG,EAAE,CAAC,iEAAoEP,GAAAA,MAArE,CAA7D,CAAA;EACH,OAAA;;QAEDnJ,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAAA,CAA0C0J,aAA1C,CAAwDC,SAAxD,CAAkEC,GAAlE,CAAsE,eAAtE,CAAA,CAAA;OA1BJ,CAAA,CAAA;MA8BA,IAAG,CAAC7D,OAAO,CAACgE,KAAZ,EAAmBhE,OAAO,CAACgE,KAAR,GAAgB,EAAhB,CAAA;EACnB,IAAA,IAAG,CAACC,KAAK,CAACC,OAAN,CAAclE,OAAO,CAACgE,KAAtB,CAAJ,EAAkChE,OAAO,CAACgE,KAAR,GAAgB,EAAhB,CAAA;EAElChE,IAAAA,OAAO,CAACgE,KAAR,CAAclC,OAAd,CAAsB,UAAAqC,IAAI,EAAI;QAE1BnK,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAA,CAAiCU,KAAjC,IAA0CwJ,IAAI,CAACpL,EAAL,GAAU,IAApD,CAAA;OAFJ,CAAA,CAAA;KAxSM;EA6SV4I,EAAAA,aAAa,EAAE,SAAM,aAAA,GAAA;EAEjB,IAAA,IAAG,CAACzI,KAAK,CAACO,KAAN,CAAYsG,SAAhB,EAA2B,OAAA;MAG3BqE,OAAO,CAAC,WAAD,EAAclL,KAAK,CAACoJ,SAAN,CAAgB+B,WAA9B,CAAP,CAAA;MAGAD,OAAO,CAAC,uBAAD,EAA0BlL,KAAK,CAACoJ,SAAN,CAAgBgC,eAA1C,CAAP,CAAA;MAGAC,QAAQ,CAAC,aAAD,EAAgBrL,KAAK,CAACoJ,SAAN,CAAgBkC,WAAhC,CAAR,CAAA;EAEAtL,IAAAA,KAAK,CAACO,KAAN,CAAYsG,SAAZ,GAAwB,KAAxB,CAAA;KA1TM;EA4TVuC,EAAAA,SAAS,EAAE;MAEPkC,WAAW,EAAE,SAACnK,WAAAA,CAAAA,CAAD,EAAO;EAEhBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;;QAEA1B,KAAK,CAACoJ,SAAN,CAAgBW,mBAAhB,EAAA,CAAA;OANG;EAUPA,IAAAA,mBAAmB,EAAE,SAAM,mBAAA,GAAA;QAEvBjJ,QAAQ,CAACC,aAAT,CAAuB,eAAvB,EAAwC2J,SAAxC,CAAkDC,GAAlD,CAAsD,QAAtD,CAAA,CAAA;QACA7J,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,EAA8C2J,SAA9C,CAAwDC,GAAxD,CAA4D,QAA5D,CAAA,CAAA;QACA7J,QAAQ,CAACC,aAAT,CAAuB,aAAvB,EAAsC2J,SAAtC,CAAgDC,GAAhD,CAAoD,QAApD,CAAA,CAAA;QACA7J,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,EAAgD2J,SAAhD,CAA0DC,GAA1D,CAA8D,QAA9D,CAAA,CAAA;QAEA,IAAIrB,UAAU,GAAGxI,QAAQ,CAACC,aAAT,CAAuB,aAAvB,EAAsCU,KAAvD,CAAA;;QAEA,IAAG6H,UAAU,IAAE,UAAf,EAA0B;UAEtBxI,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,EAAgD2J,SAAhD,CAA0D7G,MAA1D,CAAiE,QAAjE,CAAA,CAAA;EACH,OAAA;;QAED,IAAGyF,UAAU,IAAE,SAAf,EAAyB;UAErBxI,QAAQ,CAACC,aAAT,CAAuB,eAAvB,EAAwC2J,SAAxC,CAAkD7G,MAAlD,CAAyD,QAAzD,CAAA,CAAA;UACA/C,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,EAA8C2J,SAA9C,CAAwD7G,MAAxD,CAA+D,QAA/D,CAAA,CAAA;EACH,OAAA;;QAED,IAAGyF,UAAU,IAAE,SAAf,EAAyB;UAErBxI,QAAQ,CAACC,aAAT,CAAuB,aAAvB,EAAsC2J,SAAtC,CAAgD7G,MAAhD,CAAuD,QAAvD,CAAA,CAAA;EACH,OAAA;OAjCE;MAoCP0H,cAAc,EAAE,SAACpK,cAAAA,CAAAA,CAAD,EAAO;EAEnB,MAAA,IAAIqK,KAAK,GAAG1K,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAZ,CAAA;QACA,IAAI0K,SAAS,GAAG,IAAIC,SAAS,CAACC,KAAd,CAAoBH,KAApB,CAAhB,CAAA;QAEAA,KAAK,CAACzK,aAAN,CAAoB,eAApB,EAAqC2J,SAArC,CAA+CC,GAA/C,CAAmD,UAAnD,CAAA,CAAA;QACAa,KAAK,CAACzK,aAAN,CAAoB,cAApB,CAAA,CAAoCsJ,SAApC,GAAgDlI,MAAM,CAAC,YAAD,CAAtD,CAAA;QACAqJ,KAAK,CAACzK,aAAN,CAAoB,cAApB,EAAoC2J,SAApC,CAA8CC,GAA9C,CAAkD,QAAlD,CAAA,CAAA;QACAa,KAAK,CAACzK,aAAN,CAAoB,gBAApB,CAAA,CAAsCsJ,SAAtC,GAAkDlI,MAAM,CAAC,OAAD,CAAxD,CAAA;QAIA,IAAIyJ,SAAS,6VAOgDzJ,MAAM,CAAC,MAAD,CAPtD,EAAA,2DAAA,CAAA,CAAA,MAAA,CAOwHA,MAAM,CAAC,MAAD,CAP9H,wDAOoLA,MAAM,CAAC,QAAD,CAP1L,EAOkPA,6CAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,OAAD,CAPxP,EAO0TA,0DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,OAAD,CAPhU,EAOkYA,0DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,MAAD,CAPxY,EAAA,o2EAAA,CAAA,CAAA,MAAA,CAsCwDA,MAAM,CAAC,MAAD,CAtC9D,EAAA,sFAAA,CAAA,CAAA,MAAA,CAuCiDA,MAAM,CAAC,QAAD,CAvCvD,EAAA,kFAAA,CAAA,CAAA,MAAA,CAwC6CA,MAAM,CAAC,GAAD,CAxCnD,+FAyC+CA,MAAM,CAAC,MAAD,CAzCrD,EAAb,q2BAAA,CAAA,CAAA;EAoDMyJ,MAAAA,SAAS,IAAT,oIAAA,CAAA;EAONJ,MAAAA,KAAK,CAACzK,aAAN,CAAoB,aAApB,CAAmCsJ,CAAAA,SAAnC,GAA+CuB,SAA/C,CAAA;EAIA,MAAA,IAAI3L,KAAK,GAAG8E,IAAI,CAACG,KAAL,CAAWpE,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAA,CAAiCU,KAA5C,CAAZ;YAAgEoK,UAAU,GAAG,EAA7E,CAAA;QACA,IAAIC,cAAc,GAAG,mBAAoBtB,GAAAA,EAAE,CAAC,MAAD,CAAtB,GAA+B,WAApD,CAAA;EACA,MAAA,IAAGvK,KAAK,CAACmD,MAAN,IAAgB,CAAnB,EAAsBnD,KAAK,GAAGD,KAAK,CAACO,KAAN,CAAYqG,WAAZ,CAAwB3G,KAAhC,CAAA;EACtB,MAAA,IAAGD,KAAK,CAACO,KAAN,CAAYqG,WAAZ,CAAwBiF,UAA3B,EAAuCA,UAAU,GAAG7L,KAAK,CAACO,KAAN,CAAYqG,WAAZ,CAAwBiF,UAArC,CAAA;QAEvCjB,OAAO,CAACC,GAAR,CAAY5K,KAAZ,CAAA,CAAA;;EAEA,MAAA,IAAG8K,KAAK,CAACC,OAAN,CAAc/K,KAAd,CAAH,EAAwB;EAGpBA,QAAAA,KAAK,CAAC2I,OAAN,CAAc,UAAC3I,KAAD,EAAQqE,CAAR,EAAc;EAExB,UAAA,IAAG,CAACrE,KAAK,CAAC8L,MAAV,EAAiB;EAEbjL,YAAAA,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,CAAA,CAA+C+B,kBAA/C,CAAkE,WAAlE,EAA+E9C,KAAK,CAACgM,gBAAN,CAAuB/L,KAAvB,EAA8BqE,CAA9B,CAA/E,CAAA,CAAA;EAEH,WAAA;WANL,CAAA,CAAA;EAUArE,QAAAA,KAAK,CAAC2I,OAAN,CAAc,UAAC3I,KAAD,EAAQqE,CAAR,EAAc;YAExB,IAAGrE,KAAK,CAAC8L,MAAT,EAAgB;cAGZ,IAAGjL,QAAQ,CAACC,aAAT,CAAuB,qCAAA,GAAsCd,KAAK,CAAC8L,MAA5C,GAAmD,IAA1E,CAAH,EAAoF;gBAChFjL,QAAQ,CAACC,aAAT,CAAuB,qCAAA,GAAsCd,KAAK,CAAC8L,MAA5C,GAAmD,IAA1E,CAAA,CAAgFjJ,kBAAhF,CAAmG,UAAnG,EAA+G9C,KAAK,CAACgM,gBAAN,CAAuB/L,KAAvB,EAA8BqE,CAA9B,CAA/G,CAAA,CAAA;EACH,aAFD,MAEK;EACDxD,cAAAA,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,CAAA,CAA+C+B,kBAA/C,CAAkE,WAAlE,EAA+E9C,KAAK,CAACgM,gBAAN,CAAuB/L,KAAvB,EAA8BqE,CAA9B,CAA/E,CAAA,CAAA;EACH,aAAA;EACJ,WAAA;WAVL,CAAA,CAAA;EAaH,OA1BD,MA0BK;EACDrE,QAAAA,KAAK,GAAG,EAAR,CAAA;EACAa,QAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAiCU,CAAAA,KAAjC,GAAyC,IAAzC,CAAA;EACH,OAAA;;QAEDoK,UAAU,CAAC1I,KAAX,CAAiB,IAAjB,EAAuByF,OAAvB,CAA+B,UAAA3H,EAAE,EAAI;UAEjC6K,cAAc,IAAI,oBAAkB7K,EAAlB,GAAqB,IAArB,GAA0BA,EAA1B,GAA6B,WAA/C,CAAA;SAFJ,CAAA,CAAA;EAIAH,MAAAA,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAwCsJ,CAAAA,SAAxC,GAAoDyB,cAApD,CAAA;QAGAZ,OAAO,CAAC,eAAD,EAAkBlL,KAAK,CAACoJ,SAAN,CAAgB6C,WAAlC,CAAP,CAAA;QAGAtL,WAAW,CAAC,cAAD,EAAiB,CAAC,CAAD,EAAI,EAAJ,CAAjB,CAAX,CAAA;QAGAuL,OAAO,CAAC,cAAD,EAAiBlM,KAAK,CAACoJ,SAAN,CAAgB+C,WAAjC,CAAP,CAAA;QAGAjB,OAAO,CAAC,eAAD,EAAkBlL,KAAK,CAACoJ,SAAN,CAAgBgD,WAAlC,CAAP,CAAA;EAGAtL,MAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAiCU,CAAAA,KAAjC,GAAyCsD,IAAI,CAACC,SAAL,CAAe/E,KAAf,CAAzC,CAAA;QAGAiL,OAAO,CAAC,YAAD,EAAelL,KAAK,CAACoJ,SAAN,CAAgBiD,QAA/B,CAAP,CAAA;EAQAZ,MAAAA,SAAS,CAACa,IAAV,EAAA,CAAA;OAnLG;MAuLPC,SAAS,EAAE,SAACpL,SAAAA,CAAAA,CAAD,EAAO;EAEdA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEA,MAAA,IAAI8K,GAAG,GAAG1L,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAV,CAAA;EACAyL,MAAAA,GAAG,CAACrH,OAAJ,CAAYsH,MAAZ,GAAqB,MAArB,CAAA;QACAD,GAAG,CAACrH,OAAJ,CAAYuH,KAAZ,GAAoBvL,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwBuH,KAA5C,CAAA;EACAC,MAAAA,UAAU,CAAC,YAAA;UAAA,OAAMhE,aAAa,CAAC6D,GAAD,CAAnB,CAAA;SAAD,EAA2B,EAA3B,CAAV,CAAA;QAEA5B,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAA,CAAA;OAhMG;MAmMPxB,mBAAmB,EAAE,SAAClI,mBAAAA,CAAAA,CAAD,EAAO;QAExB+J,OAAO,CAAC,qBAAD,EAAwBlL,KAAK,CAACoJ,SAAN,CAAgBwD,iBAAxC,CAAP,CAAA;QACAjM,WAAW,CAAC,gBAAD,EAAmB,CAAC,CAAD,EAAI,EAAJ,CAAnB,CAAX,CAAA;QACAA,WAAW,CAAC,YAAD,EAAe,CAAC,CAAD,EAAI,EAAJ,CAAf,CAAX,CAAA;QACAA,WAAW,CAAC,YAAD,EAAe,CAAC,CAAD,EAAI,EAAJ,CAAf,CAAX,CAAA;OAxMG;MA2MPkM,WAAW,EAAE,SAAC1L,WAAAA,CAAAA,CAAD,EAAO;EAEhBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;QAEA,IAAIoL,CAAC,GAAGC,OAAO,CAACvC,EAAE,CAAC,sBAAD,CAAH,CAAf,CAAA;;EACA,MAAA,IAAGsC,CAAH,EAAK;EACD3L,QAAAA,CAAC,CAAC6I,aAAF,CAAgBgD,UAAhB,CAA2BA,UAA3B,CAAsCnJ,MAAtC,EAAA,CAAA;EAEF,OAAA;;QAEF+G,OAAO,CAACC,GAAR,CAAY,aAAZ,CAAA,CAAA;OArNG;MAwNP+B,iBAAiB,EAAE,SAACzL,iBAAAA,CAAAA,CAAD,EAAO;QAEtB,IAAI2L,CAAC,GAAGC,OAAO,CAAEvC,EAAE,CAAC,aAAD,CAAJ,CAAf,CAAA;QAEA,IAAG,CAACsC,CAAJ,EAAO,OAAA;QAEP,IAAIjN,EAAE,GAAGsB,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwBtF,EAAjC,CAAA;EAEA+K,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAA,GAAWhL,EAAvB,CAAA,CAAA;EAEA,MAAA,IAAGiB,QAAQ,CAACC,aAAT,CAAuB,kBAAqBlB,GAAAA,EAArB,GAA0B,IAAjD,CAAH,EAA2DiB,QAAQ,CAACC,aAAT,CAAuB,kBAAA,GAAqBlB,EAArB,GAA0B,IAAjD,EAAuDgE,MAAvD,EAAA,CAAA;EAC3D,MAAA,IAAG/C,QAAQ,CAACC,aAAT,CAAuB,yBAAyBlB,EAAhD,CAAH,EAAwDiB,QAAQ,CAACC,aAAT,CAAuB,sBAAyBlB,GAAAA,EAAhD,EAAoDgE,MAApD,EAAA,CAAA;EACxD,MAAA,IAAG/C,QAAQ,CAACC,aAAT,CAAuB,sBAAyBlB,GAAAA,EAAzB,GAA8B,IAArD,CAAH,EAA+DiB,QAAQ,CAACC,aAAT,CAAuB,sBAAA,GAAyBlB,EAAzB,GAA8B,IAArD,EAA2DgE,MAA3D,EAAA,CAAA;OApO5D;MAwOPoJ,gBAAgB,EAAE,SAAC9L,gBAAAA,CAAAA,CAAD,EAAO;EAErByJ,MAAAA,OAAO,CAACC,GAAR,CAAY1J,CAAC,CAAC6I,aAAF,CAAgBvI,KAA5B,CAAA,CAAA;EAEA,MAAA,IAAI5B,EAAE,GAAGsB,CAAC,CAAC6I,aAAF,CAAgBS,aAAhB,CAA8BA,aAA9B,CAA4C5K,EAA5C,CAA+CgC,OAA/C,CAAuD,OAAvD,EAAgE,EAAhE,CAAT,CAAA;EAEAf,MAAAA,QAAQ,CAACC,aAAT,CAAuB,sBAAA,GAAyBlB,EAAzB,GAA8B,YAArD,CAAmEwK,CAAAA,SAAnE,GAA+ElJ,CAAC,CAAC6I,aAAF,CAAgBvI,KAA/F,CAAA;OA9OG;MAiPP0J,WAAW,EAAE,SAAChK,WAAAA,CAAAA,CAAD,EAAO;EAEhBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAGAiL,MAAAA,UAAU,CAAC,YAAM;UAEb,IAAItK,IAAI,GAAG,EAAX,CAAA;EAEAA,QAAAA,IAAI,CAAC,cAAD,CAAJ,GAAuB,EAAvB,CAAA;;EAJa,QAAA,IAAA,UAAA,GAAA,0BAAA,CAOEvB,QAAQ,CAACE,gBAAT,CAA0B,qBAA1B,CAPF,CAAA;EAAA,YAAA,MAAA,CAAA;;EAAA,QAAA,IAAA;YAOb,KAAgE,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,YAAA,IAAxDmJ,GAAwD,GAAA,MAAA,CAAA,KAAA,CAAA;cAE5D,IAAItB,GAAG,GAAG,EAAV,CAAA;EAEAA,YAAAA,GAAG,CAAC,IAAD,CAAH,GAAYsB,GAAG,CAACtK,EAAJ,CAAOgC,OAAP,CAAe,OAAf,EAAuB,EAAvB,CAAZ,CAAA;cACAgH,GAAG,CAAC,QAAD,CAAH,GAAgBsB,GAAG,CAAChF,OAAJ,CAAY7C,MAA5B,CAAA;cACAuG,GAAG,CAAC,MAAD,CAAH,GAAcsB,GAAG,CAAChF,OAAJ,CAAYrB,IAA1B,CAAA;cACA+E,GAAG,CAAC,QAAD,CAAH,GAAgBA,GAAG,CAAC,MAAD,CAAH,IAAe,KAAf,GAAuB9D,IAAI,CAACG,KAAL,CAAWpD,QAAQ,CAACqI,GAAG,CAAChF,OAAJ,CAAYF,MAAb,CAAnB,CAAvB,GAAkE,EAAlF,CAAA;cACA4D,GAAG,CAAC,OAAD,CAAH,GAAesB,GAAG,CAACpJ,aAAJ,CAAkB,cAAlB,CAAA,CAAkCU,KAAjD,CAAA;cACAoH,GAAG,CAAC,WAAD,CAAH,GAAmBsB,GAAG,CAACpJ,aAAJ,CAAkB,kBAAlB,CAAA,CAAsCU,KAAzD,CAAA;EACAoH,YAAAA,GAAG,CAAC,SAAD,CAAH,GAAiBxI,UAAU,CAAC8J,GAAG,CAACpJ,aAAJ,CAAkB,gBAAlB,CAAA,CAAoCU,KAArC,CAA3B,CAAA;EACAoH,YAAAA,GAAG,CAAC,KAAD,CAAH,GAAaxI,UAAU,CAAC8J,GAAG,CAACpJ,aAAJ,CAAkB,YAAlB,CAAA,CAAgCU,KAAjC,CAAvB,CAAA;EACAoH,YAAAA,GAAG,CAAC,KAAD,CAAH,GAAaxI,UAAU,CAAC8J,GAAG,CAACpJ,aAAJ,CAAkB,YAAlB,CAAA,CAAgCU,KAAjC,CAAvB,CAAA;EAEAY,YAAAA,IAAI,CAAC,cAAD,CAAJ,CAAqB6K,IAArB,CAA0BrE,GAA1B,CAAA,CAAA;EACH,WAAA;EAtBY,SAAA,CAAA,OAAA,GAAA,EAAA;EAAA,UAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,SAAA,SAAA;EAAA,UAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,SAAA;;EAwBbxG,QAAAA,IAAI,CAAC,WAAD,CAAJ,GAAoB0C,IAAI,CAACG,KAAL,CAAWpE,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAA,CAAiCU,KAA5C,CAApB,CAAA;UACAY,IAAI,CAAC,YAAD,CAAJ,GAAqBvB,QAAQ,CAACC,aAAT,CAAuB,aAAvB,CAAA,CAAsCU,KAA3D,CAAA;EACAY,QAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkBvB,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAA,CAAmCU,KAAnC,CAAyC+B,IAAzC,EAAlB,CAAA;EACAnB,QAAAA,IAAI,CAAC,eAAD,CAAJ,GAAwBvB,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCU,KAAzC,CAA+C+B,IAA/C,EAAxB,CAAA;EACAnB,QAAAA,IAAI,CAAC,eAAD,CAAJ,GAAwBvB,QAAQ,CAACC,aAAT,CAAuB,gBAAvB,CAAA,CAAyCU,KAAzC,CAA+C+B,IAA/C,EAAxB,CAAA;EACAnB,QAAAA,IAAI,CAAC,gBAAD,CAAJ,GAAyBvB,QAAQ,CAACC,aAAT,CAAuB,iBAAvB,CAAA,CAA0CU,KAA1C,CAAgD+B,IAAhD,EAAzB,CAAA;EACAnB,QAAAA,IAAI,CAAC,WAAD,CAAJ,GAAoBvB,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAqC6I,CAAAA,OAArC,GAA+C,CAA/C,GAAmD,CAAvE,CAAA;UACAvH,IAAI,CAAC,QAAD,CAAJ,GAAiBvB,QAAQ,CAACC,aAAT,CAAuB,SAAvB,CAAA,CAAkCU,KAAnD,CAAA;EACAY,QAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgB,EAAhB,CAAA;EAIAvB,QAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAA,CAAiCU,KAAjC,CAAuC+B,IAAvC,EAA8CL,CAAAA,KAA9C,CAAoD,IAApD,CAAA,CAA0DyF,OAA1D,CAAkE,UAAA3H,EAAE,EAAI;EAEpEoB,UAAAA,IAAI,CAAC,OAAD,CAAJ,CAAc6K,IAAd,CAAmB;EAACrN,YAAAA,EAAE,EAAEoB,EAAAA;aAAxB,CAAA,CAAA;WAFJ,CAAA,CAAA;UAMA2J,OAAO,CAACC,GAAR,CAAYxI,IAAZ,CAAA,CAAA;UAEA,IAAIxC,EAAE,GAAGN,YAAY,EAArB,CAAA;UACA,IAAI4N,GAAG,GAAG/F,OAAO,EAAjB,CAAA;UAKAC,KAAK,CAAC,8BAAD,EAAiC;EAClCC,UAAAA,MAAM,EAAE,MAD0B;EAElCC,UAAAA,OAAO,EAAEA,OAFyB;EAGlCC,UAAAA,IAAI,EAAEzC,IAAI,CAACC,SAAL,CAAe;EACjByC,YAAAA,KAAK,EAAE;EACHX,cAAAA,OAAO,EAAE;EACLhD,gBAAAA,IAAI,EAAQ,QADP;EAELgE,gBAAAA,GAAG,EAAS,mBAFP;EAGLjI,gBAAAA,EAAE,EAAUA,EAHP;EAILsN,gBAAAA,GAAG,EAASA,GAJP;EAKL9K,gBAAAA,IAAI,EAAQA,IAAAA;EALP,eAAA;EADN,aAAA;aADL,CAAA;EAH4B,SAAjC,CAAL,CAeC4F,IAfD,CAeM,UAAAC,QAAQ,EAAA;YAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,SAfd,CAgBCF,CAAAA,IAhBD,CAgBM,UAAAC,QAAQ,EAAI;YAEd,IAAIA,QAAQ,CAACG,OAAb,EAAqB;EAKjBrI,YAAAA,KAAK,CAACoN,YAAN,EAAA,CAAA;EAEH,WAPD,MAOK;cAED9E,aAAa,CAACJ,QAAD,CAAb,CAAA;EACH,WAAA;WA5BL,CAAA,CAAA,OAAA,CAAA,CA8BO,UAAAQ,KAAK,EAAI;YAAEJ,aAAa,CAACI,KAAD,CAAb,CAAA;WA9BlB,CAAA,CAAA;SAlDM,EAkFP,IAlFO,CAAV,CAAA;OAtPG;MA2UP2E,SAAS,EAAE,SAAClM,SAAAA,CAAAA,CAAD,EAAO;EAEdA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEAiH,MAAAA,aAAa,CAAC7H,QAAQ,CAACC,aAAT,CAAuB,OAAQI,GAAAA,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwBuH,KAAvD,CAAD,CAAb,CAAA;OA/UG;MAkVPY,YAAY,EAAE,SAACnM,YAAAA,CAAAA,CAAD,EAAO;EAEjBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEA,MAAA,IAAI6L,KAAK,GAAGpM,CAAC,CAAC6I,aAAd,CAAA;;QAEA,IAAIuD,KAAK,CAACC,KAAN,IAAeD,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAnB,EAAmC;EAG/B,QAAA,IAAGD,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAA,CAAe1J,IAAf,IAAuB,YAAvB,IAAuCyJ,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAA,CAAe1J,IAAf,IAAuB,WAA9D,IAA6EyJ,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAA,CAAe1J,IAAf,IAAuB,WAAvG,EAAmH;EAE/G2J,UAAAA,KAAK,CAAEjD,EAAE,CAAC,qCAAD,CAAJ,CAAL,CAAA;EACA,UAAA,OAAA;EACH,SAAA;;UAGD,IAAG+C,KAAK,CAACC,KAAN,CAAY,CAAZ,CAAeE,CAAAA,IAAf,GAAsB,OAAzB,EAAiC;EAE7BD,UAAAA,KAAK,CAAEjD,EAAE,CAAC,8CAAD,CAAJ,CAAL,CAAA;EACA,UAAA,OAAA;EACH,SAAA;;EAED,QAAA,IAAIkC,KAAK,GAAGa,KAAK,CAACpI,OAAN,CAAcuH,KAA1B,CAAA;EACA,QAAA,IAAIiB,MAAM,GAAG,IAAIC,UAAJ,EAAb,CAAA;;EACAD,QAAAA,MAAM,CAACE,MAAP,GAAgB,UAAS1M,CAAT,EAAY;EAExBL,UAAAA,QAAQ,CAACC,aAAT,CAAuB,UAAA,GAAW2L,KAAlC,CAAyCpJ,CAAAA,YAAzC,CAAsD,KAAtD,EAA6DnC,CAAC,CAAC6I,aAAF,CAAgBI,MAA7E,CAAA,CAAA;WAFJ,CAAA;;UAIAuD,MAAM,CAACG,aAAP,CAAqBP,KAAK,CAACC,KAAN,CAAY,CAAZ,CAArB,CAAA,CAAA;EAEArM,QAAAA,CAAC,CAAC6I,aAAF,CAAgBS,aAAhB,CAA8B1J,aAA9B,CAA4C,SAA5C,CAAuD2J,CAAAA,SAAvD,CAAiE7G,MAAjE,CAAwE,IAAxE,CAAA,CAAA;EACH,OAAA;OAjXE;MAoXPkK,WAAW,EAAE,SAAC5M,WAAAA,CAAAA,CAAD,EAAO;QAEhB,IAAIuL,KAAK,GAAGvL,CAAC,CAAC6I,aAAF,CAAgBS,aAAhB,CAA8BtF,OAA9B,CAAsCuH,KAAlD,CAAA;QACA5L,QAAQ,CAACC,aAAT,CAAuB,OAAA,GAAU2L,KAAjC,CAAwCjL,CAAAA,KAAxC,GAAgD,EAAhD,CAAA;QACAX,QAAQ,CAACC,aAAT,CAAuB,UAAW2L,GAAAA,KAAlC,EAAyCpJ,YAAzC,CAAsD,KAAtD,EAA6D,mDAA7D,CAAA,CAAA;EACAnC,MAAAA,CAAC,CAAC6I,aAAF,CAAgBU,SAAhB,CAA0BC,GAA1B,CAA8B,IAA9B,CAAA,CAAA;OAzXG;MA4XPqD,UAAU,EAAE,SAAC7M,UAAAA,CAAAA,CAAD,EAAO;QAEfnB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,GAA0BpB,CAAC,CAAC6I,aAAF,CAAgBnK,EAA1C,CAAA;;EAIA,MAAA,IAAGsB,CAAC,CAAC6I,aAAF,CAAgBnK,EAAhB,IAAsB,SAAzB,EAAmC;UAAEiB,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+B2B,KAA/B,CAAqCuL,MAArC,GAA8C,IAA9C,CAAA;EAAqD,OAA1F,MAA8F;UAAEnN,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+B2B,KAA/B,CAAqCuL,MAArC,GAA8C,GAA9C,CAAA;EAAoD,OAAA;;EAEpJnN,MAAAA,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAuCoE,CAAAA,OAAvC,CAA+C5C,IAA/C,GAAsDpB,CAAC,CAAC6I,aAAF,CAAgBnK,EAAtE,CAAA;OApYG;MAuYPuL,eAAe,EAAE,SAACjK,eAAAA,CAAAA,CAAD,EAAO;QAEpByJ,OAAO,CAACC,GAAR,CAAY,6BAAZ,CAAA,CAAA;;EACA7K,MAAAA,KAAK,CAACoJ,SAAN,CAAgB8E,mBAAhB,CAAoC/M,CAApC,CAAA,CAAA;OA1YG;MA6YPgN,eAAe,EAAE,SAAChN,eAAAA,CAAAA,CAAD,EAAO;EAAA,MAAA,IAAA,UAAA,GAAA,0BAAA,CAENL,QAAQ,CAACE,gBAAT,CAA0B,aAA1B,CAFM,CAAA;EAAA,UAAA,MAAA,CAAA;;EAAA,MAAA,IAAA;UAEpB,KAAuD,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAA/CC,EAA+C,GAAA,MAAA,CAAA,KAAA,CAAA;YACnDE,CAAC,CAAC6I,aAAF,CAAgBJ,OAAhB,GAA0B3I,EAAE,CAACyJ,SAAH,CAAa7G,MAAb,CAAoB,QAApB,CAA1B,GAA0D5C,EAAE,CAACyJ,SAAH,CAAaC,GAAb,CAAiB,QAAjB,CAA1D,CAAA;EACAxJ,UAAAA,CAAC,CAAC6I,aAAF,CAAgBvI,KAAhB,GAAwBN,CAAC,CAAC6I,aAAF,CAAgBJ,OAAhB,GAA0B,GAA1B,GAAgC,GAAxD,CAAA;EACH,SAAA;EALmB,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;OA7YjB;MAqZPyC,QAAQ,EAAE,SAAClL,QAAAA,CAAAA,CAAD,EAAO;QAEb,IAAI0H,GAAG,GAAG,EAAV,CAAA;QAEAA,GAAG,CAAChJ,EAAJ,GAASiB,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAA,CAAoCU,KAA7C,CAAA;QACAoH,GAAG,CAACuF,KAAJ,GAAYtN,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAA,CAAuCU,KAAnD,CAAA;EAA0DX,MAAAA,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAuCU,CAAAA,KAAvC,GAA+C,EAA/C,CAAA;QAC1DoH,GAAG,CAACkD,MAAJ,GAAajL,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAA,CAAwCU,KAArD,CAAA;QACAoH,GAAG,CAAC5I,KAAJ,GAAYa,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAA,CAAuCU,KAAnD,CAAA;QACAoH,GAAG,CAACwF,IAAJ,GAAWvN,QAAQ,CAACC,aAAT,CAAuB,aAAvB,CAAA,CAAsCU,KAAjD,CAAA;QACAoH,GAAG,CAAA,QAAA,CAAH,GAAa,IAAb,CAAA;EAEA,MAAA,IAAGA,GAAG,CAACuF,KAAJ,CAAUhL,MAAV,GAAmB,CAAnB,IAAwByF,GAAG,CAAC5I,KAAJ,CAAUmD,MAAV,GAAmB,CAA9C,EAAiD,OAAO,KAAP,CAAA;QAIjD,IAAIkL,MAAM,GAAGxN,QAAQ,CAACC,aAAT,CAAuB,QAAvB,EAAiCU,KAA9C,CAAA;;EAIA,MAAA,IAAG6M,MAAH,EAAU;EAAEA,QAAAA,MAAM,GAAGvJ,IAAI,CAACG,KAAL,CAAWoJ,MAAX,CAAT,CAAA;EAA8B,OAA1C,MAA8C;EAAEA,QAAAA,MAAM,GAAG,EAAT,CAAA;EAAc,OAAA;;EAC9D,MAAA,IAAGvD,KAAK,CAACC,OAAN,CAAcsD,MAAd,CAAH,EAAyB;UAAEA,MAAM,CAACpB,IAAP,CAAYrE,GAAZ,CAAA,CAAA;EAAmB,OAA9C,MAAkD;EAAEyF,QAAAA,MAAM,GAAG,EAAT,CAAA;EAAc,OAAA;;EAClExN,MAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAiCU,CAAAA,KAAjC,GAAyCsD,IAAI,CAACC,SAAL,CAAesJ,MAAf,CAAzC,CAAA;;QAEA,IAAGxN,QAAQ,CAACC,aAAT,CAAuB,qCAAA,GAAsC8H,GAAG,CAACkD,MAA1C,GAAiD,eAAxE,CAAH,EAA4F;UACxFjL,QAAQ,CAACC,aAAT,CAAuB,qCAAsC8H,GAAAA,GAAG,CAACkD,MAA1C,GAAiD,eAAxE,CAAA,CAAyFjJ,kBAAzF,CAA4G,UAA5G,EAAwH9C,KAAK,CAACgM,gBAAN,CAAuBnD,GAAvB,EAA4ByF,MAAM,CAAClL,MAAP,GAAc,CAA1C,CAAxH,CAAA,CAAA;EACH,OAFD,MAEK;UACDtC,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAuC+B,kBAAvC,CAA0D,WAA1D,EAAuE9C,KAAK,CAACgM,gBAAN,CAAuBnD,GAAvB,EAA4ByF,MAAM,CAAClL,MAAP,GAAc,CAA1C,CAAvE,CAAA,CAAA;EACH,OAAA;;QAGD8H,OAAO,CAAC,eAAD,EAAkBlL,KAAK,CAACoJ,SAAN,CAAgB6C,WAAlC,CAAP,CAAA;QAGAtL,WAAW,CAAC,cAAD,EAAiB,CAAC,CAAD,EAAI,EAAJ,CAAjB,CAAX,CAAA;QAGAuL,OAAO,CAAC,cAAD,EAAiBlM,KAAK,CAACoJ,SAAN,CAAgB+C,WAAjC,CAAP,CAAA;QAIAjB,OAAO,CAAC,eAAD,EAAkBlL,KAAK,CAACoJ,SAAN,CAAgBgD,WAAlC,CAAP,CAAA;OA7bG;MAgcPH,WAAW,EAAE,SAAC9K,WAAAA,CAAAA,CAAD,EAAO;EAEhBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;QAEA,IAAIoL,CAAC,GAAGC,OAAO,CAAEvC,EAAE,CAAC,qBAAD,CAAJ,CAAf,CAAA;QAEA,IAAG,CAACsC,CAAJ,EAAO,OAAA;EAEP,MAAA,IAAIyB,IAAI,GAAGpN,CAAC,CAAC6I,aAAF,CAAgBS,aAAhB,CAA8BA,aAA9B,CAA4CtF,OAA5C,CAAoDoJ,IAA/D,CAAA;EAEA,MAAA,IAAID,MAAM,GAAGvJ,IAAI,CAACG,KAAL,CAAWpE,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAA,CAAiCU,KAA5C,CAAb,CAAA;EAEA6M,MAAAA,MAAM,GAAGA,MAAM,CAACE,MAAP,CAAc,UAAC3F,GAAD,EAAS;EAAE,QAAA,OAAOlH,QAAM,CAACkH,GAAG,CAAChJ,EAAJ,GAAOgJ,GAAG,CAACuF,KAAX,GAAiBvF,GAAG,CAACkD,MAAtB,CAAN,IAAuCwC,IAA9C,CAAA;EAAoD,OAA7E,CAAT,CAAA;EAEAzN,MAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAiCU,CAAAA,KAAjC,GAAyCsD,IAAI,CAACC,SAAL,CAAesJ,MAAf,CAAzC,CAAA;EAEAnN,MAAAA,CAAC,CAAC6I,aAAF,CAAgBS,aAAhB,CAA8BA,aAA9B,CAA4C5G,MAA5C,EAAA,CAAA;OAhdG;MAodPsI,WAAW,EAAE,SAAChL,WAAAA,CAAAA,CAAD,EAAO;EAEhBA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAIA,MAAA,IAAI6M,IAAI,GAAIpN,CAAC,CAAC6I,aAAF,CAAgBS,aAAhB,CAA8BA,aAA9B,CAA4CA,aAA5C,CAA0DtF,OAA1D,CAAkEoJ,IAA9E,CAAA;QAEA,IAAG,CAACA,IAAJ,EAAU,OAAA;EAEV,MAAA,IAAID,MAAM,GAAGvJ,IAAI,CAACG,KAAL,CAAWpE,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAA,CAAiCU,KAA5C,CAAb,CAAA;EAEA6M,MAAAA,MAAM,CAAC1F,OAAP,CAAe,UAACC,GAAD,EAAMvE,CAAN,EAAY;EAAE,QAAA,IAAG3C,QAAM,CAACkH,GAAG,CAAChJ,EAAJ,GAAOgJ,GAAG,CAACuF,KAAX,GAAiBvF,GAAG,CAACkD,MAAtB,CAAN,IAAuCwC,IAA1C,EAA+C;YAAED,MAAM,CAAChK,CAAD,CAAN,CAAUrE,KAAV,GAAkBkB,CAAC,CAAC6I,aAAF,CAAgBvI,KAAlC,CAAA;EAA0C,SAAA;SAAxH,CAAA,CAAA;EAIAmJ,MAAAA,OAAO,CAACC,GAAR,CAAY1J,CAAC,CAAC6I,aAAF,CAAgBvI,KAA5B,CAAA,CAAA;EAIAX,MAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAiCU,CAAAA,KAAjC,GAAyCsD,IAAI,CAACC,SAAL,CAAesJ,MAAf,CAAzC,CAAA;OAxeG;MA6ePlC,WAAW,EAAE,SAACjL,WAAAA,CAAAA,CAAD,EAAO;EAGhB,MAAA,IAAIoN,IAAI,GAAIpN,CAAC,CAAC6I,aAAF,CAAgBS,aAAhB,CAA8BA,aAA9B,CAA4CtF,OAA5C,CAAoDoJ,IAAhE,CAAA;EAEA,MAAA,IAAID,MAAM,GAAGvJ,IAAI,CAACG,KAAL,CAAWpE,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAA,CAAiCU,KAA5C,CAAb,CAAA;EAEA6M,MAAAA,MAAM,CAAC1F,OAAP,CAAe,UAACC,GAAD,EAAMvE,CAAN,EAAY;EAAE,QAAA,IAAG3C,QAAM,CAACkH,GAAG,CAAChJ,EAAJ,GAAOgJ,GAAG,CAACuF,KAAX,GAAiBvF,GAAG,CAACkD,MAAtB,CAAN,IAAuCwC,IAA1C,EAA+C;EAAED,UAAAA,MAAM,CAAChK,CAAD,CAAN,CAAA,QAAA,CAAA,GAAmBnD,CAAC,CAAC6I,aAAF,CAAgBJ,OAAhB,GAA0B,IAA1B,GAAiC,KAApD,CAAA;EAA4D,SAAA;SAA1I,CAAA,CAAA;EAQA9I,MAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAiCU,CAAAA,KAAjC,GAAyCsD,IAAI,CAACC,SAAL,CAAesJ,MAAf,CAAzC,CAAA;OA5fG;EAggBPJ,IAAAA,mBAAmB,EAAE,IAAA;KA5zBf;IA+zBVO,YAAY,EAAE,SAAC3K,YAAAA,CAAAA,IAAD,EAAU;MAEpB,IAAI4K,cAAc,GAAG,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,GAAb,EAAiB,GAAjB,EAAqB,GAArB,EAAyB,GAAzB,EAA6B,GAA7B,EAAiC,GAAjC,EAAqC,GAArC,EAAyC,GAAzC,EAA6C,GAA7C,EAAiD,GAAjD,EAAqD,GAArD,EAAyD,GAAzD,EAA6D,GAA7D,EAAiE,GAAjE,EAAqE,GAArE,EAAyE,GAAzE,EAA6E,GAA7E,EAAiF,GAAjF,EAAqF,GAArF,EAAyF,GAAzF,EAA6F,GAA7F,EAAiG,GAAjG,EAAqG,GAArG,CAArB,CAAA;MACA,IAAIC,eAAe,GAAG,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,GAAb,EAAiB,GAAjB,EAAqB,GAArB,EAAyB,GAAzB,EAA6B,GAA7B,EAAiC,GAAjC,EAAqC,GAArC,EAAyC,GAAzC,CAAtB,CAAA;;EAHoB,IAAA,IAAA,UAAA,GAAA,0BAAA,CAOH7N,QAAQ,CAACE,gBAAT,CAA0B,wDAA1B,CAPG,CAAA;EAAA,QAAA,MAAA,CAAA;;EAAA,IAAA,IAAA;EAAA,MAAA,IAAA,KAAA,GAAA,SAAA,KAAA,GAAA;EAAA,QAAA,IAOZ4N,KAPY,GAAA,MAAA,CAAA,KAAA,CAAA;EAOmFF,QAAAA,cAAc,GAAGA,cAAc,CAACF,MAAf,CAAsB,UAASvN,EAAT,EAAa;EAAE,UAAA,OAAOA,EAAE,KAAK2N,KAAK,CAACnN,KAApB,CAAA;EAA2B,SAAhE,CAAjB,CAAA;EAPnF,OAAA,CAAA;;QAOpB,KAAqG,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,QAAA,KAAA,EAAA,CAAA;EAAsF,OAAA;EAPvK,KAAA,CAAA,OAAA,GAAA,EAAA;EAAA,MAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,KAAA,SAAA;EAAA,MAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,KAAA;;EAAA,IAAA,IAAA,UAAA,GAAA,0BAAA,CAQHX,QAAQ,CAACE,gBAAT,CAA0B,mDAA1B,CARG,CAAA;EAAA,QAAA,MAAA,CAAA;;EAAA,IAAA,IAAA;EAAA,MAAA,IAAA,MAAA,GAAA,SAAA,MAAA,GAAA;EAAA,QAAA,IAQZ4N,KARY,GAAA,MAAA,CAAA,KAAA,CAAA;EAQ8ED,QAAAA,eAAe,GAAGA,eAAe,CAACH,MAAhB,CAAuB,UAASvN,EAAT,EAAa;EAAE,UAAA,OAAOA,EAAE,KAAK2N,KAAK,CAACnN,KAApB,CAAA;EAA2B,SAAjE,CAAlB,CAAA;EAR9E,OAAA,CAAA;;QAQpB,KAAgG,UAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,MAAA,GAAA,UAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,QAAA,MAAA,EAAA,CAAA;EAAwF,OAAA;EARpK,KAAA,CAAA,OAAA,GAAA,EAAA;EAAA,MAAA,UAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,KAAA,SAAA;EAAA,MAAA,UAAA,CAAA,CAAA,EAAA,CAAA;EAAA,KAAA;;MAUpB,OAAkBqC,IAAI,IAAI,UAAR,GAAqB4K,cAArB,GAAsCC,eAAxD,CAAA;KAz0BM;IA20BV5F,cAAc,EAAE,SAACF,cAAAA,CAAAA,GAAD,EAAS;MAGrB,IAAIgG,QAAQ,GAAG7O,KAAK,CAACyO,YAAN,CAAmB5F,GAAG,CAAC/E,IAAvB,CAAf,CAAA;;MAGA,IAAIgL,OAAO,GAAG,EAAd,CAAA;EAAkBD,IAAAA,QAAQ,CAACjG,OAAT,CAAiB,UAAC3H,EAAD,EAAQ;QAAE6N,OAAO,IAAI,oBAAoB7N,EAApB,GAAyB,IAAzB,IAA+B4H,GAAG,CAAC+F,KAAJ,IAAW3N,EAAX,GAAgB,UAAhB,GAA2B,EAA1D,CAAA,GAA8D,GAA9D,GAAoEA,EAApE,GAAyE,WAApF,CAAA;OAA3B,CAAA,CAAA;MAElB,OACyB4H,mCAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAAChJ,EAD7B,EAAA,6DAAA,CAAA,CAAA,MAAA,CAC2FgJ,GAAG,CAAC/E,IAD/F,8BACuH+E,GAAG,CAACvG,MAD3H,EACqJX,mBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,QAAM,CAACoD,IAAI,CAACC,SAAL,CAAe6D,GAAG,CAAC5D,MAAJ,GAAa4D,GAAG,CAAC5D,MAAjB,GAA0B,EAAzC,CAAD,CAD3J,EAGwG4D,oKAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAAC/E,IAH5G,EAAA,yEAAA,CAAA,CAAA,MAAA,CAIuBgL,OAJvB,EAMwCtE,sFAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,OAAD,CAN1C,iNAS6G3B,GAAG,CAAC/E,IATjH,EAUoD+E,uGAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAACkG,SAAJ,IAAe,aAAf,IAAgC,CAAClG,GAAG,CAACkG,SAArC,GAAiD,UAAjD,GAA4D,EAVhH,EAUyH5M,GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,cAAD,CAV/H,kFAWoD0G,GAAG,CAACkG,SAAJ,IAAe,aAAf,GAA+B,UAA/B,GAA0C,EAX9F,EAWuG5M,GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,aAAD,CAX7G,gFAYkD0G,GAAG,CAACkG,SAAJ,IAAe,WAAf,GAA6B,UAA7B,GAAwC,EAZ1F,EAYmG5M,GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,WAAD,CAZzG,+EAaiD0G,GAAG,CAACkG,SAAJ,IAAe,UAAf,GAA4B,UAA5B,GAAuC,EAbxF,EAaiG5M,GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,UAAD,CAbvG,2EAc6C0G,GAAG,CAACkG,SAAJ,IAAe,MAAf,GAAwB,UAAxB,GAAmC,EAdhF,EAcyF5M,GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,MAAD,CAd/F,4EAe8C0G,GAAG,CAACkG,SAAJ,IAAe,OAAf,GAAyB,UAAzB,GAAoC,EAflF,EAe2F5M,GAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAAM,CAAC,OAAD,CAfjG,0GAiBwCqI,EAAE,CAAC,gBAAD,CAjB1C,EAAA,8LAAA,CAAA,CAAA,MAAA,CAoBsGA,EAAE,CAAC,GAAD,CApBxG,EAoB2H3B,aAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,WApB9H,EAqBwC2B,8DAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,eAAD,CArB1C,qMAwBkGA,EAAE,CAAC,GAAD,CAxBpG,EAAA,aAAA,CAAA,CAAA,MAAA,CAwBuH3B,GAAG,CAACmG,GAxB3H,yEAyBwCxE,EAAE,CAAC,WAAD,CAzB1C,EAAA,0LAAA,CAAA,CAAA,MAAA,CA4BkGA,EAAE,CAAC,MAAD,CA5BpG,EA4B0H3B,aAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAACoG,GA5B9H,EAAA,8DAAA,CAAA,CAAA,MAAA,CA6BwCzE,EAAE,CAAC,WAAD,CA7B1C,EAgCyJ3B,4RAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAAChJ,EAhC7J,EAAA,meAAA,CAAA,CAAA;KAn1BM;IA23BV0I,WAAW,EAAE,SAACzB,WAAAA,CAAAA,OAAD,EAAa;MAItB,IAAIP,CAAC,GAAGzF,QAAR,CAAA;MACA,IAAIjB,EAAE,GAAGN,YAAY,EAArB,CAAA;MACA,IAAI4N,GAAG,GAAG/F,OAAO,EAAjB,CAAA;MACA,IAAI8H,CAAC,GAAG,EAAR,CAAA;;MACA,KAAI,IAAI5K,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgBA,CAAC,EAAjB,EAAoB;QAElB,IAAI6K,GAAG,GAAG,mDAAV,CAAA;EACAD,MAAAA,CAAC,kKAE0B5K,CAF1B,EAAA,kGAAA,CAAA,CAAA,MAAA,CAGoCA,CAHpC,EAAA,wBAAA,CAAA,CAAA,MAAA,CAG4DA,CAH5D,EAGuE6K,WAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAHvE,EAOwC3E,0TAAAA,CAAAA,CAAAA,MAAAA,CAAAA,EAAE,CAAC,QAAD,CAP1C,uMAYwElG,CAZxE,EAAA,kCAAA,CAAA,CAAA,MAAA,CAY0GA,CAZ1G,EAAD,8BAAA,CAAA,CAAA;EAcD,KAAA;;EAEDiC,IAAAA,CAAC,CAACxF,aAAF,CAAgB,UAAhB,CAA4BsJ,CAAAA,SAA5B,GAAwC6E,CAAxC,CAAA;MAGAhE,OAAO,CAAC,cAAD,EAAiBlL,KAAK,CAACoJ,SAAN,CAAgBiE,SAAjC,CAAP,CAAA;MAGAnC,OAAO,CAAC,kBAAD,EAAqBlL,KAAK,CAACoJ,SAAN,CAAgB2E,WAArC,CAAP,CAAA;MAGA1C,QAAQ,CAAC,sBAAD,EAAyBrL,KAAK,CAACoJ,SAAN,CAAgBkE,YAAzC,CAAR,CAAA;MAGApC,OAAO,CAAC,qBAAD,EAAwBlL,KAAK,CAACoJ,SAAN,CAAgB4E,UAAxC,CAAP,CAAA;MAGA9C,OAAO,CAAC,sBAAD,EAAyBlL,KAAK,CAACoJ,SAAN,CAAgBmC,cAAzC,CAAP,CAAA;MAGAhF,CAAC,CAACxF,aAAF,CAAgB,MAAhB,CAAA,CAAwBG,gBAAxB,CAAyC,WAAzC,EAAsD,UAAUC,CAAV,EAAa;EAE/DA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEA1B,MAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBC,SAAnB,GAA+B,IAA/B,CAAA;;EAGA,MAAA,IAAGjH,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA3B,IAAwCvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBoI,YAA9D,EAA2E;UAAEpP,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlC,GAAnB,GAAyB,IAAID,GAAJ,CAAQ;EAAEI,UAAAA,MAAM,EAAE;cAAEvB,CAAC,EAAEvC,CAAC,CAACkO,OAAP;cAAgB1L,CAAC,EAAExC,CAAC,CAACmO,OAArB;EAA8B3J,YAAAA,MAAM,EAAE,EAAtC;EAA0CH,YAAAA,UAAU,EAAE,EAAtD;EAA0DC,YAAAA,QAAQ,EAAE,GAAA;aAA9E;EAAqFlD,UAAAA,IAAI,EAAE,SAAA;EAA3F,SAAR,CAAzB,CAAA;EAAyIvC,QAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,GAA0B,KAA1B,CAAA;EAAiC,QAAA,OAAA;EAAS,OAAA;;QAEhQ,IAAG9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA9B,EAAwC;UAAEvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,GAA8B,IAAI7G,QAAJ,CAAa;EAAEE,UAAAA,MAAM,EAAE,CAAC;cAACoB,CAAC,EAAEvC,CAAC,CAACkO,OAAN;cAAe1L,CAAC,EAAExC,CAAC,CAACmO,OAAAA;EAApB,WAAD,CAAV;EAA2C/M,UAAAA,IAAI,EAAE,SAAA;EAAjD,SAAb,CAA9B,CAAA;EAA0GvC,QAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,GAA0B,UAA1B,CAAA;EAAuC,OAAA;;EAE3L,MAAA,IAAG9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA3B,IAAwCvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,IAA2B,UAAtE,EAAiF;UAAE9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,GAA8B,IAAI7G,QAAJ,CAAa;EAAEE,UAAAA,MAAM,EAAE,CAAC;cAACoB,CAAC,EAAEvC,CAAC,CAACkO,OAAN;cAAe1L,CAAC,EAAExC,CAAC,CAACmO,OAAAA;EAApB,WAAD,CAAV;EAA2C/M,UAAAA,IAAI,EAAE,SAAjD;YAA4D1C,EAAE,EAAEG,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAxF;EAA4F4D,UAAAA,IAAI,EAAEzD,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBvD,IAAAA;EAArH,SAAb,CAA9B,CAAA;EAAyKzD,QAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,GAA0B,UAA1B,CAAA;EAAuC,OAAA;;EAEnS,MAAA,IAAG9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA3B,IAAwCvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,IAA2B,KAAtE,EAA4E;UAAE9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlC,GAAnB,GAAyB,IAAID,GAAJ,CAAQ;EAAEI,UAAAA,MAAM,EAAE;cAAEvB,CAAC,EAAEvC,CAAC,CAACkO,OAAP;cAAgB1L,CAAC,EAAExC,CAAC,CAACmO,OAArB;EAA8B3J,YAAAA,MAAM,EAAE,EAAtC;EAA0CH,YAAAA,UAAU,EAAE,EAAtD;EAA0DC,YAAAA,QAAQ,EAAE,GAAA;aAA9E;EAAqFlD,UAAAA,IAAI,EAAE,SAA3F;YAAsG1C,EAAE,EAAEG,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAlI;EAAsI4D,UAAAA,IAAI,EAAEzD,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBvD,IAAAA;EAA/J,SAAR,CAAzB,CAAA;EAAyMzD,QAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,GAA0B,KAA1B,CAAA;EAAkC,OAAA;OAb7T,CAAA,CAAA;MAoBAyC,CAAC,CAACxF,aAAF,CAAgB,MAAhB,CAAA,CAAwBG,gBAAxB,CAAyC,WAAzC,EAAsD,UAAUC,CAAV,EAAa;EAE/DA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEA,MAAA,IAAG1B,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,IAA+BjJ,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA1D,IAAuEvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,IAA2B,UAArG,EAAiH9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,CAA4BrF,SAA5B,CAAsC;EAAEtB,QAAAA,MAAM,EAAE,CAAC;YAACoB,CAAC,EAAEvC,CAAC,CAACkO,OAAN;YAAe1L,CAAC,EAAExC,CAAC,CAACmO,OAAAA;EAApB,SAAD,CAAV;EAA2C/M,QAAAA,IAAI,EAAE,SAAA;SAAvF,CAAA,CAAA;EAEjH,MAAA,IAAGvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,IAA+BjJ,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA1D,IAAuEvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,IAA2B,UAArG,EAAiH9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,CAA4BrF,SAA5B,CAAsC;EAAEtB,QAAAA,MAAM,EAAE,CAAC;YAACoB,CAAC,EAAEvC,CAAC,CAACkO,OAAN;YAAe1L,CAAC,EAAExC,CAAC,CAACmO,OAAAA;EAApB,SAAD,CAAV;EAA2C/M,QAAAA,IAAI,EAAE,SAAA;SAAvF,CAAA,CAAA;;QAEjH,IAAGvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlC,GAAnB,IAA0B9E,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAArD,IAAkEvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,IAA2B,KAAhG,EAAsG;UAAE9D,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlC,GAAnB,GAAyB,IAAID,GAAJ,CAAQ;EAAEI,UAAAA,MAAM,EAAE;cAAEvB,CAAC,EAAEvC,CAAC,CAACkO,OAAP;cAAgB1L,CAAC,EAAExC,CAAC,CAACmO,OAArB;EAA8B3J,YAAAA,MAAM,EAAE,EAAtC;EAA0CH,YAAAA,UAAU,EAAE,EAAtD;EAA0DC,YAAAA,QAAQ,EAAE,GAAA;aAA9E;EAAqFlD,UAAAA,IAAI,EAAE,SAA3F;YAAsG1C,EAAE,EAAEG,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAlI;EAAsI4D,UAAAA,IAAI,EAAEzD,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBvD,IAAAA;EAA/J,SAAR,CAAzB,CAAA;EAAyMzD,QAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,GAA0B,KAA1B,CAAA;EAAkC,OAAA;OARvV,CAAA,CAAA;MAaAyC,CAAC,CAACxF,aAAF,CAAgB,MAAhB,CAAA,CAAwBG,gBAAxB,CAAyC,SAAzC,EAAoD,UAAUC,CAAV,EAAa;EAE7DA,MAAAA,CAAC,CAACO,cAAF,EAAA,CAAA;EAEA1B,MAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBC,SAAnB,GAA+B,KAA/B,CAAA;;EAEA,MAAA,IAAGjH,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,IAA+BjJ,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA7D,EAAuE;UAEnEvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,CAA4BC,YAA5B,CAAyC;EAAE5G,UAAAA,MAAM,EAAE,CAAC;cAACoB,CAAC,EAAEvC,CAAC,CAACkO,OAAN;cAAe1L,CAAC,EAAExC,CAAC,CAACmO,OAAAA;EAApB,WAAD,CAAV;EAA2C/M,UAAAA,IAAI,EAAE,SAAA;WAA1F,CAAA,CAAA;EACH,OAAA;;EAED,MAAA,IAAG,CAACvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,IAA+BjJ,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlC,GAAnD,MAA4D9E,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA3B,IAAwCvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA/H,CAAH,EAA6I;EACzIvC,QAAAA,KAAK,CAACmJ,aAAN,EAAA,CAAA;EACH,OAAA;;EAEDnJ,MAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,GAA8B,IAA9B,CAAA;EACAjJ,MAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlC,GAAnB,GAAyB,IAAzB,CAAA;;EAGA,MAAA,IAAGhE,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAH,EAAA;EAAA,QAAA,IAAA,WAAA,GAAA,0BAAA,CAAuDD,QAAQ,CAACE,gBAAT,CAA0B,WAA1B,CAAvD,CAAA;EAAA,YAAA,OAAA,CAAA;;EAAA,QAAA,IAAA;YAAwC,KAAuD,WAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,OAAA,GAAA,WAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,YAAA,IAA9CC,EAA8C,GAAA,OAAA,CAAA,KAAA,CAAA;;EAE3FA,YAAAA,EAAE,CAACsO,WAAH,GAAiB,UAACpO,CAAD,EAAO;EAEpB,cAAA,IAAGnB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBC,SAAtB,EAAiC,OAAA;EAEjCjH,cAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBvD,IAAnB,GAA0BtC,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwB1B,IAAlD,CAAA;EACAzD,cAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAxB,GAA6BsB,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwBtF,EAAxB,CAA2BgC,OAA3B,CAAmC,OAAnC,EAA2C,EAA3C,CAA+CA,CAAAA,OAA/C,CAAuD,KAAvD,EAA6D,EAA7D,CAA7B,CAAA;EACA7B,cAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBlD,IAAnB,GAA0B3C,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwBrB,IAAlD,CAAA;eANJ,CAAA;;EASA7C,YAAAA,EAAE,CAACuO,YAAH,GAAkB,UAACrO,CAAD,EAAO;EAErB,cAAA,IAAGnB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBC,SAAtB,EAAiC,OAAA;EAEjCjH,cAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBvD,IAAnB,GAA0B,IAA1B,CAAA;eAJJ,CAAA;EAMH,WAAA;EAjBD,SAAA,CAAA,OAAA,GAAA,EAAA;EAAA,UAAA,WAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,SAAA,SAAA;EAAA,UAAA,WAAA,CAAA,CAAA,EAAA,CAAA;EAAA,SAAA;EAAA,OAAA;;EAoBA,MAAA,IAAG3C,QAAQ,CAACC,aAAT,CAAuB,eAAvB,CAAH,EAAA;EAAA,QAAA,IAAA,WAAA,GAAA,0BAAA,CAA2DD,QAAQ,CAACE,gBAAT,CAA0B,eAA1B,CAA3D,CAAA;EAAA,YAAA,OAAA,CAAA;;EAAA,QAAA,IAAA;YAA4C,KAA2D,WAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,OAAA,GAAA,WAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,YAAA,IAAlDC,GAAkD,GAAA,OAAA,CAAA,KAAA,CAAA;;EAEnGA,YAAAA,GAAE,CAACsO,WAAH,GAAiB,UAACpO,CAAD,EAAO;EAEpB,cAAA,IAAGnB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBC,SAAtB,EAAiC,OAAA;EAEjCjH,cAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAxB,GAA6BsB,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwBtF,EAArD,CAAA;eAJJ,CAAA;EAMH,WAAA;EARD,SAAA,CAAA,OAAA,GAAA,EAAA;EAAA,UAAA,WAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,SAAA,SAAA;EAAA,UAAA,WAAA,CAAA,CAAA,EAAA,CAAA;EAAA,SAAA;EAAA,OAAA;;EAWA,MAAA,IAAGiB,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAH,EAAA;EAAA,QAAA,IAAA,WAAA,GAAA,0BAAA,CAAuDD,QAAQ,CAACE,gBAAT,CAA0B,WAA1B,CAAvD,CAAA;EAAA,YAAA,OAAA,CAAA;;EAAA,QAAA,IAAA;YAAwC,KAAuD,WAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,OAAA,GAAA,WAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,YAAA,IAA9CC,IAA8C,GAAA,OAAA,CAAA,KAAA,CAAA;;EAE3FA,YAAAA,IAAE,CAACsO,WAAH,GAAiB,UAACpO,CAAD,EAAO;EAEpB,cAAA,IAAGnB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBC,SAAtB,EAAiC,OAAA;EAGjCjH,cAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAxB,GAA6BsB,CAAC,CAAC6I,aAAF,CAAgB7E,OAAhB,CAAwBtF,EAArD,CAAA;eALJ,CAAA;EAOH,WAAA;EATD,SAAA,CAAA,OAAA,GAAA,EAAA;EAAA,UAAA,WAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,SAAA,SAAA;EAAA,UAAA,WAAA,CAAA,CAAA,EAAA,CAAA;EAAA,SAAA;EAAA,OAAA;OAlDJ,CAAA,CAAA;;MA8DAiB,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+BwO,WAA/B,GAA6C,UAACpO,CAAD,EAAO;EAEhDnB,MAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmByI,KAAnB,GAA2B,IAA3B,CAAA;OAFJ,CAAA;;MAKA3O,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+ByO,YAA/B,GAA8C,UAACrO,CAAD,EAAO;EAEjDnB,MAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmByI,KAAnB,GAA2B,KAA3B,CAAA;OAFJ,CAAA;;EAMA,IAAA,IAAIC,QAAQ,GAAG,SAAXA,QAAW,CAACvO,CAAD,EAAO;EAKlB,MAAA,IAAGA,CAAC,CAACE,KAAF,IAAW,EAAX,IAAiBrB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA/C,EAAyD;EAAGvC,QAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBoI,YAAnB,GAAkC,IAAlC,CAAA;UAAwCxE,OAAO,CAACC,GAAR,CAAY,YAAZ,CAAA,CAAA;EAA2B8B,QAAAA,UAAU,CAAC,YAAM;EAAE3M,UAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBoI,YAAnB,GAAkC,KAAlC,CAAA;WAAT,EAAoD,IAApD,CAAV,CAAA;EAAsE,OAAA;;EAGrM,MAAA,IAAG,CAACjO,CAAC,CAACE,KAAF,IAAW,CAAX,IAAgBF,CAAC,CAACE,KAAF,IAAW,EAA5B,KAAmCrB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA9D,IAA2EvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAjG,EAA0G;UAAE2B,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAA,CAAA;EAAyB/J,QAAAA,QAAQ,CAACC,aAAT,CAAuB,kBAAqBf,GAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBiC,QAAnB,CAA4B0G,KAA5B,EAArB,GAA2D,IAAlF,EAAwF9L,MAAxF,EAAA,CAAA;EAAmG,OAAA;;QAExO,IAAG1C,CAAC,CAACE,KAAF,IAAW,CAAX,IAAgBrB,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBzE,IAAnB,IAA2B,SAA3C,IAAwD,CAACvC,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmByI,KAA/E,EAAsF,OAAA;EAGtF,MAAA,IAAG3O,QAAQ,CAACC,aAAT,CAAuB,qBAAqBf,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAA7C,GAAkD,IAAzE,CAAH,EAAmFiB,QAAQ,CAACC,aAAT,CAAuB,kBAAqBf,GAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAA7C,GAAkD,IAAzE,EAA+EgE,MAA/E,EAAA,CAAA;EACnF,MAAA,IAAG/C,QAAQ,CAACC,aAAT,CAAuB,sBAAyBf,GAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAxE,CAAH,EAAgFiB,QAAQ,CAACC,aAAT,CAAuB,sBAAA,GAAyBf,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAxE,EAA4EgE,MAA5E,EAAA,CAAA;EAChF,MAAA,IAAG/C,QAAQ,CAACC,aAAT,CAAuB,yBAAyBf,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAjD,GAAsD,IAA7E,CAAH,EAAuFiB,QAAQ,CAACC,aAAT,CAAuB,sBAAyBf,GAAAA,KAAK,CAACO,KAAN,CAAYyG,MAAZ,CAAmBE,IAAnB,CAAwBrH,EAAjD,GAAsD,IAA7E,EAAmFgE,MAAnF,EAAA,CAAA;OAf3F,CAAA;;EAiBA/C,IAAAA,QAAQ,CAAC8O,mBAAT,CAA6B,SAA7B,EAAwCF,QAAxC,EAAkD,IAAlD,CAAA,CAAA;EACA5O,IAAAA,QAAQ,CAACI,gBAAT,CAA0B,SAA1B,EAAqCwO,QAArC,EAA+C,IAA/C,CAAA,CAAA;;MAGA,KAAI,IAAIG,EAAE,GAAC,CAAX,EAAcA,EAAE,GAAC,CAAjB,EAAoBA,EAAE,EAAtB,EAAyB;QAGrB,IAAIC,SAAS,GAAGtJ,GAAG,GAAC,IAAJ,GAAS2G,GAAT,GAAa,UAAb,GAAwBtN,EAAxB,GAA2B,GAA3B,IAAgCkQ,QAAQ,CAACF,EAAD,CAAR,GAAa,CAA7C,CAAA,GAAgD,gBAAhD,GAAiE/I,OAAO,CAACkJ,OAAzF,CAAA;EACArD,MAAAA,UAAU,CAAC,UAASwC,GAAT,EAAcvO,GAAd,EAAmBqP,GAAnB,EAAuB;UAE9B,IAAIC,KAAK,GAAG,IAAZ,CAAA;;EACA,QAAA,IAAG,OAAOpJ,OAAO,CAACqI,GAAf,KAAsB,WAAzB,EAAqC;YAAE,IAAG,CAACrI,OAAO,CAACqI,GAAR,CAAYc,GAAZ,CAAJ,EAAsBC,KAAK,GAAG,KAAR,CAAA;EAAgB,SAAA;;EAC7E,QAAA,IAAGA,KAAH,EAAS;EAEL,UAAA,IAAI5L,EAAC,GAAG,IAAI6L,KAAJ,EAAR,CAAA;;YACA7L,EAAC,CAACuJ,MAAF,GAAW,YAAU;cAEjBtH,CAAC,CAACxF,aAAF,CAAgBH,GAAG,GAACqP,GAApB,CAAA,CAAyB3M,YAAzB,CAAsC,KAAtC,EAA6C6L,GAA7C,CAAA,CAAA;EACA5I,YAAAA,CAAC,CAACxF,aAAF,CAAgBH,GAAG,GAACqP,GAApB,CAAyBxF,CAAAA,aAAzB,CAAuC1J,aAAvC,CAAqD,SAArD,CAAA,CAAgE2J,SAAhE,CAA0E7G,MAA1E,CAAiF,IAAjF,CAAA,CAAA;aAHJ,CAAA;;YAKAS,EAAC,CAAC8L,GAAF,GAAMjB,GAAN,CAAA;EACH,SAAA;SAbK,EAcP,GAdO,EAcFW,SAdE,EAcS,gBAdT,EAc2BD,EAd3B,CAAV,CAAA;EAeH,KAAA;KA1jCK;EA6jCV1G,EAAAA,aAAa,EAAE,SAAM,aAAA,GAAA;MAIjB,IAAIkH,UAAU,GAAG,EAAjB,CAAA;;EAKA,IAAA,IAAGvP,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAH,EAAA;EAAA,MAAA,IAAA,WAAA,GAAA,0BAAA,CAAmDD,QAAQ,CAACE,gBAAT,CAA0B,QAA1B,CAAnD,CAAA;EAAA,UAAA,OAAA,CAAA;;EAAA,MAAA,IAAA;UAAqC,KAAkD,WAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,OAAA,GAAA,WAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,UAAA,IAA1CC,EAA0C,GAAA,OAAA,CAAA,KAAA,CAAA;EAEnF,UAAA,IAAIpB,EAAE,GAAGoB,EAAE,CAACkE,OAAH,CAAWtF,EAApB;gBAAwBgJ,GAAG,GAAG,EAA9B;EAAA,cAAkCnF,CAAC,GAAnC,KAAA,CAAA;EAAA,cAAqCC,CAAC,GAAtC,KAAA,CAAA,CAAA;EACA,UAAA,IAAIiL,KAAK,GAAG9N,QAAQ,CAACC,aAAT,CAAuB,QAAA,GAASlB,EAAT,GAAY,eAAnC,CAAA,GAAsDiB,QAAQ,CAACC,aAAT,CAAuB,QAAA,GAASlB,EAAT,GAAY,eAAnC,CAAA,CAAoD4B,KAA1G,GAAkHzB,KAAK,CAACyO,YAAN,CAAmBxN,EAAE,CAACkE,OAAH,CAAWrB,IAA9B,CAAA,CAAoC,CAApC,CAA9H,CAAA;;EAIA,UAAA,QAAO7C,EAAE,CAACkE,OAAH,CAAWrB,IAAlB;EAEI,YAAA,KAAK,UAAL;EACI+E,cAAAA,GAAG,GAAG;EAAEhJ,gBAAAA,EAAE,EAACA,EAAL;EAAS+O,gBAAAA,KAAK,EAACA,KAAf;EAAsB,gBAAA,SAAA,EAAQ,CAA9B;EAAiCI,gBAAAA,GAAG,EAAC,CAArC;EAAwCC,gBAAAA,GAAG,EAAC,CAA5C;EAA+CnL,gBAAAA,IAAI,EAAC7C,EAAE,CAACkE,OAAH,CAAWrB,IAA/D;EAAqEmB,gBAAAA,MAAM,EAAC,EAA5E;kBAAgF3C,MAAM,EAACrB,EAAE,CAACF,aAAH,CAAiB,UAAjB,CAAA,CAA6BkC,YAA7B,CAA0C,QAA1C,CAAA;iBAA7F,CAAA;gBAEA,IAAIX,MAAM,GAAGuG,GAAG,CAACvG,MAAJ,CAAWa,KAAX,CAAiB,GAAjB,CAAb,CAAA;EACAO,cAAAA,CAAC,GAAG,CAACrD,UAAU,CAACiC,MAAM,CAAC,CAAD,CAAP,CAAV,GAAwBjC,UAAU,CAACiC,MAAM,CAAC,CAAD,CAAP,CAAnC,IAAkD,CAAtD,CAAA;EACAqB,cAAAA,CAAC,GAAG,CAACtD,UAAU,CAACiC,MAAM,CAAC,CAAD,CAAP,CAAV,GAAwBjC,UAAU,CAACiC,MAAM,CAAC,CAAD,CAAP,CAAnC,IAAkD,CAAtD,CAAA;EAEA+N,cAAAA,UAAU,yFAC2C3M,CAD3C,EAAA,SAAA,CAAA,CAAA,MAAA,CACwDC,CADxD,EAAA,kBAAA,CAAA,CAAA,MAAA,CAC4EkF,GAAG,CAAChJ,EADhF,EAEcgJ,iDAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAAC+F,KAFlB,EAAA,KAAA,CAAA,CAAA,MAAA,CAE8B/F,GAAG,CAAC+F,KAFlC,EAAV,4DAAA,CAAA,CAAA;EAMA,cAAA,MAAA;;EACJ,YAAA,KAAK,KAAL;EACI/F,cAAAA,GAAG,GAAG;EAAEhJ,gBAAAA,EAAE,EAACA,EAAL;EAAS+O,gBAAAA,KAAK,EAACA,KAAf;EAAsB,gBAAA,SAAA,EAAQ,CAA9B;EAAiCI,gBAAAA,GAAG,EAAC,CAArC;EAAwCC,gBAAAA,GAAG,EAAC,CAA5C;EAA+CnL,gBAAAA,IAAI,EAAC7C,EAAE,CAACkE,OAAH,CAAWrB,IAA/D;EAAqEmB,gBAAAA,MAAM,EAACF,IAAI,CAACG,KAAL,CAAWpD,QAAQ,CAACb,EAAE,CAACkE,OAAH,CAAWF,MAAZ,CAAnB,CAA5E;kBAAqH3C,MAAM,EAACrB,EAAE,CAACF,aAAH,CAAiB,MAAjB,CAAA,CAAyBkC,YAAzB,CAAsC,GAAtC,CAAA;iBAAlI,CAAA;gBAEA,IAAIqC,MAAM,GAAGuD,GAAG,CAAC5D,MAAJ,CAAWO,UAAX,GAAyB,CAACqD,GAAG,CAAC5D,MAAJ,CAAWQ,QAAX,GAAsBoD,GAAG,CAAC5D,MAAJ,CAAWO,UAAlC,IAAgD,CAAtF,CAAA;EAKA9B,cAAAA,CAAC,GAAGmF,GAAG,CAAC5D,MAAJ,CAAWvB,CAAX,GAAemF,GAAG,CAAC5D,MAAJ,CAAWU,MAAX,GAAoB,CAAnC,GAA0CkD,GAAG,CAAC5D,MAAJ,CAAWU,MAAX,GAAkB,CAAnB,GAAwBxF,IAAI,CAACyF,GAAL,CAAS7D,QAAQ,CAACuD,MAAD,CAAjB,CAAjE,GAAgG,CAApG,CAAA;EACA3B,cAAAA,CAAC,GAAGkF,GAAG,CAAC5D,MAAJ,CAAWtB,CAAX,GAAekF,GAAG,CAAC5D,MAAJ,CAAWU,MAAX,GAAoB,CAAnC,GAA0CkD,GAAG,CAAC5D,MAAJ,CAAWU,MAAX,GAAkB,CAAnB,GAAwBxF,IAAI,CAAC0F,GAAL,CAAS9D,QAAQ,CAACuD,MAAD,CAAjB,CAAjE,GAAgG,CAApG,CAAA;EAKA+K,cAAAA,UAAU,0FAC4C3M,CAD5C,EAAA,SAAA,CAAA,CAAA,MAAA,CACyDC,CADzD,EAAA,kBAAA,CAAA,CAAA,MAAA,CAC6EkF,GAAG,CAAChJ,EADjF,EAEcgJ,iDAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAAC+F,KAFlB,EAAA,KAAA,CAAA,CAAA,MAAA,CAE8B/F,GAAG,CAAC+F,KAFlC,EAAV,gEAAA,CAAA,CAAA;EAMA,cAAA,MAAA;EApCR,WAAA;;EAwCA,UAAA,IAAI9F,IAAI,GAAG9I,KAAK,CAAC+I,cAAN,CAAqBF,GAArB,CAAX,CAAA;;YAEA,IAAG,CAAC/H,QAAQ,CAACC,aAAT,CAAuB,QAASlB,GAAAA,EAAhC,CAAJ,EAAwC;cAGpCiB,QAAQ,CAACC,aAAT,CAAuB,eAAvB,EAAwC+B,kBAAxC,CAA2D,WAA3D,EAAwEgG,IAAxE,CAAA,CAAA;EACH,WAJD,MAIK;EAGDhI,YAAAA,QAAQ,CAACC,aAAT,CAAuB,QAAA,GAASlB,EAAhC,CAAA,CAAoCyD,YAApC,CAAiD,aAAjD,EAAgEuF,GAAG,CAACvG,MAApE,CAAA,CAAA;cACAxB,QAAQ,CAACC,aAAT,CAAuB,QAAA,GAASlB,EAAhC,CAAoCyD,CAAAA,YAApC,CAAiD,aAAjD,EAAgE3B,QAAM,CAACoD,IAAI,CAACC,SAAL,CAAe6D,GAAG,CAAC5D,MAAnB,CAAD,CAAtE,CAAA,CAAA;EACH,WAAA;;YAEDjF,KAAK,CAACoJ,SAAN,CAAgBC,mBAAhB,EAAA,CAAA;EACH,SAAA;EA7DD,OAAA,CAAA,OAAA,GAAA,EAAA;EAAA,QAAA,WAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,OAAA,SAAA;EAAA,QAAA,WAAA,CAAA,CAAA,EAAA,CAAA;EAAA,OAAA;EAAA,KAAA;;EA+DAvI,IAAAA,QAAQ,CAACC,aAAT,CAAuB,SAAvB,CAAkCsJ,CAAAA,SAAlC,GAA8CgG,UAA9C,CAAA;MAEAhF,QAAQ,CAAC,cAAD,EAAiBrL,KAAK,CAACoJ,SAAN,CAAgB6D,gBAAjC,CAAR,CAAA;KAvoCM;EAyoCVjB,EAAAA,gBAAgB,EAAE,SAAA,gBAAA,CAACnD,GAAD,EAAMvE,CAAN,EAAY;EAE1B,IAAA,OAAA,qCAAA,CAAA,MAAA,CAC2BuE,GAAG,CAACkD,MAAJ,GAAa,WAAb,GAA2B,EADtD,EAAA,mBAAA,CAAA,CAAA,MAAA,CAC4ElD,GAAG,CAACkD,MAAJ,GAAalD,GAAG,CAACkD,MAAjB,GAA0B,EADtG,EAC2HlD,kBAAAA,CAAAA,CAAAA,MAAAA,CAAAA,GAAG,CAACuF,KAD/H,4BACsJzM,QAAM,CAACkH,GAAG,CAAChJ,EAAJ,GAAOgJ,GAAG,CAACuF,KAAX,GAAiBvF,GAAG,CAACkD,MAAtB,CAD5J,EAGwFzH,wJAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAHxF,gBAG+FuE,GAAG,CAAA,QAAA,CAAH,GAAa,SAAb,GAAyB,EAHxH,EAAA,gIAAA,CAAA,CAAA,MAAA,CAOeA,GAAG,CAAChJ,EAPnB,mJAYegJ,GAAG,CAACkD,MAAJ,GAAalD,GAAG,CAACkD,MAAjB,GAA0B,EAZzC,EAAA,wIAAA,CAAA,CAAA,MAAA,CAiBelD,GAAG,CAACuF,KAjBnB,EAsBiJ9J,oSAAAA,CAAAA,CAAAA,MAAAA,CAAAA,CAtBjJ,wBAsBgKuE,GAAG,CAAC5I,KAtBpK,EAuBqCF,mDAAAA,CAAAA,CAAAA,MAAAA,CAAAA,WAAW,CAACC,KAAD,EAAQ6I,GAAG,CAAC5I,KAAZ,CAvBhD,EAAA,gKAAA,CAAA,CAAA,MAAA,CA4Be4I,GAAG,CAACwF,IA5BnB,6QAgCwI/J,CAhCxI,EAAA,6aAAA,CAAA,CAAA;KA3oCM;EAorCV8I,EAAAA,YAAY,EAAE,SAAM,YAAA,GAAA;EAEhB,IAAA,IAAItM,QAAQ,CAACC,aAAT,CAAuB,YAAvB,CAAJ,EAA2CD,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqC8C,MAArC,EAAA,CAAA;MAE3C,IAAIgM,EAAE,GAAG,CAAT,CAAA;;EAJgB,IAAA,IAAA,WAAA,GAAA,0BAAA,CAKG/O,QAAQ,CAACE,gBAAT,CAA0B,aAA1B,CALH,CAAA;EAAA,QAAA,OAAA,CAAA;;EAAA,IAAA,IAAA;QAKhB,KAA6D,WAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAA,OAAA,GAAA,WAAA,CAAA,CAAA,EAAA,EAAA,IAAA,GAAA;EAAA,QAAA,IAApDsP,MAAoD,GAAA,OAAA,CAAA,KAAA,CAAA;EAEzDT,QAAAA,EAAE,IAAI,CAAN,CAAA;UAEA,IAAIhQ,EAAE,GAAGN,YAAY,EAArB,CAAA;UACA,IAAI4N,GAAG,GAAG/F,OAAO,EAAjB,CAAA;EAGA,QAAA,IAAImJ,IAAI,GAAGD,MAAM,CAAC9C,KAAP,CAAa,CAAb,CAAX,CAAA;EACA,QAAA,IAAG,OAAO+C,IAAP,KAAiB,WAApB,EAAiC,SAAA;EAGjC,QAAA,IAAIC,EAAE,GAAG,IAAIC,QAAJ,EAAT,CAAA;UAEA,IAAIC,KAAK,GAAG,8BAAZ,CAAA;EAEAF,QAAAA,EAAE,CAACG,MAAH,CAAU,IAAV,EAAgB9Q,EAAhB,CAAA,CAAA;EACA2Q,QAAAA,EAAE,CAACG,MAAH,CAAU,KAAV,EAAiBxD,GAAjB,CAAA,CAAA;EACAqD,QAAAA,EAAE,CAACG,MAAH,CAAU,KAAV,EAAiB9Q,EAAjB,CAAA,CAAA;EACA2Q,QAAAA,EAAE,CAACG,MAAH,CAAU,KAAV,EAAiB,OAAjB,CAAA,CAAA;EACAH,QAAAA,EAAE,CAACG,MAAH,CAAU,OAAV,EAAmBD,KAAnB,CAAA,CAAA;EACAF,QAAAA,EAAE,CAACG,MAAH,CAAU,MAAV,EAAkBJ,IAAlB,CAAA,CAAA;UACAC,EAAE,CAACG,MAAH,CAAU,MAAV,EAAkB,YAAU9Q,EAAV,GAAa,GAAb,GAAiBgQ,EAAnC,CAAA,CAAA;UACAW,EAAE,CAACG,MAAH,CAAU,OAAV,EAAmB9I,SAAS,CAAC,cAAD,CAA5B,CAAA,CAAA;UAGA0I,IAAI,CAAC9O,KAAL,GAAa,EAAb,CAAA;EAEAzB,QAAAA,KAAK,CAACO,KAAN,CAAYoG,SAAZ,IAAuB,CAAvB,CAAA;UAEAU,KAAK,CAAC,qCAAD,EAAuC;EACxCG,UAAAA,IAAI,EAAEgJ,EADkC;EAExClJ,UAAAA,MAAM,EAAE,MAAA;EAFgC,SAAvC,CAAL,CAICW,IAJD,CAIM,UAAAC,QAAQ,EAAA;YAAA,OAAIA,QAAQ,CAACC,IAAT,EAAJ,CAAA;EAAA,SAJd,CAKCF,CAAAA,IALD,CAKM,UAAAC,QAAQ,EAAI;EAEdlI,UAAAA,KAAK,CAACO,KAAN,CAAYoG,SAAZ,IAAyB,CAAzB,CAAA;;YACA,IAAGuB,QAAQ,CAACG,OAAT,IAAoBrI,KAAK,CAACO,KAAN,CAAYoG,SAAZ,IAAyB,CAAhD,EAAkD;EAE9C8G,YAAAA,KAAK,CAAEjD,EAAE,CAAC,gBAAD,CAAJ,CAAL,CAAA;cAGApC,UAAU,EAAA,CAAA;EACb,WAAA;WAdL,CAAA,CAAA;EAgBH,OAAA;EAnDe,KAAA,CAAA,OAAA,GAAA,EAAA;EAAA,MAAA,WAAA,CAAA,CAAA,CAAA,GAAA,CAAA,CAAA;EAAA,KAAA,SAAA;EAAA,MAAA,WAAA,CAAA,CAAA,EAAA,CAAA;EAAA,KAAA;;EAsDhB,IAAA,IAAGpI,KAAK,CAACO,KAAN,CAAYoG,SAAZ,IAAyB,CAA5B,EAA8B;EAE1B8G,MAAAA,KAAK,CAAEjD,EAAE,CAAC,iBAAD,CAAJ,CAAL,CAAA;QAEApC,UAAU,EAAA,CAAA;EACb,KAAA;EACJ,GAAA;EAhvCS,CAAd,CAAA;;EAmvCApI,KAAK,CAACyG,IAAN,EAAA;;;;;;"}