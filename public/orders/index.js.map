{"version":3,"file":"index.js","sources":["../../node_modules/@kenzap/k-cloud/index.js","../../src/_/_helpers.js","../../src/_/_order_preview.js","../../src/_/_order_print.js","../../src/_/_cnt_orders.js","../../src/orders/index.js"],"sourcesContent":["/**\n * @name initHeader\n * @description Initiates Kenzap Cloud extension header and related scripts. Verifies user sessions, handles SSO, does cloud space navigation, initializes i18n localization. \n * @param {object} response\n */\nexport const initHeader = (response) => {\n\n    // cache header from backend\n    if(response.header) localStorage.setItem('header', response.header);\n  \n    // load header to html if not present\n    if(!document.querySelector(\"#k-script\")){\n  \n        let child = document.createElement('div');\n        child.innerHTML = localStorage.getItem('header');\n        child = child.firstChild;\n        document.body.prepend(child);\n  \n        // run header scripts\n        Function(document.querySelector(\"#k-script\").innerHTML).call('test');\n    }\n  \n    // load locales if present\n    if(response.locale) window.i18n.init(response.locale); \n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nexport const __init = (locale) => {\n\n    if(typeof locale !== 'object' || locale === null) return;\n\n    if(typeof window.i18n === 'undefined') window.i18n = {};\n\n    if(typeof window.i18n.state === 'undefined') window.i18n.state = { locale: {} };\n   \n    window.i18n.state.locale = locale;\n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nexport const __ = (text, ...p) => {\n\n    let match = (input, pa) => {\n\n        pa.forEach((p, i) => { input = input.replace('%'+(i+1)+'$', p); }); \n        \n        return input;\n    }\n\n    if(typeof window.i18n === 'undefined') return match(text, p);\n    if(window.i18n.state.locale.values[text] === undefined) return match(text, p);\n\n\n\n    return match(window.i18n.state.locale.values[text], p);\n}\n\n/*\n * Translates string based on preloaded i18n locale values.\n * \n * @param text {String} text to translate\n * @param cb {Function} callback function to escape text variable\n * @param p {String} list of parameters, to be replaced with %1$, %2$..\n * @returns {String} - text\n */\nconst __esc = (text, cb, ...p) => {\n\n    let match = (input, pa) => {\n\n        pa.forEach((p, i) => { input = input.replace('%'+(i+1)+'$', p); }); \n        \n        return input;\n    }\n\n    if(typeof window.i18n === 'undefined') return match(text, p);\n    if(window.i18n.state.locale.values[text] === undefined) return match(text, p);\n\n    return match(cb(window.i18n.state.locale.values[text]), p);\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const attr = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&apos;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities and does translation\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __attr = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    let cb = (text) => {\n\n        return text.replace(/[<>'\"]/g, tag => (\n            {\n                '&': '&amp;',\n                '<': '&lt;',\n                '>': '&gt;',\n                \"'\": '&apos;',\n                '\"': '&quot;'\n            } [tag]));\n    }\n\n    return __esc(text, cb, ...p);\n}\n\n/*\n * Removes special characters `<`, `>`, `\"`, `'` from the link.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const src = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[<>'\"]/g, tag => (\n        {\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&apos;',\n            '\"': '&quot;'\n        } [tag]));\n    \n}\n\n/*\n * Converts special characters `<`, `>`, `\"`, `'` from the link and does translation\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __src = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    let cb = (text) => {\n\n        return text.replace(/[<>'\"]/g, tag => (\n            {\n                '<': '&lt;',\n                '>': '&gt;',\n                \"'\": '&apos;',\n                '\"': '&quot;'\n            } [tag]));\n    }\n\n    return __esc(text, cb, ...p);\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities.\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const html = (text) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    return text.replace(/[&<>'\"]/g, tag => (\n        {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            \"'\": '&apos;',\n            '\"': '&quot;'\n        } [tag]));\n}\n\n/*\n * Converts special characters `&`, `<`, `>`, `\"`, `'` to HTML entities and does translations\n * \n * @param text {String}  text\n * @returns {String} - text\n */\nexport const __html = (text, ...p) => {\n\n    text = String(text);\n\n    if(text.length === 0){\n\t\treturn '';\n\t}\n\n    let cb = (text) => {\n\n        return text.replace(/[&<>'\"]/g, tag => (\n            {\n                '&': '&amp;',\n                '<': '&lt;',\n                '>': '&gt;',\n                \"'\": '&apos;',\n                '\"': '&quot;'\n            } [tag]));\n    }\n\n    return __esc(text, cb, ...p);\n}\n\n/**\n * @name showLoader\n * @description Initiates full screen three dots loader.\n */\nexport const showLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'block';\n}\n\n/**\n * @name hideLoader\n * @description Removes full screen three dots loader.\n */\nexport const hideLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'none';\n}\n\n/**\n * @name initFooter\n * @description Removes full screen three dots loader.\n * @param {string} left - Text or html code to be present on the left bottom side of screen\n * @param {string} right - Text or html code to be present on the left bottom side of screen\n */\nexport const initFooter = (left, right) => {\n\n    document.querySelector(\"footer .row\").innerHTML = `\n    <div class=\"d-sm-flex justify-content-center justify-content-sm-between\">\n        <span class=\"text-muted text-center text-sm-left d-block d-sm-inline-block\">${left}</span>\n        <span class=\"float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted\">${right}</span>\n    </div>`;\n}\n\n/**\n * @name link\n * @description Handles Cloud navigation links between extensions and its pages. Takes care of custom url parameters.\n * @param {string} slug - Any inbound link\n * \n * @returns {string} link - Returns original link with kenzp cloud space ID identifier.\n */\nexport const link = (slug) => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let sid = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    let postfix = slug.indexOf('?') == -1 ? '?sid='+sid : '&sid='+sid;\n\n    return slug + postfix;\n}\n\n/**\n * @name getSiteId\n * @description Gets current Kenzap Cloud space ID identifier from the URL.\n * \n * @returns {string} id - Kenzap Cloud space ID.\n */\nexport const getSiteId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\n/**\n * @name spaceID\n * @description Gets current Kenzap Cloud space ID identifier from the URL.\n * \n * @returns {string} id - Kenzap Cloud space ID.\n */\n export const spaceID = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\n/**\n * @name setCookie\n * @description Set cookie by its name to all .kenzap.cloud subdomains\n * @param {string} name - Cookie name.\n * @param {string} value - Cookie value.\n * @param {string} days - Number of days when cookie expires.\n */\n export const setCookie = (name, value, days) => {\n\n    let expires = \"\";\n    if (days) {\n        let date = new Date();\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n        expires = \";expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + (escape(value) || \"\") + expires + \";path=/;domain=.kenzap.cloud\"; \n}\n\n/**\n * @name getCookie\n * @description Read cookie by its name.\n * @param {string} cname - Cookie name.\n * \n * @returns {string} value - Cookie value.\n */\nexport const getCookie = (cname) => {\n\n    let name = cname + \"=\";\n    let decodedCookie = decodeURIComponent(document.cookie);\n    let ca = decodedCookie.split(';');\n    for (let i = 0; i < ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n\n/**\n * @name checkHeader\n * @description This function tracks UI updates, creates header version checksum and compares it after every page reload\n * @param {object} object - API response.\n */\n export const checkHeader = () => {\n\n    let version = (localStorage.hasOwnProperty('header') && localStorage.hasOwnProperty('header-version')) ? localStorage.getItem('header-version') : 0;\n    let check = window.location.hostname + '/' + spaceID() + '/' + getCookie('locale');\n    if(check != getCookie('check')){ version = 0; console.log('refresh'); }\n    \n    setCookie('check', check, 5);\n\n    return version\n}\n\n/**\n * @name headers\n * @description Default headers object for all Kenzap Cloud fetch queries. \n * @param {object} headers\n */\n export const headers = {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json',\n    'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n    'Kenzap-Locale': getCookie('locale') ? getCookie('locale') : \"en\",\n    'Kenzap-Header': checkHeader(),\n    'Kenzap-Token': getCookie('kenzap_token'),\n    'Kenzap-Sid': spaceID(),\n}\n\n/**\n * @name parseApiError\n * @description Set default logics for different API Error responses.\n * @param {object} object - API response.\n */\n export const parseApiError = (data) => {\n\n    // outout to frontend console\n    console.log(data);\n\n    // unstructured failure\n    if(isNaN(data.code)){\n    \n        // structure failure data\n        let log = data;\n        try{ log = JSON.stringify(log); }catch(e){ }\n\n        let params = new URLSearchParams();\n        params.append(\"cmd\", \"report\");\n        params.append(\"sid\", spaceID());\n        params.append(\"token\", getCookie('kenzap_token'));\n        params.append(\"data\", log);\n        \n        // report error\n        fetch('https://api-v1.kenzap.cloud/error/', { method: 'post', headers: { 'Accept': 'application/json', 'Content-type': 'application/x-www-form-urlencoded', }, body: params });\n\n        alert('Can not connect to Kenzap Cloud');  \n        return;\n    }\n    \n    // handle cloud error codes\n    switch(data.code){\n\n        // unauthorized\n        case 401:\n\n            // dev mode\n            if(window.location.href.indexOf('localhost')!=-1){ \n\n                alert(data.reason); \n                return; \n            }\n\n            // production mode\n            location.href=\"https://auth.kenzap.com/?app=65432108792785&redirect=\"+window.location.href; break;\n        \n        // something else\n        default:\n\n            alert(data.reason); \n            break;\n    }\n}\n\n/**\n * @name initBreadcrumbs\n * @description Render ui breadcrumbs.\n * @param {array} data - List of link objects containing link text and url. If url is missing then renders breadcrumb as static text. Requires html holder with .bc class.\n */\nexport const initBreadcrumbs = (data) => {\n\n    let html = '<ol class=\"breadcrumb mt-2 mb-0\">';\n    for(let bc of data){\n        \n        if(typeof(bc.link) === 'undefined'){\n\n            html += `<li class=\"breadcrumb-item\">${ bc.text }</li>`;\n        }else{\n\n            html += `<li class=\"breadcrumb-item\"><a href=\"${ bc.link }\">${ bc.text }</a></li>`;\n        }\n    }\n    html += '</ol>';\n    \n    document.querySelector(\".bc\").innerHTML = html;\n}\n\n/**\n * @name onClick\n * @description One row click event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onClick = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\n/**\n * @name onKeyUp\n * @description One row key up event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onKeyUp = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('keyup', fn, true);\n        e.addEventListener('keyup', fn, true);\n    }\n}\n\n/**\n * @name onChange\n * @description One row change event listener declaration. Works with one or many HTML selectors.\n * @param {string} sel - HTML selector, id, class, etc.\n * @param {string} fn - callback function fired on click event.\n */\nexport const onChange = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('change', fn, true);\n        e.addEventListener('change', fn, true);\n    }\n}\n\n/**\n * @name loadScript\n * @description Asynchronous script loader function.\n * @param {string} url - HTML selector, id, class, etc.\n * @param {string} cb - callback function fired immediately after script is loaded.\n */\n export const loadScript = (url, cb) => {\n\n    if (!Array.from(document.querySelectorAll('script')).some(elm => elm.src == url)) {\n      let script = document.createElement('script')\n      script.onload = cb\n      script.src = url\n      document.getElementsByTagName('head')[0].appendChild(script)\n    }\n}\n\n/**\n * @name simulateClick\n * @description Trigger on click event without user interaction.\n * @param {string} elem - HTML selector, id, class, etc.\n */\n export const simulateClick = (elem) => {\n\n\t// create our event (with options)\n\tlet evt = new MouseEvent('click', {\n\t\tbubbles: true,\n\t\tcancelable: true,\n\t\tview: window\n\t});\n\n\t// if cancelled, don't dispatch the event\n\t!elem.dispatchEvent(evt);\n};\n\n/**\n * Create a web friendly URL slug from a string.\n *\n * Requires XRegExp (http://xregexp.com) with unicode add-ons for UTF-8 support.\n *\n * Although supported, transliteration is discouraged because\n *     1) most web browsers support UTF-8 characters in URLs\n *     2) transliteration causes a loss of information\n *\n * @author Sean Murphy <sean@iamseanmurphy.com>\n * @copyright Copyright 2012 Sean Murphy. All rights reserved.\n * @license http://creativecommons.org/publicdomain/zero/1.0/\n *\n * @param string s\n * @param object opt\n * @return string\n */\n export const slugify = (s, opt) => {\n\n\ts = String(s);\n\topt = Object(opt);\n\t\n\tvar defaults = {\n\t\t'delimiter': '-',\n\t\t'limit': undefined,\n\t\t'lowercase': true,\n\t\t'replacements': {},\n\t\t'transliterate': (typeof(XRegExp) === 'undefined') ? true : false\n\t};\n\t\n\t// Merge options\n\tfor (var k in defaults) {\n\t\tif (!opt.hasOwnProperty(k)) {\n\t\t\topt[k] = defaults[k];\n\t\t}\n\t}\n\t\n\tvar char_map = {\n\t\t// Latin\n\t\t'À': 'A', 'Á': 'A', 'Â': 'A', 'Ã': 'A', 'Ä': 'A', 'Å': 'A', 'Æ': 'AE', 'Ç': 'C', \n\t\t'È': 'E', 'É': 'E', 'Ê': 'E', 'Ë': 'E', 'Ì': 'I', 'Í': 'I', 'Î': 'I', 'Ï': 'I', \n\t\t'Ð': 'D', 'Ñ': 'N', 'Ò': 'O', 'Ó': 'O', 'Ô': 'O', 'Õ': 'O', 'Ö': 'O', 'Å': 'O', \n\t\t'Ø': 'O', 'Ù': 'U', 'Ú': 'U', 'Û': 'U', 'Ü': 'U', 'Å°': 'U', 'Ý': 'Y', 'Þ': 'TH', \n\t\t'ß': 'ss', \n\t\t'à': 'a', 'á': 'a', 'â': 'a', 'ã': 'a', 'ä': 'a', 'å': 'a', 'æ': 'ae', 'ç': 'c', \n\t\t'è': 'e', 'é': 'e', 'ê': 'e', 'ë': 'e', 'ì': 'i', 'í': 'i', 'î': 'i', 'ï': 'i', \n\t\t'ð': 'd', 'ñ': 'n', 'ò': 'o', 'ó': 'o', 'ô': 'o', 'õ': 'o', 'ö': 'o', 'Å': 'o', \n\t\t'ø': 'o', 'ù': 'u', 'ú': 'u', 'û': 'u', 'ü': 'u', 'Å±': 'u', 'ý': 'y', 'þ': 'th', \n\t\t'ÿ': 'y',\n\n\t\t// Latin symbols\n\t\t'©': '(c)',\n\n\t\t// Greek\n\t\t'Α': 'A', 'Β': 'B', 'Γ': 'G', 'Δ': 'D', 'Ε': 'E', 'Ζ': 'Z', 'Η': 'H', 'Θ': '8',\n\t\t'Ι': 'I', 'Κ': 'K', 'Λ': 'L', 'Μ': 'M', 'Ν': 'N', 'Ξ': '3', 'Ο': 'O', 'Π': 'P',\n\t\t'Ρ': 'R', 'Σ': 'S', 'Τ': 'T', 'Υ': 'Y', 'Φ': 'F', 'Χ': 'X', 'Ψ': 'PS', 'Ω': 'W',\n\t\t'Î': 'A', 'Î': 'E', 'Î': 'I', 'Î': 'O', 'Î': 'Y', 'Î': 'H', 'Î': 'W', 'Îª': 'I',\n\t\t'Î«': 'Y',\n\t\t'α': 'a', 'β': 'b', 'γ': 'g', 'δ': 'd', 'ε': 'e', 'ζ': 'z', 'η': 'h', 'θ': '8',\n\t\t'ι': 'i', 'κ': 'k', 'λ': 'l', 'μ': 'm', 'ν': 'n', 'ξ': '3', 'ο': 'o', 'π': 'p',\n\t\t'ρ': 'r', 'σ': 's', 'τ': 't', 'υ': 'y', 'φ': 'f', 'χ': 'x', 'ψ': 'ps', 'ω': 'w',\n\t\t'Î¬': 'a', 'Î­': 'e', 'Î¯': 'i', 'Ï': 'o', 'Ï': 'y', 'Î®': 'h', 'Ï': 'w', 'ς': 's',\n\t\t'Ï': 'i', 'Î°': 'y', 'Ï': 'y', 'Î': 'i',\n\n\t\t// Turkish\n\t\t'Å': 'S', 'Ä°': 'I', 'Ç': 'C', 'Ü': 'U', 'Ö': 'O', 'Ä': 'G',\n\t\t'Å': 's', 'Ä±': 'i', 'ç': 'c', 'ü': 'u', 'ö': 'o', 'Ä': 'g', \n\n\t\t// Russian\n\t\t'Ð': 'A', 'Ð': 'B', 'Ð': 'V', 'Ð': 'G', 'Ð': 'D', 'Ð': 'E', 'Ð': 'Yo', 'Ð': 'Zh',\n\t\t'Ð': 'Z', 'Ð': 'I', 'Ð': 'J', 'Ð': 'K', 'Ð': 'L', 'Ð': 'M', 'Ð': 'N', 'Ð': 'O',\n\t\t'Ð': 'P', 'Ð ': 'R', 'Ð¡': 'S', 'Ð¢': 'T', 'Ð£': 'U', 'Ð¤': 'F', 'Ð¥': 'H', 'Ð¦': 'C',\n\t\t'Ð§': 'Ch', 'Ð¨': 'Sh', 'Ð©': 'Sh', 'Ðª': '', 'Ð«': 'Y', 'Ð¬': '', 'Ð­': 'E', 'Ð®': 'Yu',\n\t\t'Ð¯': 'Ya',\n\t\t'Ð°': 'a', 'Ð±': 'b', 'Ð²': 'v', 'Ð³': 'g', 'Ð´': 'd', 'Ðµ': 'e', 'Ñ': 'yo', 'Ð¶': 'zh',\n\t\t'Ð·': 'z', 'Ð¸': 'i', 'Ð¹': 'j', 'Ðº': 'k', 'Ð»': 'l', 'Ð¼': 'm', 'Ð½': 'n', 'Ð¾': 'o',\n\t\t'Ð¿': 'p', 'Ñ': 'r', 'Ñ': 's', 'Ñ': 't', 'Ñ': 'u', 'Ñ': 'f', 'Ñ': 'h', 'Ñ': 'c',\n\t\t'Ñ': 'ch', 'Ñ': 'sh', 'Ñ': 'sh', 'Ñ': '', 'Ñ': 'y', 'Ñ': '', 'Ñ': 'e', 'Ñ': 'yu',\n\t\t'Ñ': 'ya',\n\n\t\t// Ukrainian\n\t\t'Ð': 'Ye', 'Ð': 'I', 'Ð': 'Yi', 'Ò': 'G',\n\t\t'Ñ': 'ye', 'Ñ': 'i', 'Ñ': 'yi', 'Ò': 'g',\n\n\t\t// Czech\n\t\t'Ä': 'C', 'Ä': 'D', 'Ä': 'E', 'Å': 'N', 'Å': 'R', 'Š': 'S', 'Å¤': 'T', 'Å®': 'U', \n\t\t'Å½': 'Z', \n\t\t'Ä': 'c', 'Ä': 'd', 'Ä': 'e', 'Å': 'n', 'Å': 'r', 'š': 's', 'Å¥': 't', 'Å¯': 'u',\n\t\t'Å¾': 'z', \n\n\t\t// Polish\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'e', 'Å': 'L', 'Å': 'N', 'Ó': 'o', 'Å': 'S', 'Å¹': 'Z', \n\t\t'Å»': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Å': 'l', 'Å': 'n', 'ó': 'o', 'Å': 's', 'Åº': 'z',\n\t\t'Å¼': 'z',\n\n\t\t// Latvian\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'E', 'Ä¢': 'G', 'Äª': 'i', 'Ä¶': 'k', 'Ä»': 'L', 'Å': 'N', \n\t\t'Š': 'S', 'Åª': 'u', 'Å½': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Ä£': 'g', 'Ä«': 'i', 'Ä·': 'k', 'Ä¼': 'l', 'Å': 'n',\n\t\t'š': 's', 'Å«': 'u', 'Å¾': 'z'\n\t};\n\t\n\t// Make custom replacements\n\tfor (var k in opt.replacements) {\n\t\ts = s.replace(RegExp(k, 'g'), opt.replacements[k]);\n\t}\n\t\n\t// Transliterate characters to ASCII\n\tif (opt.transliterate) {\n\t\tfor (var k in char_map) {\n\t\t\ts = s.replace(RegExp(k, 'g'), char_map[k]);\n\t\t}\n\t}\n\t\n\t// Replace non-alphanumeric characters with our delimiter\n\tvar alnum = (typeof(XRegExp) === 'undefined') ? RegExp('[^a-z0-9]+', 'ig') : XRegExp('[^\\\\p{L}\\\\p{N}]+', 'ig');\n\ts = s.replace(alnum, opt.delimiter);\n\t\n\t// Remove duplicate delimiters\n\ts = s.replace(RegExp('[' + opt.delimiter + ']{2,}', 'g'), opt.delimiter);\n\t\n\t// Truncate slug to max. characters\n\ts = s.substring(0, opt.limit);\n\t\n\t// Remove delimiter from ends\n\ts = s.replace(RegExp('(^' + opt.delimiter + '|' + opt.delimiter + '$)', 'g'), '');\n\t\n\treturn opt.lowercase ? s.toLowerCase() : s;\n}\n\n/**\n * @name toast\n * @description Triggers toast notification. Adds toast html to the page if missing.\n * @param {string} text - Toast notification.\n */\n export const toast = (text) => {\n\n    // only add once\n    if(!document.querySelector(\".toast\")){\n\n        let html = `\n        <div class=\"position-fixed bottom-0 p-2 m-4 end-0 align-items-center\">\n            <div class=\"toast hide align-items-center text-white bg-dark border-0\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\" data-bs-delay=\"3000\">\n                <div class=\"d-flex\">\n                    <div class=\"toast-body\"></div>\n                    <button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\n                </div>\n            </div>\n        </div>`;\n        if(document.querySelector('body > div')) document.querySelector('body > div').insertAdjacentHTML('afterend', html);\n    }\n\n    let toast = new bootstrap.Toast(document.querySelector('.toast'));\n    document.querySelector('.toast .toast-body').innerHTML = text;  \n    toast.show();\n}","import { getCookie, getSiteId, simulateClick, headers } from '@kenzap/k-cloud';\n\nexport const CDN = \"https://cdn.kenzap.cloud/\";\nexport const API_KEY = \"Qz3fOs8Ghi7rpaW8BOlNgUyo7ANWYoKbRoUa8UkYd2I4FlAgUYFqzPM33IxqoFYa\";\n\nexport const spaceID = () => {\n\n    return \"1002170\"\n}\n\nexport const sortAlphaNum = (a, b) => a['title'].localeCompare(b['title'], 'en', { numeric: true })\n\n/**\n* Generates a random string\n* \n* @param int length_\n* @return string\n*/\nexport const randomString = (length_) => {\n\n    let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz'.split('');\n    if (typeof length_ !== \"number\") {\n        length_ = Math.floor(Math.random() * chars.length_);\n    }\n    let str = '';\n    for (let i = 0; i < length_; i++) {\n        str += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return str;\n}\n\nexport const stringToHash = str => {\n\n    let hash = 0\n    for (let i = 0; i < str.length; ++i)\n        hash = Math.imul(31, hash) + str.charCodeAt(i)\n  \n    hash = 'c'+Math.abs(hash);\n    \n    // console.log(hash);\n\n    return hash;\n}\n\nexport const mt = (val) => {\n\n    return (\"\"+val).length < 2 ? \"0\"+val : val;\n}\n\nexport const getProductId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('id') ? urlParams.get('id') : \"\";\n    return id;\n}\n\nexport const getProductIdFromLink = () => {\n    \n    let url = new URL(window.location.href);\n    let id = url.pathname.trim().split('/').slice(-2)[0];\n    return id;\n}\n\nexport const replaceQueryParam = (param, newval, search) => {\n\n    let regex = new RegExp(\"([?;&])\" + param + \"[^&;]*[;&]?\");\n    let query = search.replace(regex, \"$1\").replace(/&$/, '');\n\n    return (query.length > 2 ? query + \"&\" : \"?\") + (newval ? param + \"=\" + newval : '');\n}\n\nexport const getPageNumberOld = () => {\n\n    let url = window.location.href.split('/');\n    let page = url[url.length-1];\n    let pageN = 1;\n    if(page.indexOf('page')==0){\n      pageN = page.replace('page', '').replace('#', '');\n    }\n    // console.log(pageN);\n    return parseInt(pageN);\n}\n\nexport const getPageNumber = () => {\n\n    let urlParams = new URLSearchParams(window.location.search);\n    let page = urlParams.get('page') ? urlParams.get('page') : 1;\n\n    return parseInt(page);\n}\n\nexport const getPagination = (__, meta, cb) => {\n\n    if(typeof(meta) === 'undefined'){ document.querySelector(\"#listing_info\").innerHTML = __('no records to display'); return; }\n\n    let offset = meta.limit+meta.offset;\n    if(offset>meta.total_records) offset = meta.total_records;\n\n    document.querySelector(\"#listing_info\").innerHTML = __(\"Showing %1$ to %2$ of %3$ entries\", (1+meta.offset), (offset), meta.total_records);\n    //  \"Showing \"+(1+meta.offset)+\" to \"+(offset)+\" of \"+meta.total_records+\" entries\";\n\n    let pbc = Math.ceil(meta.total_records / meta.limit);\n    document.querySelector(\"#listing_paginate\").style.display = (pbc < 2) ? \"none\" : \"block\";\n\n    let page = getPageNumber(); \n    let html = '<ul class=\"pagination d-flex justify-content-end pagination-flat mb-0\">';\n    html += '<li class=\"paginate_button page-item previous\" id=\"listing_previous\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"prev\" data-page=\"0\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&laquo;</span></li>';\n    let i = 0;\n    while(i<pbc){\n\n        i++; \n        if(((i >= page-3) && (i <= page)) || ((i <= page+3) && (i >=page))){\n\n            html += '<li class=\"paginate_button page-item '+((page==i)?'active':'')+'\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"page\" data-page=\"'+i+'\" tabindex=\"0\" class=\"page-link\">'+(page==i?i:i)+'</a></li>';      \n        }\n    }  \n    html += '<li class=\"paginate_button page-item next\" id=\"order-listing_next\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"next\" data-page=\"2\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&raquo;</span></a></li>';\n    html += '</ul>'\n\n    document.querySelector(\"#listing_paginate\").innerHTML = html;\n\n    let page_link = document.querySelectorAll(\".page-link\");\n    for (const l of page_link) {\n        \n        l.addEventListener('click', function(e) {\n\n            let p = parseInt(getPageNumber());\n            let ps = p;\n            switch(l.dataset.type){ \n                case 'prev': p-=1; if(p<1) p = 1; break;\n                case 'page': p=l.dataset.page; break;\n                case 'next': p+=1; if(p>pbc) p = pbc; break;\n            }\n            \n            // update url\n            if (window.history.replaceState) {\n\n                // let url = window.location.href.split('/page');\n                // let urlF = (url[0]+'/page'+p).replace('//page', '/page');\n\n                let str = window.location.search;\n                str = replaceQueryParam('page', p, str);\n                // window.location = window.location.pathname + str\n\n                // prevents browser from storing history with each change:\n                window.history.replaceState(\"kenzap-cloud\", document.title, window.location.pathname + str);\n            }\n\n            // only refresh if page differs\n            if(ps!=p) cb();\n            \n            e.preventDefault();\n            return false;\n        });\n    }\n}\n\nexport const formatStatus = (__, st) => {\n\n    st = parseInt(st); \n    switch(st){ \n      case 0: return '<div class=\"badge bg-warning text-dark fw-light\">' + __('Draft') + '</div>';\n      case 1: return '<div class=\"badge bg-primary fw-light\">' + __('Published') + '</div>';\n      case 3: return '<div class=\"badge bg-secondary fw-light\">' + __('Unpublished') + '</div>';\n      default: return '<div class=\"badge bg-secondary fw-light\">' + __('Drafts') + '</div>';\n    }\n}\n\n/**\n    * Render price\n    * @public\n    */\n export const priceFormat = function(_this, price) {\n\n    price = makeNumber(price);\n\n    price = (Math.round(parseFloat(price) * 100)/100).toFixed(2);\n    \n    switch(_this.state.settings.currency_symb_loc){\n        case 'left': price = _this.state.settings.currency_symb + price; break;\n        case 'right': price = price + _this.state.settings.currency_symb; break;\n        case 'left_space': price = _this.state.settings.currency_symb + ' ' + price; break;\n        case 'right_space': price = price + ' ' + _this.state.settings.currency_symb; break;\n    }\n\n    return price;\n}\n\nexport const makeNumber = function(price) {\n\n    price = price ? price : 0;\n    price = parseFloat(price);\n    price = Math.round(price * 100) / 100;\n    return price;\n}\n\nexport const formatTime = (__, timestamp) => {\n\t\n    const d = new Date(parseInt(timestamp) * 1000);\n    return d.toLocaleDateString();\n\n    let a = new Date(timestamp * 1000);\n    let months = [__('Jan'), __('Feb'), __('Mar'), __('Apr'), __('May'), __('Jun'), __('Jul'), __('Aug'), __('Sep'), __('Oct'), __('Nov'), __('Dec')];\n    let year = a.getFullYear();\n    let month = months[a.getMonth()];\n    let date = a.getDate();\n    let hour = a.getHours();\n    let min = a.getMinutes();\n    let sec = a.getSeconds();\n    let time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\n// numbers only with allowed exceptions\nexport const onlyNumbers = (sel, chars) => {\n\n    if(!document.querySelector(sel)) return;\n\n    for(let el of document.querySelectorAll(sel)){\n    \n        el.addEventListener('keypress', (e) => {\n\n            // console.log(e.which);\n\n            if((!chars.includes(e.which) && isNaN(String.fromCharCode(e.which))) || e.which == 32 || (document.querySelector(sel).value.includes(String.fromCharCode(e.which)) && chars.includes(e.which))){\n\n                // stop character from entering input\n                e.preventDefault(); \n                return false;\n            }\n        });\n    }\n}\n\n// nums only validation\nexport const numsOnly = (e, max) => {\n\n    // Only ASCII charactar in that range allowed \n    var ASCIICode = (e.which) ? e.which : e.keyCode \n    if (ASCIICode > 31 && ASCIICode != 46 && (ASCIICode < 48 || ASCIICode > 57)) \n    return false; \n\n    if(parseFloat(e.target.value)>max) \n    return false; \n\n    let dec = e.target.value.split('.');\n    if(dec.length>1)\n    if(dec[1].length>1)\n        return false;\n    \n    return true; \n}\n\nexport const onClick = (sel, fn) => {\n\n    // console.log('onClick');\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\n// time elapsed since creation \nexport const timeConverterAgo = (__, now, time) => {\n\n    now = parseInt(now);\n    time = parseInt(time);\n\n    // parse as elapsed time\n    let past = now - time;\n    if(past < 60) return __('moments ago');\n    if(past < 3600) return __('%1$ minutes ago', parseInt(past / 60));\n    if(past < 86400) return  __('%1$ hours ago', parseInt(past / 60 / 60));\n\n    // process as normal date\n    var a = new Date(time * 1000);\n    var months = [ __('Jan'), __('Feb'), __('Mar'), __('Apr'), __('May'), __('Jun'), __('Jul'), __('Aug'), __('Sep'), __('Oct'), __('Nov'), __('Dec') ];\n    var year = a.getFullYear();\n    var month = months[a.getMonth()];\n    var date = a.getDate();\n    var hour = a.getHours();\n    var min = a.getMinutes();\n    var sec = a.getSeconds();\n    var time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\nexport const parseVariations = (_this, product) => {\n\n    let html_vars = '';\n    if(typeof(product.variations !== 'undefined'))\n    for(let v in product.variations){\n\n        // variation type\n        let type = '';\t\n        if(product.variations[v].type=='checkbox') type = 'check';\n        if(product.variations[v].type=='radio')    type = 'radio';\n\n        // struct variation\n        html_vars += '\\\n        <b>' + __(product.variations[v].title) + (product.variations[v].required == '1' ? ' <span class=\"tag\">'+__('required')+'</span>':'')+'</b>\\\n        <div class=\"kp-'+type+'\" >';\n\n        // variation labels\n        for(let d in product.variations[v].data){\n\n            let checked = false;\n            // for public qr feed\n            // if(typeof(cart.state.product.variations[v]) !== 'undefined' && typeof(cart.state.product.variations[v].list) !== 'undefined' && typeof(cart.state.product.variations[v].list[\"_\"+d]) !== 'undefined'){ checked = true; }\n            \n            // verify variation price validity\n            product.variations[v].data[d]['price'] = makeNumber(product.variations[v].data[d]['price']);\n\n            switch(type){\n                case 'check':\n\n                html_vars += '\\\n                    <label>\\\n                        <input type=\"checkbox\" data-required=\"'+product.variations[v].required+'\" data-indexv=\"'+v+'\" data-index=\"'+d+'\" data-title=\"'+product.variations[v].data[d]['title']+'\" data-titlev=\"'+__(product.variations[v].title)+'\" data-price=\"'+product.variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+'>\\\n                        <div class=\"checkbox\">\\\n                            <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 20 20\">\\\n                                <path d=\"M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z\"></path>\\\n                                <polyline points=\"4 11 8 15 16 6\"></polyline>\\\n                            </svg>\\\n                        </div>\\\n                        <span>'+__(product.variations[v].data[d]['title'])+'</span>\\\n                        <div class=\"price\">+ '+priceFormat(_this, product.variations[v].data[d]['price'])+'</div>\\\n                    </label>';\n                \n                break;\n                case 'radio':\n\n                html_vars += '\\\n                    <label>\\\n                        <input type=\"radio\" data-required=\"'+product.variations[v].required+'\" data-indexv=\"'+v+'\" name=\"radio'+v+'\" data-index=\"'+d+'\" data-title=\"'+product.variations[v].data[d]['title']+'\" data-titlev=\"'+__(product.variations[v].title)+'\" data-price=\"'+product.variations[v].data[d]['price']+'\" '+(checked?'checked=\"checked\"':'')+' />\\\n                        <span>'+__(product.variations[v].data[d]['title'])+'</span>\\\n                        <div class=\"price\">+ '+priceFormat(_this, product.variations[v].data[d]['price'])+'</div>\\\n                    </label>';\n                \n                break;\n            }\n        }\n\n        html_vars += '</div>';\n    }\n\n    return html_vars;\n}\n\nexport const escape = (htmlStr) => {\n\n    return htmlStr.replace(/&/g, \"&amp;\")\n          .replace(/</g, \"&lt;\")\n          .replace(/>/g, \"&gt;\")\n          .replace(/\"/g, \"&quot;\")\n          .replace(/'/g, \"&#39;\");        \n \n}\n\nexport const unescape = (htmlStr) => {\n\n    htmlStr = htmlStr.replace(/&lt;/g , \"<\");\t \n    htmlStr = htmlStr.replace(/&gt;/g , \">\");     \n    htmlStr = htmlStr.replace(/&quot;/g , \"\\\"\");  \n    htmlStr = htmlStr.replace(/&#39;/g , \"\\'\");   \n    htmlStr = htmlStr.replace(/&amp;/g , \"&\");\n    return htmlStr;\n}\n\nexport const ecommerceUpdates = (_this, source, cb) => {\n\n    // do API query\n    fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n        method: 'post',\n        headers: headers,\n        body: JSON.stringify({\n            query: {\n                updates: {\n                    type:       'updates',\n                    source:     source,\n                }\n            }\n        })\n    })\n    .then(response => response.json())\n    .then(response => {\n\n        if(response.success){\n\n            // do callback\n            cb(response);\n            \n            // parse notifications\n            renderNotifications(_this, response.messages);\n            \n        }else{\n\n\n        }\n    })\n    .catch(error => { // parseApiError(error); \n    });\n}\n\nexport const isMobile = () => {\n\n    const nav = navigator.userAgent.toLowerCase();\n    return (\n        nav.match(/iphone/i) || nav.match(/ipod/i) || nav.match(/ipad/i) || nav.match(/android/i)\n    );\n}\n\n// play notification sound. Ex.: when new order received\nexport const playSound = (_this, max) => {\n \n    // if(!max) max = _this.state.playSound.max_times;\n\n    _this.state.playSound.n = 0;\n\n    if(_this.state.playSound.timer) clearInterval(_this.state.playSound.timer);\n\n    if(_this.state.playSound.allowed) _this.state.playSound.audio.play();\n\n    console.log(\"playing \" + _this.state.playSound.allowed);\n\n    try{\n        if(_this.state.playSound.allowed && isMobile()) window.navigator.vibrate(200);\n    }catch{\n\n    }\n\n    if(max==1) return;\n\n    _this.state.playSound.timer = setInterval(() => {\n\n        if(!_this.state.playSound.allowed) return;\n         \n        _this.state.playSound.audio.play();\n\n        if(_this.state.playSound.n > max){ clearInterval(_this.state.playSound.timer) }\n\n        _this.state.playSound.n += 1;\n\n    }, 5000);\n\n    // console.log('playSound');\n}\n\nexport const lazyLoad = () => {\n\n    let lazyImages = [].slice.call(document.querySelectorAll(\"img.lazy\"));\n    if (document.querySelector(\"body\").dataset.lazyLoading != '1'){\n\n        document.querySelector(\"body\").dataset.lazyLoading = '1';\n        setTimeout(function() {\n            lazyImages.forEach(function(lazyImage) {\n                if ((lazyImage.getBoundingClientRect().top <= window.innerHeight && lazyImage.getBoundingClientRect().bottom >= 0) && getComputedStyle(lazyImage).display !== \"none\") {\n\n                    lazyImage.src = lazyImage.dataset.src;\n                    lazyImage.srcset = lazyImage.dataset.srcset;\n                    lazyImage.classList.remove(\"lazy\");\n                    lazyImages = lazyImages.filter(function(image) {\n                        return image !== lazyImage;\n                    });\n                }\n            });\n            document.querySelector(\"body\").dataset.lazyLoading = '0';\n        }, 0);\n    }\n}\n\nexport const renderNotifications = (_this, messages) => {\n\n    let html = '';\n\n    let play = false;\n\n    // html\n    messages.forEach(msg => {\n\n        if(!_this.state.playSound.nids.includes(msg._id)){ _this.state.playSound.nids.push(msg._id); play = true; }\n\n        if(!document.querySelector('#contents .container [data-id=\"'+msg._id+'\"]')){\n        \n            html += `\n\n            <div class=\"alert alert-${ msg.color } alert-dismissible fade show\" role=\"alert\" data-id=\"${ msg._id }\">\n                <div class=\"d-flex align-items-center\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-exclamation-square flex-shrink-0 me-2\" viewBox=\"0 0 16 16\">\n                        <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z\"/>\n                        <path d=\"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z\"/>\n                    </svg>\n                    <div>\n                    ${ msg.msg }\n                    </div>\n                </div>\n                <button type=\"button\" class=\"btn-close btn-dismiss-notify\" data-bs-dismiss=\"alert\" aria-label=\"Close\" data-id=\"${ msg._id }\"></button>\n            </div>`;\n        }\n    });\n\n    // play sound\n    if(play){ console.log('notify play sound'); playSound(_this, 1); _this.getData(); }\n\n    if(document.querySelector('#contents .container')) document.querySelector('#contents .container').insertAdjacentHTML(\"afterbegin\", html);\n\n    // listeners\n    onClick('.btn-dismiss-notify', (e) => {\n\n        // do API query\n        fetch('https://api-v1.kenzap.cloud/ecommerce/', {\n            method: 'post',\n            headers: headers,\n            body: JSON.stringify({\n                query: {\n                    updates: {\n                        type:       'dismiss',\n                        id:         e.currentTarget.dataset.id,\n                    }\n                }\n            })\n        })\n        .then(response => response.json())\n        .then(response => {\n\n            if(response.success){\n\n\n\n            }else{\n\n\n            }\n        })\n        .catch(error => { // parseApiError(error); \n        });\n    });\n\n    // order open listener\n    if(document.querySelector('.order-details')) for( let el of document.querySelectorAll('.order-details') ){\n\n        if(el.dataset.assigned == \"1\") return;\n\n        el.dataset.assigned = 1;\n\n        el.addEventListener('click', (e) => {\n\n            let el = document.querySelector(\".view-order[data-id='\"+e.currentTarget.dataset.id+\"']\");\n\n            simulateClick(el);\n\n        }, true);\n    }\n}\n\nexport const printReceipt = (_this, order) => {\n\n    // vars\n    let o = order, data = {}, date = new Date();\n\n    // 58mm wide thermal printers are best to display 32 chars per line\n    let row = (txt, end_ofst) => {\n\n        let output = '', max_char = 32 - end_ofst, max_ofst = 4, ofst_prev = 0, ofst = 0, ci = 0;\n        // console.log(max_char);\n        for(let i = 0; i < Math.ceil(txt.length / max_char); i++){\n\n            // add new line print from second loop only\n            if(i>0) output += '\\n[L]';\n\n            // ofst store first available whitespace break in words\n            ofst = ci = 0;\n            for(let e = max_ofst; e > -1 * max_ofst; e--){\n\n                ci = ((max_char + ofst_prev) * i) + max_char + e; if(txt[ci] == ' ' || ci == txt.length){ ofst += e; break; }\n            }\n\n            // add line row\n            output += txt.substr((max_char + ofst_prev) * i, max_char + ofst);\n\n            // line ends earlier than expected, skip loop\n            if(ci == txt.length) break;\n\n            ofst_prev = ofst;\n        }\n\n        return output;\n    };\n\n    // debug vs actual print\n    data.debug = false;\n\n    // get receipt template\n    data.print = _this.state.settings.receipt_template;\n\n    console.log(data.print);\n\n    // order id\n    data.print = data.print.replace(/{{order_id}}/g, o.id);\n\n    // current time\n    data.print = data.print.replace(/{{date_time}}/g, date.toLocaleString([], { dateStyle: 'medium', timeStyle: 'short', }));\n\n    // order items\n    let items = '';\n    for(let i in o.items){\n\n        console.log(__(o.items[i].title));\n\n        let total = priceFormat(_this, o.items[i].total);\n        let end_ofst = (o.items[i].qty+\"\").length + (total+\"\").length + 3;\n        items += `[L]<b>${ o.items[i].qty } X ${ row(__(o.items[i].title), end_ofst) }</b>[R]${ total }\\n`;\n        for(let v in o.items[i].variations){\n\n            items += `[L] ${ row(__(o.items[i].variations[v].title), 1) }:`;\n            for(let l in  o.items[i].variations[v].list) items += ` ${ o.items[i].variations[v].list[l].title },`;\n\n            if(items.endsWith(',')) items = items.substring(0, items.length - 1) + '\\n';\n\n            // parse variation list\n            // let list = ''; for(let l in item[x].variations[v].list) list += item[x].variations[v].list[l].title + \" \";\n            // vars += '<div><b>' + item[x].variations[v].title + \"</b> <span>\" + list + \"</span></div> \";\n    \n            // // meal note\n            // if(item[x].variations[v].note !== undefined && item[x].variations[v].note.length > 0) vars += \"<div><b>\" + __('Note') + \"</b> \" + item[x].variations[v].note + \"</div> \";\n        }\n    }\n    if(items.endsWith('\\n')) items = items.substring(0, items.length - 2);\n    data.print = data.print.replace(/{{order_items}}/g, items);\n\n    // order note\n    let note = !o.note || o.note == '<br>' ? '' : o.note;\n    if(note.length>0){\n        //  data.print += '[C]================================';\n        data.print = data.print.replace(/{{order_note}}/g, '[C]================================\\n' + note + '\\n[C]================================\\n');\n    }\n    // if(note.length>0) data.print += '[C]================================';\n\n    // order totals\n    data.print = data.print.replace(/{{total}}/g, priceFormat(_this, o.price.total));\n    data.print = data.print.replace(/{{tax_total}}/g, priceFormat(_this, o.price.tax_total));\n    data.print = data.print.replace(/{{discount_total}}/g, priceFormat(_this, o.price.discount_total));\n    data.print = data.print.replace(/{{grand_total}}/g, priceFormat(_this, o.price.grand_total));\n\n\n    let order_totals  = '';\n    order_totals += '[L]Subtotal[R]' + priceFormat(_this, o.price.total) + '\\n';\n    if(o.price.discount_total > 0) order_totals += '[L]'+__('Discount')+'[R]-' + priceFormat(_this, o.price.discount_total) + '\\n';\n    if(o.price.fee_total > 0) order_totals += '[L]'+_this.state.settings.fee_display+'[R]' + priceFormat(_this, o.price.fee_total) + '\\n';\n    if(o.price.tax_total > 0) order_totals += '[L]'+_this.state.settings.tax_display+'[R]' + priceFormat(_this, o.price.tax_total) + '\\n';\n    if(o.price.grand_total > 0) order_totals += '[L]'+__('Grand Total')+'[R]' + priceFormat(_this, o.price.grand_total);\n\n    data.print = data.print.replace(/{{order_totals}}/g, order_totals);\n\n    // qr link\n    data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n    data.print = data.print.replace(/{{qr_number}}/g, document.querySelector('#qr-number').value);\n\n        \n    // let click = document.querySelector(\".print-order[data-id='\"+e.currentTarget.dataset.id+\"']\");\n\n    // click.setAttribute('href', 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data)));\n\n    // e.currentTarget.setAttribute('href', 'kenzapprint://kenzapprint.app?data='+JSON.stringify(data));\n\n    // alert(data.print);\n\n    let str = 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data));\n    \n    if(data.debug) { console.log(data.print); console.log(str); }\n\n    return str;\n}\n\nexport const printQR = (_this, order) => {\n\n    // vars\n    let o = order, data = {}, date = new Date();\n\n    // debug vs actual print\n    data.debug = false;\n\n    // get qr template\n    data.print = _this.state.settings.qr_template;\n\n    // qr link\n    data.print = data.print.replace(/{{qr_link}}/g, 'http://'+_this.state.qr_settings.slug + '.kenzap.site');\n    data.print = data.print.replace(/{{qr_number}}/g, document.querySelector('#qr-number').value);\n\n    if(data.debug) { console.log(data.print); console.log(str); }\n\n    let str = 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data));\n\n    return str;\n}\n\n/**\n * Converts degrees to radians\n * \n * @param deg {Integer}\n * @returns {Integer} - radians\n */\nexport const degToRad = (deg) => {\n\n    return (deg - 90) * Math.PI / 180.0;\n}\n\n/*\n* Load additional JS or CSS depencies\n*\n* @param    dep       dependecy. Ex.: hiebee.min.js \n* @param    cb        function to call after script is loaded (optional)       \n* @return \t{Boolen} \tresult status \n* \n*/\nexport const loadAddon = (dep, version, cb) => {\n\n    // dependency already loaded, skip\n    if(document.getElementById(dep)){ if(typeof cb === 'function') cb.call(); return; }\n\n    // detect dependency type\n    let t = dep.split('.').slice(-1)[0];\n    // console.log(dep+'loadAddon'+t);\n    switch(t){\n      case 'js':\n        \n        let js = document.createElement(\"script\");\n        js.setAttribute(\"src\", dep);\n        js.id = dep;\n        js.onload = js.onreadystatechange = function() {\n \n          if(!this.readyState || this.readyState == 'complete')\n            if(typeof cb === 'function') cb.call();\n        };\n        document.body.appendChild(js);\n        \n      break;\n      case 'css':\n\n        var head  = document.getElementsByTagName('head')[0];\n        var css  = document.createElement('link');\n        css.id   = dep;\n        css.rel  = 'stylesheet';\n        css.type = 'text/css';\n        css.href = dep;\n        head.appendChild(css);\n\n      break;\n    }\n}\n\n/**\n * @name setCookie\n * @description Set cookie by its name to all .kenzap.cloud subdomains\n * @param {string} name - Cookie name.\n * @param {string} value - Cookie value.\n * @param {string} days - Number of days when cookie expires.\n */\n export const setCookie = (name, value, days) => {\n\n    let expires = \"\";\n    if (days) {\n        let date = new Date();\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n        expires = \";expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + (escape(value) || \"\") + expires + \";path=/\"; \n}\n\nexport const getCurrencies = () => {\n\n    // length 164\n    return [\n        {\"name\":\"Afghan Afghani\",\"code\":\"AFA\",\"symbol\":\"؋\"},\n        {\"name\":\"Albanian Lek\",\"code\":\"ALL\",\"symbol\":\"Lek\"},\n        {\"name\":\"Algerian Dinar\",\"code\":\"DZD\",\"symbol\":\"دج\"},\n        {\"name\":\"Angolan Kwanza\",\"code\":\"AOA\",\"symbol\":\"Kz\"},\n        {\"name\":\"Argentine Peso\",\"code\":\"ARS\",\"symbol\":\"$\"},\n        {\"name\":\"Armenian Dram\",\"code\":\"AMD\",\"symbol\":\"֏\"},\n        {\"name\":\"Aruban Florin\",\"code\":\"AWG\",\"symbol\":\"ƒ\"},\n        {\"name\":\"Australian Dollar\",\"code\":\"AUD\",\"symbol\":\"$\"},\n        {\"name\":\"Azerbaijani Manat\",\"code\":\"AZN\",\"symbol\":\"m\"},\n        {\"name\":\"Bahamian Dollar\",\"code\":\"BSD\",\"symbol\":\"B$\"},\n        {\"name\":\"Bahraini Dinar\",\"code\":\"BHD\",\"symbol\":\".د.ب\"},\n        {\"name\":\"Bangladeshi Taka\",\"code\":\"BDT\",\"symbol\":\"৳\"},\n        {\"name\":\"Barbadian Dollar\",\"code\":\"BBD\",\"symbol\":\"Bds$\"},\n        {\"name\":\"Belarusian Ruble\",\"code\":\"BYR\",\"symbol\":\"Br\"},\n        {\"name\":\"Belgian Franc\",\"code\":\"BEF\",\"symbol\":\"fr\"},\n        {\"name\":\"Belize Dollar\",\"code\":\"BZD\",\"symbol\":\"$\"},\n        {\"name\":\"Bermudan Dollar\",\"code\":\"BMD\",\"symbol\":\"$\"},\n        {\"name\":\"Bhutanese Ngultrum\",\"code\":\"BTN\",\"symbol\":\"Nu.\"},\n        {\"name\":\"Bitcoin\",\"code\":\"BTC\",\"symbol\":\"฿\"},\n        {\"name\":\"Bolivian Boliviano\",\"code\":\"BOB\",\"symbol\":\"Bs.\"},\n        {\"name\":\"Bosnia-Herzegovina Convertible Mark\",\"code\":\"BAM\",\"symbol\":\"KM\"},\n        {\"name\":\"Botswanan Pula\",\"code\":\"BWP\",\"symbol\":\"P\"},\n        {\"name\":\"Brazilian Real\",\"code\":\"BRL\",\"symbol\":\"R$\"},\n        {\"name\":\"British Pound Sterling\",\"code\":\"GBP\",\"symbol\":\"£\"},\n        {\"name\":\"Brunei Dollar\",\"code\":\"BND\",\"symbol\":\"B$\"},\n        {\"name\":\"Bulgarian Lev\",\"code\":\"BGN\",\"symbol\":\"Лв.\"},\n        {\"name\":\"Burundian Franc\",\"code\":\"BIF\",\"symbol\":\"FBu\"},\n        {\"name\":\"Cambodian Riel\",\"code\":\"KHR\",\"symbol\":\"KHR\"},\n        {\"name\":\"Canadian Dollar\",\"code\":\"CAD\",\"symbol\":\"$\"},\n        {\"name\":\"Cape Verdean Escudo\",\"code\":\"CVE\",\"symbol\":\"$\"},\n        {\"name\":\"Cayman Islands Dollar\",\"code\":\"KYD\",\"symbol\":\"$\"},\n        {\"name\":\"CFA Franc BCEAO\",\"code\":\"XOF\",\"symbol\":\"CFA\"},\n        {\"name\":\"CFA Franc BEAC\",\"code\":\"XAF\",\"symbol\":\"FCFA\"},\n        {\"name\":\"CFP Franc\",\"code\":\"XPF\",\"symbol\":\"₣\"},\n        {\"name\":\"Chilean Peso\",\"code\":\"CLP\",\"symbol\":\"$\"},\n        {\"name\":\"Chinese Yuan\",\"code\":\"CNY\",\"symbol\":\"¥\"},\n        {\"name\":\"Colombian Peso\",\"code\":\"COP\",\"symbol\":\"$\"},\n        {\"name\":\"Comorian Franc\",\"code\":\"KMF\",\"symbol\":\"CF\"},\n        {\"name\":\"Congolese Franc\",\"code\":\"CDF\",\"symbol\":\"FC\"},\n        {\"name\":\"Costa Rican Colón\",\"code\":\"CRC\",\"symbol\":\"₡\"},\n        {\"name\":\"Croatian Kuna\",\"code\":\"HRK\",\"symbol\":\"kn\"},\n        {\"name\":\"Cuban Convertible Peso\",\"code\":\"CUC\",\"symbol\":\"$, CUC\"},\n        {\"name\":\"Czech Republic Koruna\",\"code\":\"CZK\",\"symbol\":\"Kč\"},\n        {\"name\":\"Danish Krone\",\"code\":\"DKK\",\"symbol\":\"Kr.\"},\n        {\"name\":\"Djiboutian Franc\",\"code\":\"DJF\",\"symbol\":\"Fdj\"},\n        {\"name\":\"Dominican Peso\",\"code\":\"DOP\",\"symbol\":\"$\"},\n        {\"name\":\"East Caribbean Dollar\",\"code\":\"XCD\",\"symbol\":\"$\"},\n        {\"name\":\"Egyptian Pound\",\"code\":\"EGP\",\"symbol\":\"ج.م\"},\n        {\"name\":\"Eritrean Nakfa\",\"code\":\"ERN\",\"symbol\":\"Nfk\"},\n        {\"name\":\"Estonian Kroon\",\"code\":\"EEK\",\"symbol\":\"kr\"},\n        {\"name\":\"Ethiopian Birr\",\"code\":\"ETB\",\"symbol\":\"Nkf\"},\n        {\"name\":\"Euro\",\"code\":\"EUR\",\"symbol\":\"€\"},\n        {\"name\":\"Falkland Islands Pound\",\"code\":\"FKP\",\"symbol\":\"£\"},\n        {\"name\":\"Fijian Dollar\",\"code\":\"FJD\",\"symbol\":\"FJ$\"},\n        {\"name\":\"Gambian Dalasi\",\"code\":\"GMD\",\"symbol\":\"D\"},\n        {\"name\":\"Georgian Lari\",\"code\":\"GEL\",\"symbol\":\"ლ\"},\n        {\"name\":\"German Mark\",\"code\":\"DEM\",\"symbol\":\"DM\"},\n        {\"name\":\"Ghanaian Cedi\",\"code\":\"GHS\",\"symbol\":\"GH₵\"},\n        {\"name\":\"Gibraltar Pound\",\"code\":\"GIP\",\"symbol\":\"£\"},\n        {\"name\":\"Greek Drachma\",\"code\":\"GRD\",\"symbol\":\"₯, Δρχ, Δρ\"},\n        {\"name\":\"Guatemalan Quetzal\",\"code\":\"GTQ\",\"symbol\":\"Q\"},\n        {\"name\":\"Guinean Franc\",\"code\":\"GNF\",\"symbol\":\"FG\"},\n        {\"name\":\"Guyanaese Dollar\",\"code\":\"GYD\",\"symbol\":\"$\"},\n        {\"name\":\"Haitian Gourde\",\"code\":\"HTG\",\"symbol\":\"G\"},\n        {\"name\":\"Honduran Lempira\",\"code\":\"HNL\",\"symbol\":\"L\"},\n        {\"name\":\"Hong Kong Dollar\",\"code\":\"HKD\",\"symbol\":\"$\"},\n        {\"name\":\"Hungarian Forint\",\"code\":\"HUF\",\"symbol\":\"Ft\"},\n        {\"name\":\"Icelandic króna\",\"code\":\"ISK\",\"symbol\":\"kr\"},\n        {\"name\":\"Indian Rupee\",\"code\":\"INR\",\"symbol\":\"₹\"},\n        {\"name\":\"Indonesian Rupiah\",\"code\":\"IDR\",\"symbol\":\"Rp\"},\n        {\"name\":\"Iranian Rial\",\"code\":\"IRR\",\"symbol\":\"﷼\"},\n        {\"name\":\"Iraqi Dinar\",\"code\":\"IQD\",\"symbol\":\"د.ع\"},\n        {\"name\":\"Israeli New Sheqel\",\"code\":\"ILS\",\"symbol\":\"₪\"},\n        {\"name\":\"Italian Lira\",\"code\":\"ITL\",\"symbol\":\"L,£\"},\n        {\"name\":\"Jamaican Dollar\",\"code\":\"JMD\",\"symbol\":\"J$\"},\n        {\"name\":\"Japanese Yen\",\"code\":\"JPY\",\"symbol\":\"¥\"},\n        {\"name\":\"Jordanian Dinar\",\"code\":\"JOD\",\"symbol\":\"ا.د\"},\n        {\"name\":\"Kazakhstani Tenge\",\"code\":\"KZT\",\"symbol\":\"лв\"},\n        {\"name\":\"Kenyan Shilling\",\"code\":\"KES\",\"symbol\":\"KSh\"},\n        {\"name\":\"Kuwaiti Dinar\",\"code\":\"KWD\",\"symbol\":\"ك.د\"},\n        {\"name\":\"Kyrgystani Som\",\"code\":\"KGS\",\"symbol\":\"лв\"},\n        {\"name\":\"Laotian Kip\",\"code\":\"LAK\",\"symbol\":\"₭\"},\n        {\"name\":\"Latvian Lats\",\"code\":\"LVL\",\"symbol\":\"Ls\"},\n        {\"name\":\"Lebanese Pound\",\"code\":\"LBP\",\"symbol\":\"£\"},\n        {\"name\":\"Lesotho Loti\",\"code\":\"LSL\",\"symbol\":\"L\"},\n        {\"name\":\"Liberian Dollar\",\"code\":\"LRD\",\"symbol\":\"$\"},\n        {\"name\":\"Libyan Dinar\",\"code\":\"LYD\",\"symbol\":\"د.ل\"},\n        {\"name\":\"Lithuanian Litas\",\"code\":\"LTL\",\"symbol\":\"Lt\"},\n        {\"name\":\"Macanese Pataca\",\"code\":\"MOP\",\"symbol\":\"$\"},\n        {\"name\":\"Macedonian Denar\",\"code\":\"MKD\",\"symbol\":\"ден\"},\n        {\"name\":\"Malagasy Ariary\",\"code\":\"MGA\",\"symbol\":\"Ar\"},\n        {\"name\":\"Malawian Kwacha\",\"code\":\"MWK\",\"symbol\":\"MK\"},\n        {\"name\":\"Malaysian Ringgit\",\"code\":\"MYR\",\"symbol\":\"RM\"},\n        {\"name\":\"Maldivian Rufiyaa\",\"code\":\"MVR\",\"symbol\":\"Rf\"},\n        {\"name\":\"Mauritanian Ouguiya\",\"code\":\"MRO\",\"symbol\":\"MRU\"},\n        {\"name\":\"Mauritian Rupee\",\"code\":\"MUR\",\"symbol\":\"₨\"},\n        {\"name\":\"Mexican Peso\",\"code\":\"MXN\",\"symbol\":\"$\"},\n        {\"name\":\"Moldovan Leu\",\"code\":\"MDL\",\"symbol\":\"L\"},\n        {\"name\":\"Mongolian Tugrik\",\"code\":\"MNT\",\"symbol\":\"₮\"},\n        {\"name\":\"Moroccan Dirham\",\"code\":\"MAD\",\"symbol\":\"MAD\"},\n        {\"name\":\"Mozambican Metical\",\"code\":\"MZM\",\"symbol\":\"MT\"},\n        {\"name\":\"Myanmar Kyat\",\"code\":\"MMK\",\"symbol\":\"K\"},\n        {\"name\":\"Namibian Dollar\",\"code\":\"NAD\",\"symbol\":\"$\"},\n        {\"name\":\"Nepalese Rupee\",\"code\":\"NPR\",\"symbol\":\"₨\"},\n        {\"name\":\"Netherlands Antillean Guilder\",\"code\":\"ANG\",\"symbol\":\"ƒ\"},\n        {\"name\":\"New Taiwan Dollar\",\"code\":\"TWD\",\"symbol\":\"$\"},\n        {\"name\":\"New Zealand Dollar\",\"code\":\"NZD\",\"symbol\":\"$\"},\n        {\"name\":\"Nicaraguan Córdoba\",\"code\":\"NIO\",\"symbol\":\"C$\"},\n        {\"name\":\"Nigerian Naira\",\"code\":\"NGN\",\"symbol\":\"₦\"},\n        {\"name\":\"North Korean Won\",\"code\":\"KPW\",\"symbol\":\"₩\"},\n        {\"name\":\"Norwegian Krone\",\"code\":\"NOK\",\"symbol\":\"kr\"},\n        {\"name\":\"Omani Rial\",\"code\":\"OMR\",\"symbol\":\".ع.ر\"},\n        {\"name\":\"Pakistani Rupee\",\"code\":\"PKR\",\"symbol\":\"₨\"},\n        {\"name\":\"Panamanian Balboa\",\"code\":\"PAB\",\"symbol\":\"B/.\"},\n        {\"name\":\"Papua New Guinean Kina\",\"code\":\"PGK\",\"symbol\":\"K\"},\n        {\"name\":\"Paraguayan Guarani\",\"code\":\"PYG\",\"symbol\":\"₲\"},\n        {\"name\":\"Peruvian Nuevo Sol\",\"code\":\"PEN\",\"symbol\":\"S/.\"},\n        {\"name\":\"Philippine Peso\",\"code\":\"PHP\",\"symbol\":\"₱\"},\n        {\"name\":\"Polish Zloty\",\"code\":\"PLN\",\"symbol\":\"zł\"},\n        {\"name\":\"Qatari Rial\",\"code\":\"QAR\",\"symbol\":\"ق.ر\"},\n        {\"name\":\"Romanian Leu\",\"code\":\"RON\",\"symbol\":\"lei\"},\n        {\"name\":\"Russian Ruble\",\"code\":\"RUB\",\"symbol\":\"₽\"},\n        {\"name\":\"Rwandan Franc\",\"code\":\"RWF\",\"symbol\":\"FRw\"},\n        {\"name\":\"Salvadoran Colón\",\"code\":\"SVC\",\"symbol\":\"₡\"},\n        {\"name\":\"Samoan Tala\",\"code\":\"WST\",\"symbol\":\"SAT\"},\n        {\"name\":\"Saudi Riyal\",\"code\":\"SAR\",\"symbol\":\"﷼\"},\n        {\"name\":\"Serbian Dinar\",\"code\":\"RSD\",\"symbol\":\"din\"},\n        {\"name\":\"Seychellois Rupee\",\"code\":\"SCR\",\"symbol\":\"SRe\"},\n        {\"name\":\"Sierra Leonean Leone\",\"code\":\"SLL\",\"symbol\":\"Le\"},\n        {\"name\":\"Singapore Dollar\",\"code\":\"SGD\",\"symbol\":\"$\"},\n        {\"name\":\"Slovak Koruna\",\"code\":\"SKK\",\"symbol\":\"Sk\"},\n        {\"name\":\"Solomon Islands Dollar\",\"code\":\"SBD\",\"symbol\":\"Si$\"},\n        {\"name\":\"Somali Shilling\",\"code\":\"SOS\",\"symbol\":\"Sh.so.\"},\n        {\"name\":\"South African Rand\",\"code\":\"ZAR\",\"symbol\":\"R\"},\n        {\"name\":\"South Korean Won\",\"code\":\"KRW\",\"symbol\":\"₩\"},\n        {\"name\":\"Special Drawing Rights\",\"code\":\"XDR\",\"symbol\":\"SDR\"},\n        {\"name\":\"Sri Lankan Rupee\",\"code\":\"LKR\",\"symbol\":\"Rs\"},\n        {\"name\":\"St. Helena Pound\",\"code\":\"SHP\",\"symbol\":\"£\"},\n        {\"name\":\"Sudanese Pound\",\"code\":\"SDG\",\"symbol\":\".س.ج\"},\n        {\"name\":\"Surinamese Dollar\",\"code\":\"SRD\",\"symbol\":\"$\"},\n        {\"name\":\"Swazi Lilangeni\",\"code\":\"SZL\",\"symbol\":\"E\"},\n        {\"name\":\"Swedish Krona\",\"code\":\"SEK\",\"symbol\":\"kr\"},\n        {\"name\":\"Swiss Franc\",\"code\":\"CHF\",\"symbol\":\"CHf\"},\n        {\"name\":\"Syrian Pound\",\"code\":\"SYP\",\"symbol\":\"LS\"},\n        {\"name\":\"São Tomé and Príncipe Dobra\",\"code\":\"STD\",\"symbol\":\"Db\"},\n        {\"name\":\"Tajikistani Somoni\",\"code\":\"TJS\",\"symbol\":\"SM\"},\n        {\"name\":\"Tanzanian Shilling\",\"code\":\"TZS\",\"symbol\":\"TSh\"},\n        {\"name\":\"Thai Baht\",\"code\":\"THB\",\"symbol\":\"฿\"},\n        {\"name\":\"Tongan Pa'anga\",\"code\":\"TOP\",\"symbol\":\"$\"},\n        {\"name\":\"Trinidad & Tobago Dollar\",\"code\":\"TTD\",\"symbol\":\"$\"},\n        {\"name\":\"Tunisian Dinar\",\"code\":\"TND\",\"symbol\":\"ت.د\"},\n        {\"name\":\"Turkish Lira\",\"code\":\"TRY\",\"symbol\":\"₺\"},\n        {\"name\":\"Turkmenistani Manat\",\"code\":\"TMT\",\"symbol\":\"T\"},\n        {\"name\":\"Ugandan Shilling\",\"code\":\"UGX\",\"symbol\":\"USh\"},\n        {\"name\":\"Ukrainian Hryvnia\",\"code\":\"UAH\",\"symbol\":\"₴\"},\n        {\"name\":\"United Arab Emirates Dirham\",\"code\":\"AED\",\"symbol\":\"إ.د\"},\n        {\"name\":\"Uruguayan Peso\",\"code\":\"UYU\",\"symbol\":\"$\"},\n        {\"name\":\"US Dollar\",\"code\":\"USD\",\"symbol\":\"$\"},\n        {\"name\":\"Uzbekistan Som\",\"code\":\"UZS\",\"symbol\":\"лв\"},\n        {\"name\":\"Vanuatu Vatu\",\"code\":\"VUV\",\"symbol\":\"VT\"},\n        {\"name\":\"Venezuelan  Bolívar\",\"code\":\"VEF\",\"symbol\":\"Bs\"},\n        {\"name\":\"Vietnamese Dong\",\"code\":\"VND\",\"symbol\":\"₫\"},\n        {\"name\":\"Yemeni Rial\",\"code\":\"YER\",\"symbol\":\"﷼\"},\n        {\"name\":\"Zambian Kwacha\",\"code\":\"ZMK\",\"symbol\":\"ZK\"}\n    ];\n}","import { headers, showLoader, hideLoader, onClick, onKeyUp, simulateClick, parseApiError, spaceID } from '@kenzap/k-cloud';\nimport { priceFormat, getPageNumber, makeNumber, parseVariations, escape, unescape, printReceipt } from \"../_/_helpers.js\"\n\nexport const preview = {\n\n    _this: null,\n    renderOrder: (_this, e) => {\n\n        let modal = document.querySelector(\".order-modal\");\n        _this.modalCont = new bootstrap.Modal(modal);\n        _this.modalOpen = true;\n        let i = e.currentTarget.dataset.index; // _this.state.orderPreviewIndex = i;\n        \n        // to properly handle back button on mobiles\n        // window.history.pushState(null, 'editing');\n        history.pushState({pageID: 'orders'}, 'Orders', window.location.pathname + window.location.search + \"#editing\");\n\n        modal.addEventListener('hide.bs.modal', function (e) {\n           \n            if (window.location.href.indexOf(\"#editing\")==-1) return;\n\n            history.pushState({pageID: 'orders'}, 'Orders', window.location.pathname + window.location.search);\n        });\n        \n        // is new order ?\n        if(typeof(i) === 'undefined'){\n\n            _this.state.orderSingle = {\n                _id: \"new\",\n                created: 1649831099,\n                from: \"no name\",\n                id: \"\",\n                idd: \"\",\n                items: [],\n                kid: \"0\",\n                name: \"no name\",\n                note: \"\",\n                sid: spaceID,\n                status: \"new\",\n                step: 1,\n                table: \"1\",\n                total: 0,\n                updated: 1649833845\n            }\n        }else{\n\n            _this.state.orderSingle = _this.state.orders[i];\n        }\n\n        // console.log(_this.state.orderSingle);\n        let items = '';\n\n        // get order status\n        Object.keys(_this.state.statuses).forEach((key, index) => { items += `<li><a class=\"dppi dropdown-item\" data-key=\"${ key }\" href=\"#\">${ _this.state.statuses[key].text }</a></li>` })\n        let statusSelect = `\n        <div class=\"d-flex justify-content-between\">\n            <div class=\"st-modal st-opts mb-3 me-1 me-sm-3 dropdown\">\n                <a class=\"btn btn-sm ${ _this.state.statuses[_this.state.orderSingle['status']].class } dropdown-toggle order-form\" data-id=\"status\" data-type=\"key\" data-value=\"${ _this.state.orderSingle['status'] }\" href=\"#\" role=\"button\" id=\"order-status-modal\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" >\n                    ${ _this.state.statuses[_this.state.orderSingle['status']].text }\n                </a>\n                <ul class=\"dropdown-menu\" aria-labelledby=\"order-status-modal\">\n                    ${ items }\n                </ul>\n            </div>\n            <a href=\"#\" data-index=\"0\" class=\"print-order text-success\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"currentColor\" class=\"bi bi-printer\" viewBox=\"0 0 16 16\">\n                    <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z\"></path>\n                    <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z\"></path>\n                </svg>\n            </a>\n        </div>\n        `;\n        // kenzapprint://kenzapprint.app?data=%7B%22print%22%3A%22%5BC%5D%3Cu%3E%3Cfont%20size%3D%5C%22big%5C%22%3EORDER%7B%7Border_id_short%7D%7D%3C%2Ffont%3E%3C%2Fu%3E%5Cn%5BC%5DFu%20Zhen%20Seafood%5Cn%5BC%5D%3Cu%20type%3Ddouble%3E%7B%7Bdate_time%7D%7D%3C%2Fu%3E%5Cn%5BC%5D%5Cn%5BC%5D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%5C%22%20%5Cn%5BL%5D%5Cn%5BL%5D%3Cb%3EBEAUTIFUL%20SHIRT%3C%2Fb%3E%5BR%5D9.99%E2%82%AC%5Cn%5BL%5D%20%20%2B%20Size%20%3A%20S%5Cn%5BL%5D%5Cn%5BL%5D%3Cb%3EAWESOME%20HAT%3C%2Fb%3E%5BR%5D24.99%E2%82%AC%5Cn%5BL%5D%20%20%2B%20Size%20%3A%2057%2F58%5Cn%5BL%5D%5Cn%5BC%5D--------------------------------%5Cn%5BR%5DTOTAL%20PRICE%20%3A%5BR%5D34.98%E2%82%AC%5Cn%5BR%5DTAX%20%3A%5BR%5D4.23%E2%82%AC%22%7D\" data-id=\"72b42ad9111e7767aa68174227ba20b5e11d26e4\n\n        // structure modal\n        modal.querySelector(\".modal-dialog\").classList.add('modal-fullscreen');\n        modal.querySelector(\".modal-header .modal-title\").innerHTML =  _this.state.orderSingle['from'];\n        modal.querySelector(\".modal-footer .btn-confirm\").innerHTML = _this.state.orderSingle._id == \"new\" ? __('Create') : __('Update');\n        modal.querySelector(\".btn-confirm\").dataset.loading = false;\n        modal.querySelector(\".modal-footer .btn-secondary\").innerHTML = __('Close');\n\n        let html = statusSelect;\n\n        // _id: {l: __(\"System ID\")},\n        let fields = { id: {l: __(\"ID\"), classList: \"order-form\"},  from: {l: __(\"From\"), e: \"text\", editable: true, classList: \"order-form\"}, items: {l: \"\", e: \"items\"}, fname: {l: __(\"Name\"), e: \"text\"}, lname: {l: __(\"Surname\"), e: \"text\"}, bios: {l: __(\"Bios\"), e: \"textarea\"}, avatar: {l: __(\"Avatar\"), e: \"text\"}, email: {l: __(\"Email\"), e: \"text\"}, countryr: {l: __(\"Country\"), e: \"text\"}, cityr: {l: __(\"City\"), e: \"text\"}, addr1: {l: __(\"Address 1\"), e: \"textarea\"}, addr2: {l: __(\"Address 2\"), e: \"textarea\"}, post: {l: __(\"Post\"), e: \"text\"}, state: {l: __(\"State\"), e: \"text\"}, c1: {l: __(\"Whatsapp\"), e: \"text\"}, c2: {l: __(\"Messenger\"), e: \"text\"}, c3: {l: __(\"Line\"), e: \"text\"}, c4: {l: __(\"Email\"), e: \"text\"}, c5: {l: __(\"Telegram\"), e: \"text\"}, email: {l: __(\"Email\"), e: \"text\"}, bio: {l: __(\"Bio\"), e: \"text\"}, y1: {l: __(\"Name\"), e: \"text\"}, y2: {l: __(\"IBAN\"), e: \"text\"}, y3: {l: __(\"SWIFT\"), e: \"text\"}, y4: {l: __(\"Bank\"), e: \"text\"}, y5: {l: __(\"Bank city\"), e: \"text\"}, y6: {l: __(\"Bank country\"), e: \"text\"}, note: {l: __(\"Note\"), e: \"textarea\"}, total: {l: __(\"Total\"), e: \"price\", classList: \"order-form\"}, total_tax: {l: __(\"Tax\"), e: \"price\", classList: \"order-form\"}, total_with_tax: {l: __(\"Amount Payable\"), e: \"price\", classList: \"order-form\"}, s3: {l: __(\"Link 3\"), e: \"text\"}, company: {l: __(\"Company\"), e: \"text\"}, vat: {l: __(\"Tax ID\"), e: \"text\"}, grade: {l: __(\"Grade\"), e: \"text\"}, kenzap_ida: {l: __(\"Kenzap IDA\"), e: \"text\"}};\n\n        // order table details\n        for(let x in fields){\n\n            if(_this.state.orderSingle[x] === undefined) continue;\n\n            let val = _this.state.orderSingle[x];\n            let field = fields[x].l;\n\n            html += `\n            <div class=\"mb-3 mt-3 order-row keyx-${ x } ${ x == '_id' || x == 'from' ? \"elipsized\": \"\" }\"  >\n                <b>${ field }</b>${ preview.renderField(_this, fields[x], val, x) }\n            </div>`;\n        }\n\n        html += '';\n        modal.querySelector(\".modal-body\").innerHTML = '<div class=\"modal-body-cont\">' + html + '</div>';\n        _this.modalCont.show();\n\n        // table order item listners (remove, add note, adjust variations, etc)\n        preview.tableOrderItemListeners();\n\n        // order item product edit listener\n        preview.suggestOrderItem(_this);\n\n        // hide suggestion list if still present\n        modal.querySelector(\".edit-item\").addEventListener('blur', (e) => { setTimeout(()=>{ document.querySelector('.s-list').dataset.toggle = false; }, 500); });\n            \n        // add product item to order table\n        preview.addOrderItem(_this);\n\n        // calculate totals for new orders only\n        if(_this.state.orderSingle._id == 'new') preview.refreshTotals();\n\n        // focus on item input fields\n        if(_this.state.orderSingle._id == 'new') setTimeout(() => { document.querySelector('.edit-item').focus(); }, 300);\n        \n        // prevent modal closure if user clicks on white space areas\n        // if(modal) modal.addEventListener('click', (e)=>{ e.preventDefault(); return false; });\n\n        onClick('.print-order', (e) => {\n\n            e.preventDefault();\n            \n            simulateClick(modal.querySelector(\".btn-confirm\"));\n\n            _this.state.printLink = true;\n        });\n\n        // save changes to orders\n        _this.listeners.modalSuccessBtnFunc = (e) => {\n\n            e.preventDefault();\n\n            _this.updateOrder(i, _this.state.orderSingle._id);\n        }\n\n        onClick('.st-modal li a', (e) => {\n\n            e.preventDefault();\n\n            let osm = document.querySelector('#order-status-modal');\n            osm.innerHTML = _this.state.statuses[e.currentTarget.dataset.key].text;\n            osm.dataset.value = e.currentTarget.dataset.key;\n            let list = [];\n\n            // clear previous classes\n            Object.keys(_this.state.statuses).forEach((key) => {\n                list = _this.state.statuses[key].class.split(' ');\n                list.forEach((key) => { \n                    osm.classList.remove(key);\n                });    \n            });\n\n            // add new classes\n            list = _this.state.statuses[e.currentTarget.dataset.key].class.split(' ');\n            list.forEach((key) => { \n\n                osm.classList.add(key);\n            });\n        });\n    },\n    newOrder: (_this) => {\n\n        preview._this = _this;\n        onClick('.add-order', (e) => { preview.renderOrder(_this, e); });\n    },\n    viewOrder: (_this) => {\n\n        preview._this = _this;\n        onClick('.view-order', (e) => { preview.renderOrder(_this, e); });\n    },\n    renderField: (_this, a, item, x) => {\n\n        let html = '';\n        switch(a.e){\n            \n            // case 'text': return '<input type=\"text\" class=\"form-control pv\" id=\"'+x+'\" value=\"'+b+'\">';\n            case 'price': \n\n                html = `<div data-id=\"${x}\" data-type=\"key-number\" class=\"${ a.classList ? a.classList : \"\" } ms-2 d-inline-block\" ${ a.editable ? 'contenteditable=\"true\"':'' } data-id=\"${x}\" data-value=\"${ item }\">${ priceFormat(_this, item) }</div>`;\n                return html;\n            case 'text': \n\n                html = `<div data-id=\"${x}\" data-type=\"text\" class=\"${ a.classList ? a.classList : \"\" } ms-2 d-inline-block\" ${ a.editable ? 'contenteditable=\"true\"':'' } data-id=\"${x}\">${ item }</div>`;\n                return html;\n            case 'textarea': return '<textarea type=\"text\" rows=\"4\" class=\"form-control order-form pv \" data-type=\"textarea\" id=\"'+x+'\" value=\"'+item+'\">'+item+'</textarea>';\n            case 'items': \n\n                // parse product items\n                html = `<table class=\"items order-form\" data-type=\"items\"><tr><th><div class=\"me-1 me-sm-3\">${ __('Product') }</div></th><th class=\"qty\"><div class=\"me-1 me-sm-3\">${ __('Qty') }</div></th><th class=\"tp\"><div class=\"me-1 me-sm-3\">${ __('Total') }</div></th><th></th></tr>`;\n                for(let x in item){ html += preview.structOrderItemTable(_this, x, item, false); }\n\n                // add row for manual product entry\n                html += `<tr class=\"new-item-row\">\n                            <td>\n                                <div class=\"me-1 me-sm-3\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" placeholder=\"${ __('Search..') }\" class=\"form-control edit-item\" data-id=\"\" data-index=\"\" list=\"item-suggestions\">\n                                    <span class=\"select-list-group__toggle\"> </span>\n                                    <ul class=\"s-list my-1 shadow-sm\" data-toggle=\"false\"></ul>\n                                    <datalist id=\"item-suggestions\" class=\"fs-12 d-none\"></datalist>\n                                </div>\n                            </td>\n                            <td class=\"qty\">\n                                <div class=\"me-1 me-sm-3\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control text-right edit-qty\">\n                                </div>\n                            </td>\n                            <td class=\"tp\">\n                                <div class=\"me-1 me-sm-3\">\n                                    <input type=\"text\" value=\"\" autocomplete=\"off\" class=\"form-control edit-tp\">\n                                </div>\n                            </td>\n                            <td class=\"align-middle text-center\"> \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 16 16\" width=\"24\" height=\"24\" class=\"bi bi-plus-circle text-success align-middle add-item\"><path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"></path><path d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"></path></svg>\n                            </td>\n                        </tr>`;\n\n                html += `</table><div class=\"item-vars-input mt-3\"> </div>`;\n\n                return html;\n            default: \n            \n                if(x == '_id') item = item.substr(0, 6);\n\n                html = `<div data-id=\"${x}\" data-type=\"text\" class=\"${ a.classList ? a.classList : \"\" } ms-2 d-inline-block\" ${ a.editable ? 'contenteditable=\"true\"':'' } data-id=\"${x}\">${ item }</div>`;\n                return html;\n        }\n  },\n  itemOptions: (item) => {\n\n    let options = `\n\n        <div class=\"dropdown text-center\">\n            <a  href=\"#\" role=\"button\" id=\"order-item-options\" data-id=\"status\" data-value=\"\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-three-dots-vertical order-item-options\" viewBox=\"0 0 16 16\"><path d=\"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\"/></svg>\n            </a>\n            <ul class=\"dropdown-menu\" aria-labelledby=\"order-item-options\" >\n                <li><a class=\"oio dropdown-item edit-item-note\" data-key=\"edit-item-note\" href=\"#\">${ __('Add note') }</a></li>\n                <li><a class=\"oio dropdown-item d-none\" data-key=\"edit-item-variation\" href=\"#\">${ __('Add variation') }</a></li>\n                <li><a class=\"oio dropdown-ite d-none\" data-key=\"edit-item-price\" href=\"#\">${ __('Adjust price') }</a></li>\n                <li><a class=\"oio dropdown-item text-danger remove-item\" data-key=\"remove-item\" href=\"#\">${ __('Remove') }</a></li>\n            </ul>\n        </div>\n    `;\n\n    return options;\n  },\n  structOrderItemTable: (_this, x, item, isNew = false, options = true) => {\n\n    // console.log(item[x].variations);\n\n    // parse variations\n    let vars = '', output = ''\n    for(let v in item[x].variations){\n\n        // parse variation list\n        let list = ''; for(let l in item[x].variations[v].list) list += item[x].variations[v].list[l].title + \" \";\n        vars += '<div><b>' + item[x].variations[v].title + \"</b> <span>\" + list + \"</span></div> \";\n\n        // meal note\n        if(item[x].variations[v].note !== undefined && item[x].variations[v].note.length > 0) vars += \"<div><b>\" + __('Note') + \"</b> \" + item[x].variations[v].note + \"</div> \";\n    }\n\n    output += '<tr class=\"order-item-row-active\" data-x=\"'+x+'\" data-id=\"'+item[x].id+'\" data-vars=\"'+escape(JSON.stringify(item[x].variations))+'\">';\n    output += '<td ><div class=\"item-title\" contenteditable=\"false\" data-value=\"'+item[x].title+'\" data-sdesc=\"'+(item[x].sdesc ? item[x].sdesc : \"\")+'\">' + item[x].title + '</div><div class=\"item-note text-muted mb-1 '+( (item[x].note.length==0 || item[x].note == '<br>') && !isNew ? \"d-none\" : \"\" )+'\" contenteditable=\"true\" data-value=\"'+item[x].note+'\">' + item[x].note + '</div><div class=\"vars border-primary item-variations my-1 ps-2 text-secondary\" data-value=\"\">' + vars + '</div></td><td class=\"qty\"><div class=\"me-1 me-sm-3 item-qty\" data-value=\"'+item[x].qty+'\">' + item[x].qty + '</div></td><td class=\"tp\"><div class=\"me-1 me-sm-3 item-total\" data-price=\"'+item[x].price+'\" data-value=\"'+item[x].total+'\" >' + priceFormat(_this, item[x].total) + '</div><td class=\"'+(options?'':'d-none')+'\">'+preview.itemOptions(item[x])+'</td></td>';\n    output += '</tr>';\n\n    return output;\n  },\n  suggestOrderItem: (_this) => {\n            \n    onKeyUp('.edit-item', (e) => {\n        \n      // disable some key for better UX\n      var key = e.keyCode || e.charCode;\n      if (key >= 34 && key <= 45) { return; }\n\n      let s  = e.currentTarget.value;\n\n      if(s.length == 1) document.querySelector('.modal-body').scrollTo({\n        top: (document.querySelector('.edit-item').getBoundingClientRect().top - document.querySelector('.modal-body-cont').getBoundingClientRect().top) - 20,\n        behavior: \"smooth\"\n      });\n\n      // empty search string\n      if(s.length==0 || e.currentTarget !==document.activeElement) { document.querySelector('.s-list').dataset.toggle = false; return; }\n\n      // do API query\n      fetch('https://api-v1.kenzap.cloud/', {\n          method: 'post',\n          headers: headers,\n          body: JSON.stringify({\n              query: {\n                  products: {\n                      type:       'find',\n                      key:        'ecommerce-product',\n                      fields:     ['_id', 'id', 'img', 'status', 'variations', 'price', 'title'],\n                      limit:      _this.state.slist,\n                      // only suggesting products with status public\n                      term:       [\n                                    {\n                                        type: \"string\",\n                                        field: \"status\",\n                                        relation: \"=\",\n                                        value: \"1\",\n                                    }\n                                  ],\n                      offset:     s.length > 0 ? 0 : getPageNumber() * _this.state.slist - _this.state.slist,    // automatically calculate the offset of table pagination\n                      search:     {                                                           // if s is empty search query is ignored\n                                      field: 'title',\n                                      s: s\n                                  },\n                      sortby:     {\n                                      field: 'title',\n                                      order: 'DESC'\n                                  },\n                  }\n              }\n          })\n      })\n      .then(response => response.json())\n      .then(response => {\n\n          // hide UI loader\n          hideLoader();\n\n          // console.log(response);\n\n          if(response.success){\n\n              _this.state.productsSuggestions = response.products;\n\n              let options = ``;\n              response.products.forEach((product, index) => {\n\n                  // options += `<option class=\"pso\" data-id=\"${ product._id }\" data-title=\"${ product.title }\" data-index=\"${ index }\" value=\"${ product.title }\">${ product.title }</option>`; \n                  options += `<li class=\"s-list-item py-1\" data-id=\"${ product._id }\" data-title=\"${ product.title }\" data-index=\"${ index }\"  data-display=\"true\" data-highlight=\"false\">${ product.title }</li>`; \n              });\n              document.querySelector('.s-list').innerHTML = options;\n              document.querySelector('.s-list').dataset.toggle = true;\n\n              // suggestion click listener \n              onClick('.s-list-item', (e) => {\n\n                  let index = e.currentTarget.dataset.index;\n\n                  // console.log(index);\n                  // console.log(_this.state.productsSuggestions[index]);\n                  \n                  document.querySelector('.edit-item').dataset.index = index;   \n                  document.querySelector('.edit-item').dataset.id = _this.state.productsSuggestions[index]._id;   \n                  document.querySelector('.edit-item').value = _this.state.productsSuggestions[index].title;   \n                  document.querySelector('.edit-qty').value = 1;\n                  document.querySelector('.edit-qty').dataset.price = _this.state.productsSuggestions[index].price;\n                  document.querySelector('.edit-tp').value = _this.state.productsSuggestions[index].price;\n                  document.querySelector('.edit-tp').dataset.price = _this.state.productsSuggestions[index].price;\n                  document.querySelector('.s-list').dataset.toggle = false;\n\n                  let calcItemTotal = () => {\n\n                      let total = parseFloat(document.querySelector('.edit-qty').value) * parseFloat(document.querySelector('.edit-qty').dataset.price);\n                      if(isNaN(total)) total = \"\";\n                      document.querySelector('.edit-tp').value = total;\n                  }\n\n                  // auto update price when quantity is changed\n                  document.querySelector('.edit-qty').addEventListener('keypress', (e)=>{\n\n                      // console.log(e.which);\n                      if(e.which != 8 && isNaN(String.fromCharCode(e.which))){\n\n                          e.preventDefault(); // stop character from entering input\n                          return false;\n                      }\n\n                  });\n\n                  document.querySelector('.edit-qty').addEventListener('keydown', (e)=>{\n\n                      // console.log('keydown');\n                      setTimeout(() => { calcItemTotal(); }, 300);\n\n                  });\n\n                  // price can be float number only\n                  document.querySelector('.edit-tp').addEventListener('keypress', (e)=>{\n\n                      // console.log(e.which);\n                      if(e.which != 8 && e.which != 46 && isNaN(String.fromCharCode(e.which))){\n\n                          e.preventDefault(); // stop character from entering input\n                          return false;\n                      }\n                  });\n\n                  // focus on quantity field\n                  document.querySelector('.edit-qty').focus();\n                  document.querySelector('.edit-qty').select();   \n                  \n                  // parse selected product variations\n                  // console.log('parseVariations');\n                  document.querySelector('.item-vars-input').innerHTML = parseVariations(_this, _this.state.productsSuggestions[index]);\n\n              });\n\n          }else{\n\n              parseApiError(response);\n          }\n      })\n      .catch(error => { console.log(error); parseApiError(error); });\n\n    });\n  },\n  tableOrderItemListeners: (e) => {\n\n    // make note field visible below the order item\n    onClick('.edit-item-note', (e) => {\n\n        e.preventDefault();\n\n        let noteEl = e.currentTarget.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector('.item-note');\n        console.log(noteEl);\n        noteEl.classList.remove('d-none');\n        noteEl.focus();\n    });\n\n    // remove order item\n    onClick('.remove-item', (e) => {\n\n        e.preventDefault();\n\n        e.currentTarget.parentElement.parentElement.parentElement.parentElement.parentElement.remove();\n\n        // if(preview._this.state.orderSingle._id == 'new') \n        preview.refreshTotals();\n    });\n  },\n  refreshTotals: () => {\n\n    // clear previous calculations\n    if(document.querySelector('.order-total')) document.querySelector('.order-total').remove();\n    if(document.querySelector('.keyx-total')) document.querySelector('.keyx-total').remove();\n    if(document.querySelector('.keyx-total_tax')) document.querySelector('.keyx-total_tax').remove();\n    if(document.querySelector('.keyx-total_with_tax')) document.querySelector('.keyx-total_with_tax').remove();\n\n    let html = \"\", totals = { total: { title: __('Total'), amount: 0 }, total_tax: { title: __('Tax'), amount: 0 }, total_with_tax: { title: __('Paid'), amount: 0 } };\n    for(let price of document.querySelectorAll('.item-total')){\n\n        let tax = makeNumber(price.dataset.value) * 0.09;\n        totals['total'].amount += makeNumber(price.dataset.value);\n        totals['total_tax'].amount += tax\n        totals['total_with_tax'].amount += (makeNumber(price.dataset.value) + tax);\n    };\n\n    for(let i in totals){\n\n        let display = totals[i].title;\n        if(i == 'total_tax') display = preview._this.state.settings.tax_display + \" (\" + preview._this.state.settings.tax_rate + \"%):\";\n\n        html += `\n        <div class=\"mb-3 mt-3 order-row elipsized keyx-${i}\">\n            <b>${ display }</b><div class=\"order-form ms-2 d-inline-block\" data-id=\"${ i }\" data-type=\"key-number\" data-value=\"${ totals[i].amount }\">${ priceFormat(preview._this, totals[i].amount) }</div>\n        </div>`;\n    }\n\n    html = `<div class=\"order-total\">${ html }</div>`;\n\n    document.querySelector('.modal-body-cont').insertAdjacentHTML(\"beforeend\", html);\n\n    // return html;\n  },\n  /*\n  order JSON structure example\n  {\n      \"id\": \"pDqeWHGI1648563700945\",\n      \"idd\": \"ItqvUvlY1648563462357\",\n      \"kid\": \"7851\",\n      \"sid\": \"1000452\",\n      \"from\": \"1 - WP Asia\",\n      \"name\": \"WP Asia\",\n      \"customer\": {\n\n\n      },\n      \"note\": \"\",\n      \"note_vendor\": \"\",\n      \"step\": 1,\n      \"items\": [\n          {\n              \"id\": \"24adf24670cf977efe9386b781c9dc18124ac54b\",\n              \"qty\": 2,\n              \"note\": \"\",\n              \"type\": \"new\",\n              \"index\": \"27\",\n              \"price\": 10,\n              \"sdesc\": \"Deep Fried Gyoza with Mentai Sauce\",\n              \"title\": \"11. MENTAI GYOZA\",\n              \"total\": 20,\n              \"variations\": []\n          },\n          {\n              \"id\": \"c070bdb900bb47605b0056f96e7c4c9108fa22fe\",\n              \"qty\": 1,\n              \"note\": \"\",\n              \"type\": \"new\",\n              \"index\": \"24\",\n              \"price\": 8,\n              \"sdesc\": \"Deep-fried Sweet Prawn\",\n              \"title\": \"8. AMAEBI KARAAGE\",\n              \"total\": 8,\n              \"variations\": []\n          }\n      ],\n      \"table\": \"1\",\n      \"total\": 28,\n      \"status\": \"new\",\n      \"created\": 1648563701,\n      \"updated\": 1648563701\n  }\n  */\n  addOrderItem: (_this) => {\n\n    onClick('.add-item', (e) => {\n\n      let x = 0, itemArr = [], item = {};\n\n      item.id = document.querySelector('.edit-item').dataset.id;   \n      item.title = document.querySelector('.edit-item').value;   \n      item.total = parseFloat(document.querySelector('.edit-tp').value);\n      item.price = parseInt(document.querySelector('.edit-tp').dataset.price);\n      item.qty = parseInt(document.querySelector('.edit-qty').value);\n      item.note = \"\";\n      item.variations = [];\n\n      // working\n      let count = 0;\n      let list = document.querySelectorAll(\".item-vars-input input\");\n      for(const inp of list){\n\n            // console.log(v.checked);\n            // let v = parseInt(inp.dataset.indexv);\n\n            let v = count;\n            if(inp.checked){\n\n                if(!item.variations[v]) item.variations[v] = {};\n\n                if(!item.variations[v].list) item.variations[v].list = {};\n\n                if(!item.variations[v].title) item.variations[v].title = inp.dataset.titlev;\n\n                // cache selected variations\n                item.variations[v].list[\"_\"+inp.dataset.index] = { title: inp.dataset.title, price: parseFloat(inp.dataset.price) }; \n\n                item.total += item.qty * parseFloat(inp.dataset.price);\n                \n                count +=1;\n            }\n      }\n\n      // console.log(item.variations);\n\n      // handle variations\n    //   let count = 0;\n    //   for(const cbg of document.querySelectorAll(\".item-vars-input .kp-check input[type=checkbox][data-indexv='\"+v+\"']\")){\n\n    //       // checks if this block is required and allows checkout\n    //       if(cb.dataset.required==\"1\"){ if(count) item.variations[v].allow = true; }else{ cart.state.product.variations[v].allow = true; }\n\n    //       // cache selected variations\n    //       if(cbg.checked){ cart.state.product.variations[v].list[\"_\"+cbg.dataset.index] = {title: cbg.dataset.title, price: parseFloat(cbg.dataset.price) }; count +=1; }\n    //   }\n\n    //   // let count = 0;\n    //   for(const rag of document.querySelectorAll(\".item-vars-input .kp-radio input[type=radio][data-indexv='\"+v+\"']\")){\n      \n    //       // console.log(rag.dataset.price);\n\n    //       // cache selected variations\n    //       if(rag.checked){ cart.state.product.variations[v].list[\"_\"+rag.dataset.index] = {title: rag.dataset.title, price: parseFloat(rag.dataset.price) }; count +=1; }\n          \n    //       // checks if this block is required and allows checkout\n    //       if(cb.dataset.required==\"1\"){ if(count) cart.state.product.variations[v].allow = true; }else{ cart.state.product.variations[v].allow = true; }\n    //   }\n\n\n      if(item.title.length<2){ alert(__('Incorrect product data')); return; }\n\n      itemArr.push(item);\n\n      let itemRow = preview.structOrderItemTable(_this, x, itemArr, true);\n\n      document.querySelector('.new-item-row').insertAdjacentHTML(\"beforebegin\", itemRow);\n\n      preview.tableOrderItemListeners();\n\n      // calculate totals for new orders only\n      // if(_this.state.orderSingle._id == 'new') \n      preview.refreshTotals();\n\n      // clear fields\n      document.querySelector('.edit-item').value = \"\";   \n      document.querySelector('.edit-tp').value = \"\";\n      document.querySelector('.edit-qty').value = \"\";\n      document.querySelector(\".item-vars-input\").innerHTML = \"\";\n\n      // focus back to the input field\n      setTimeout(() => { document.querySelector('.edit-item').focus(); }, 300);\n    });\n  },\n}","import { headers, showLoader, hideLoader, onClick, onKeyUp, simulateClick, parseApiError, spaceID, toast } from '@kenzap/k-cloud';\nimport { timeConverterAgo, priceFormat, getPageNumber, makeNumber, parseVariations, escape, unescape } from \"../_/_helpers.js\"\nimport { preview } from \"../_/_order_preview.js\"\n\nexport const print = {\n\n    viewOrder: (_this) => {\n\n        print._this = _this;\n        onClick('.print-order', (e) => { print.renderOrder(_this, e); });\n    },\n    renderOrder: (_this, e) => {\n\n        e.preventDefault();\n        \n        const date = new Date();\n        let i = e.currentTarget.dataset.index; // _this.state.orderPreviewIndex = i;\n        _this.state.orderSingle = _this.state.orders[i];\n        let o = _this.state.orders[i];\n\n        o.entity = \"Fu Zhen Seafood\";\n\n        let data = {};\n        data.print = _this.state.settings.receipt_template;\n\n        // kenzapprint://kenzapprint.app?data=${ encodeURIComponent(JSON.stringify(applink)) }\n\n        // var today = new Date();\n        // var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\n        // var time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n\n        // order id\n        data.print = data.print.replace(/{{order_id_short}}/g, o.id.substr(0, 5));\n\n        // current time\n        data.print = data.print.replace(/{{date_time}}/g,   date.toLocaleString([], { dateStyle: 'medium', timeStyle: 'short', }));\n\n        // order items\n        let items = '';\n        for(let i in o.items){\n\n            items += `[L]<b>${ o.items[i].qty } X ${ o.items[i].title }</b>[R]${ priceFormat(_this, o.items[i].total) }\\n`;\n            for(let v in o.items[i].variations){\n    \n                items += `[L]| ${ o.items[i].variations[v].title }:`;\n                for(let l in  o.items[i].variations[v].list) items += ` ${ o.items[i].variations[v].list[l].title },`;\n\n                if(items.endsWith(',')) items = items.substring(0, items.length - 1) + '\\n';\n\n                // parse variation list\n                // let list = ''; for(let l in item[x].variations[v].list) list += item[x].variations[v].list[l].title + \" \";\n                // vars += '<div><b>' + item[x].variations[v].title + \"</b> <span>\" + list + \"</span></div> \";\n        \n                // // meal note\n                // if(item[x].variations[v].note !== undefined && item[x].variations[v].note.length > 0) vars += \"<div><b>\" + __('Note') + \"</b> \" + item[x].variations[v].note + \"</div> \";\n            }\n        }\n        if(items.endsWith('\\n')) items = items.substring(0, items.length - 2);\n        data.print = data.print.replace(/{{order_items}}/g, items);\n\n        // order note\n        let note = o.note.length == 0 || o.note == '<br>' ? '' : o.note;\n        if(note.length>0){\n            //  data.print += '[C]================================';\n            data.print = data.print.replace(/{{order_note}}/g, '[C]================================\\n' + note + '\\n[C]================================\\n');\n        }\n        // if(note.length>0) data.print += '[C]================================';\n\n        // order totals\n        data.print = data.print.replace(/{{total}}/g, priceFormat(_this, o.price.total));\n        data.print = data.print.replace(/{{total_tax}}/g, priceFormat(_this, o.price.tax_total));\n        data.print = data.print.replace(/{{grand_total}}/g, priceFormat(_this, o.price.grand_total));\n        \n        // debug vs actual print\n        data.debug = false;\n\n\n        // let click = document.querySelector(\".print-order[data-id='\"+e.currentTarget.dataset.id+\"']\");\n\n\n        // click.setAttribute('href', 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data)));\n\n        // e.currentTarget.setAttribute('href', 'kenzapprint://kenzapprint.app?data='+JSON.stringify(data));\n\n        console.log('kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data)));\n\n        toast(__('Printing j'));\n\n        // return true;\n\n        location.href = 'kenzapprint://kenzapprint.app?data='+encodeURIComponent(JSON.stringify(data));\n\n        return false;\n        \n        // window.location.href = 'kenzapprint://kenzapprint.app?data='+JSON.stringify(data);\n        // simulateClick(click);\n\n        \n    }\n}","export const HTMLContent = (__) => {\n\n    return `\n      <div class=\"container ec-orders\">\n        <div class=\"d-md-flex justify-content-between bd-highlight mb-3\">\n            <nav class=\"bc\" aria-label=\"breadcrumb\"></nav>\n            <button class=\"btn btn-primary add-order btn-add mt-3 mb-1 mt-md-0 mb-md-0\" type=\"button\">${ __('New order') }</button>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-md-12 page-title\">\n            <div class=\"st-opts st-table mb-3 dropdown\">\n                <a class=\"btn btn-outline-secondary dropdown-toggle\" href=\"#\" role=\"button\" id=\"order-status\" data-id=\"status\" data-value=\"\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                  ${ __('All') }\n                </a>\n                <ul class=\"dropdown-menu\" aria-labelledby=\"order-status\">\n                  <li><a class=\"dppi dropdown-item\" data-key=\"\" href=\"#\" >${ __('All') }</a></li>\n                  <li><a class=\"dppi dropdown-item\" data-key=\"new\" href=\"#\" >${ __('New') }</a></li>\n                  <li><a class=\"dppi dropdown-item\" data-key=\"paid\" href=\"#\" >${ __('Paid') }</a></li>\n                  <li><a class=\"dppi dropdown-item\" data-key=\"processing\" href=\"#\" >${ __('Processing') }</a></li>\n                  <li><a class=\"dppi dropdown-item\" data-key=\"completed\" href=\"#\" >${ __('Completed') }</a></li>\n                  <li><a class=\"dppi dropdown-item\" data-key=\"canceled\" href=\"#\" >${ __('Canceled') }</a></li>\n                  <li><a class=\"dppi dropdown-item\" data-key=\"failed\" href=\"#\" >${ __('Failed') }</a></li>\n                  <li><a class=\"dppi dropdown-item\" data-key=\"refunded\" href=\"#\" >${ __('Refunded') }</a></li>\n                </ul>\n            </div>\n            <div class=\"st-opts\" >\n              <div class=\"input-group-sm mb-0 justify-content-start mb-3 mb-sm-0\" >\n                <input id=\"usearch\" type=\"text\" class=\"inp form-control search-input\" autocomplete=\"off\" placeholder=\"${ __('Search order') }\">\n              </div>\n              <!-- <a id=\"viewSum\" href=\"#\" style=\"margin-left:16px;\">view summary</a> -->\n            </div>\n          </div>\n        </div>\n\n        <div class=\"row\">\n          <div class=\"col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card\">\n            <div class=\"card border-white shadow-sm border-0\">\n              <div class=\"card-body p-0\">\n \n                <div class=\"table-responsive\">\n                  <table class=\"table table-hover table-borderless align-middle table-striped table-p-list mb-0\">\n                    <thead>\n                      <tr>\n                        <th><span class=\"ps-1\">${ __('From') }</span></th>\n                        <th class=\"d-none d-sm-table-cell\">${ __('Status') }</th>\n                        <th>${ __('Total') }</th>\n                        <th class=\"d-none d-sm-table-cell\">${ __('Time') }</th>\n                        <th></th>\n                      </tr>\n                    </thead>\n                    <tbody class=\"list\">\n\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"modal order-modal\" tabindex=\"-1\" data-backdrop=\"static\" data-keyboard=\"false\">\n        <div class=\"modal-dialog \">\n          <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h5 class=\"modal-title\"></h5>\n                <button type=\"button\" class=\"btn-close align-self-start-remove\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n              </div>\n              <div class=\"modal-body\">\n              \n              </div>\n              <div class=\"modal-footer\">\n                <button type=\"button\" class=\"btn btn-primary btn-confirm\"></button>\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\"></button>\n              </div>\n          </div>\n        </div>\n      </div>\n\n    `;\n}","// js dependencies\nimport { headers, showLoader, hideLoader, initHeader, initFooter, initBreadcrumbs, parseApiError, getCookie, onClick, onKeyUp, spaceID, toast, link, onChange } from '@kenzap/k-cloud';\nimport { timeConverterAgo, priceFormat, getPageNumber, makeNumber, unescape, mt, printReceipt } from \"../_/_helpers.js\"\nimport { preview } from \"../_/_order_preview.js\"\nimport { print } from \"../_/_order_print.js\"\nimport { HTMLContent } from \"../_/_cnt_orders.js\"\n\n// where everything happens\nconst _this = {\n  \n    state: {\n        firstLoad: true,\n        firstTouch: true,\n        modalCont: null,\n        modalOpen: false,\n        playSoundNow: false,\n        newOrderCount: 0,\n        orderIDs: [],\n        printLink: null, // storing receipt print pending order \n        orders: [], // where all requested orders are cached\n        settings: {}, // where all requested settings are cached\n        orderSingle: [], // where single order is stored during preview\n        playTitleTimer: null,\n        refreshTimer: null,\n        statuses: [],\n        audio: new Audio('https://kenzap.com/static/swiftly.mp3'),\n        limit: 50, // number of records to load per table\n        slistLimit: 10, // product suggestion fetch search limit\n        productsSuggestions: []\n    },\n    init: () => {\n         \n        // load data\n        _this.getData();\n\n        // turn on data polling for new orders\n        _this.state.refreshTimer = setInterval(() => { _this.getDataNew(); }, 10000);\n    },\n    getDataNew: () => {\n\n        // do API query\n        fetch('https://api-v1.kenzap.cloud/', {\n            method: 'post',\n            headers: headers,\n            body: JSON.stringify({\n                query: {\n                    orders: {\n                        type:       'find',\n                        key:        'ecommerce-order',\n                        fields:     '*',\n                        term:       [\n                            {\n                                type: \"string\",\n                                field: \"status\",\n                                relation: \"=\",\n                                value: \"new\",\n                            },\n                            {\n                                type: \"string\",\n                                field: \"status\",\n                                relation: \"=\",\n                                value: \"paid\",\n                            }\n                        ],\n                        limit:      1,\n                    }\n                }\n            })\n        })\n        .then(response => response.json())\n        .then(response => {\n\n            if(response.success){\n\n                if(response.orders.length){ console.log(response.orders); _this.getData(); }\n\n            }else{\n\n                // parseApiError(response);\n            }\n        })\n        .catch(error => { // parseApiError(error); \n        });\n\n    },\n    getData: () => {\n\n        // show loader during first load\n        if (_this.state.firstLoad) showLoader();\n\n        // check if any print pending receipts\n        if (_this.state.printLink){ window.location.href = _this.state.printLink; _this.state.printLink = null; }\n\n        // search content\n        let s = document.querySelector('.search-input') ? document.querySelector('.search-input').value : '';\n\n        // search term \n        let term = document.querySelector('#order-status') ? document.querySelector('#order-status').dataset.value: '';\n        \n        // do API query\n        fetch('https://api-v1.kenzap.cloud/', {\n            method: 'post',\n            headers: headers,\n            body: JSON.stringify({\n                query: {\n                    user: {\n                        type:       'authenticate',\n                        fields:     ['avatar'],\n                        token:      getCookie('kenzap_token')\n                    },\n                    locale: {\n                        type:       'locale',\n                        source:      ['extension'],\n                        key:         'ecommerce',\n                    },\n                    orders: {\n                        type:       'find',\n                        key:        'ecommerce-order',\n                        fields:     '*',\n                        term:       term != '' ? 'status=\\'' + term +'\\'' : '',\n                        limit:      _this.state.limit,\n                        search:     {                                                           // if s is empty search query is ignored\n                            field: 'from',\n                            s: s\n                        },\n                        sortby:     {\n                            field: 'created',\n                            order: 'DESC'\n                        }\n                    },\n                    settings: {\n                        type:       'get',\n                        key:        'ecommerce-settings',\n                        fields:     ['currency', 'currency_symb', 'currency_symb_loc', 'tax_calc', 'tax_auto_rate', 'tax_rate', 'tax_display', 'receipt_template'],\n                    }\n                }\n            })\n        })\n        .then(response => response.json())\n        .then(response => {\n\n            // hide UI loader\n            hideLoader();\n\n            if(response.success){\n                \n                // init header\n                initHeader(response);\n\n                // get core html content \n                _this.loadPageStructure();  \n\n                // render table\n                _this.renderPage(response);\n\n                // bind content listeners\n                _this.initListeners();\n            \n                // initiate footer\n                _this.initFooter();\n\n                // first load\n                _this.state.firstLoad = false;\n\n            }else{\n\n                parseApiError(response);\n            }\n        })\n        .catch(error => { parseApiError(error); });\n    },\n    authUser: (response) => {\n\n        if(response.user){\n            \n            if(response.user.success == true){\n\n                \n            }\n        }\n    },\n    loadPageStructure: () => {\n\n        if(!_this.state.firstLoad) return;\n\n        // get core html content \n        document.querySelector('#contents').innerHTML = HTMLContent(__);\n    },\n    renderPage: (response) => {\n\n        if(_this.state.firstLoad){\n\n            // initiate breadcrumbs\n            initBreadcrumbs(\n                [\n                    { link: link('https://dashboard.kenzap.cloud'), text: __('Dashboard') },\n                    { link: link('/'), text: __('E-commerce') },\n                    { text: __('Orders') }\n                ]\n            );\n\n            // initialize statuses\n            _this.state.statuses = {\n                'new': { \n                    text: __('New'),\n                    class: 'btn-warning text-dark fw-light'\n                },\n                'paid': { \n                    text: __('Paid'),\n                    class: 'btn-primary fw-light'\n                },\n                'processing': { \n                    text: __('Processing'),\n                    class: 'btn-primary fw-light'\n                },\n                'completed': { \n                    text: __('Completed'),\n                    class: 'btn-success fw-light'\n                },\n                'canceled': { \n                    text: __('Canceled'),\n                    class: 'btn-secondary fw-light'\n                },\n                'failed': { \n                    text: __('Failed'),\n                    class: 'btn-danger fw-light'\n                },\n                'refunded': { \n                    text: __('Refunded'),\n                    class: 'btn-danger fw-light'\n                }\n            };\n        }\n\n        // cache orders globally\n        _this.state.orders = response.orders;\n        \n        // cache settings globally\n        _this.state.settings = response.settings;\n\n        // no orders in the list\n        if (response.orders.length == 0) {\n\n            document.querySelector(\".table tbody\").innerHTML = `<tr><td colspan=\"5\">${ __(\"No orders to display.\") }</td></tr>`;\n            return;\n        }\n\n        // generate website table\n        let orderIDsTemp = [];\n        _this.state.newOrderCount = [];\n\n        let list = '', count_new = 0;\n        for (let i in response.orders){\n\n            let img = 'https://cdn.kenzap.com/loading.png';\n            orderIDsTemp.push(response.orders[i]._id);\n\n            if(typeof(response.orders[i].status) === 'undefined') response.orders[i].status = 'new';\n\n            if(response.orders[i].status == 'new') count_new ++;\n            // if(typeof(response.products[i].img) === 'undefined') response.products[i].img = [];\n            // // if(typeof(response.products[i].img) !== 'undefined' && response.products[i].img[0] == 'true') img = 'https://preview.kenzap.cloud/S1000452/_site/images/product-'+response.products[i].id+'-1-100x100.jpeg?1630925420';\n            // if(response.products[i].img[0]) img = CDN + '/S'+sid+'/product-'+response.products[i]._id+'-1-100x100.jpeg?'+response.products[i].updated;\n                \n            let applink = {\"print\":\"[C]<u><font size=\\\"big\\\">ORDER{{order_id_short}}</font></u>\\n[C]Fu Zhen Seafood\\n[C]<u type=double>{{date_time}}</u>\\n[C]\\n[C]================================\\\" \\n[L]\\n[L]<b>BEAUTIFUL SHIRT</b>[R]9.99€\\n[L]  + Size : S\\n[L]\\n[L]<b>AWESOME HAT</b>[R]24.99€\\n[L]  + Size : 57/58\\n[L]\\n[C]--------------------------------\\n[R]TOTAL PRICE :[R]34.98€\\n[R]TAX :[R]4.23€\"};\n            let classN = ((_this.state.orderIDs.includes(response.orders[i]._id) || _this.state.firstLoad)?'':'new');\n            list += `\n            <tr class=\"${ classN }\">\n              <td class=\"details\">\n                <div class=\"ps-1 view-order\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\">\n                  <b class=\"\">${ (response.orders[i].id) }</b> ${ response.orders[i].from }\n                  <div class=\" elipsized fst-italic\">${ response.orders[i].note ? response.orders[i].note : \"\" }</div>\n                  <div class=\" d-sm-none\"> <span class=\"me-2\">${ _this.getStatus(response.orders[i].status) }</span> <span class=\"text-muted\">${ timeConverterAgo(__, response.meta.time, response.orders[i].created) }</span> </div>\n                </div>\n              </td>\n              <td class=\"d-none d-sm-table-cell\">\n                <span class=\"fs-12\">${ _this.getStatus(response.orders[i].status) }</span>\n              </td>\n              <td>\n                <span style=\"font-size:18px;\">${ priceFormat(_this, response.orders[i].total) }</span>\n              </td>\n              <td class=\"d-none d-sm-table-cell\">\n                <span style=\"font-size:18px;\">${ timeConverterAgo(__, response.meta.time, response.orders[i].created) }</span>\n              </td>\n              <td class=\"last\">\n                <a href=\"#\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\" class=\"view-order text-success d-none me-4\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-eye\" viewBox=\"0 0 16 16\">\n                    <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z\"/>\n                    <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z\"/>\n                </svg></a>\n                <a href=\"kenzapprint://kenzapprint.app?data=${ encodeURIComponent(JSON.stringify(applink)) }\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\" class=\"print-order-dis d-none text-success me-2\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"currentColor\" class=\"bi bi-printer me-2\" viewBox=\"0 0 16 16\">\n                    <path d=\"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z\"/>\n                    <path d=\"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z\"/>\n                </svg></a>\n                <a href=\"#\" data-id=\"${ response.orders[i]._id }\" data-index=\"${ i }\" class=\"remove-order text-danger me-2\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"currentColor\" class=\"bi bi-trash\" viewBox=\"0 0 16 16\">\n                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/>\n                    <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"/>\n                </svg></a>\n              </td>\n            </tr>`;\n        }\n        \n        _this.state.playSoundNow = count_new > 0 ? true : false;\n\n        // if(_this.state.playSoundNow) _this.playSound();\n        // if(_this.state.newOrderCount>0) _this.playTitle('('+_this.state.newOrderCount+') new orders.');\n\n        // _this.state.firstLoad = false;\n        _this.state.orderIDs = orderIDsTemp;\n\n        // provide result to the page\n        document.querySelector(\".table tbody\").innerHTML = list;\n    },\n    // parse visual page status\n    getStatus: (status) => {\n    \n        return `<div class=\"badge ${ _this.state.statuses[status].class }\">${ _this.state.statuses[status].text }</div>`;\n    },\n    // play notification sound. Ex.: when new order received\n    playSound: () => {\n \n        \n        // var audiosWeWantToUnlock = [];\n        // audiosWeWantToUnlock.push(new Audio('https://kenzap.com/static/swiftly.mp3'))\n       \n        //where earlier you did:var audiosWeWantToUnlock = []audiosWeWantToUnlock.push(new Audio('mySoundEffect.wav'))audiosWeWantToUnlock.push(new Audio('myOtherSoundEffect.wav'))\n\n        console.log('playSound');\n\n        // const audio = new Audio(\"https://kenzap.com/static/swiftly.mp3\");\n        _this.state.audio.play();\n\n    },\n    playTitle: (msg) => {\n\n        // if(_this.state.playTitleTimer) clearInterval(_this.state.playTitleTimer);\n        // _this.state.playTitleTimer = setInterval(() => { if(_this.state.playSoundNow) _this.playSound(); }, 6500);\n\n        // if(_this.state.playTitleTimer) clearInterval(_this.state.playTitleTimer);\n        // if(_this.state.playTitleTimer2) clearInterval(_this.state.playTitleTimer2);\n    \n        // _this.state.playTitleTimer = setInterval(() => { document.title = \"Orders - Kenzap Cloud\"; }, 1000);\n        // _this.state.playTitleTimer2 = setInterval(() => {  document.title = msg; }, 2050);    \n    },\n    initListeners: () => {\n\n        // view order\n        preview.viewOrder(_this);\n        \n        // remove order\n        onClick('.remove-order', _this.listeners.removeOrder);\n\n        // print order\n        print.viewOrder(_this);\n        // onClick('.print-order', _this.listeners.printOrder);\n\n        // table status change listener\n        onClick('.st-table li a', _this.listeners.changeStatus);\n\n        // break here if initListeners is called more than once\n        if(!_this.state.firstLoad) return;\n\n        // add new order listener\n        preview.newOrder(_this);\n\n        // modal success button\n        onClick('.modal .btn-primary', _this.listeners.modalSuccessBtn);\n        \n        // search orders\n        onKeyUp('.search-input', _this.listeners.searchOrders);\n        // add product modal\n        // onClick('.btn-save', _this.saveSettings);\n        \n        document.body.addEventListener('touchstart', function() {\n\n            if(_this.state.firstTouch){\n\n                _this.state.audio.play();\n                _this.state.audio.pause();\n                _this.state.audio.currentTime = 0\n                _this.state.firstTouch = false;\n            }else{\n\n                // _this.playTitle();\n                if(_this.state.playTitleTimer) clearInterval(_this.state.playTitleTimer);\n                _this.state.playTitleTimer = setInterval(() => { if(_this.state.playSoundNow) _this.playSound(); }, 6500);\n            }\n\n        }, false);\n\n        // android back pressed\n        window.addEventListener(\"hashchange\", function(e) {\n\n            // close modal if still openned\n            // if(window.location.href.indexOf(\"#editing\")==-1) { e.preventDefault(); if(_this.modalCont){ _this.modalCont.hide(); } return false; }\n            if(_this.modalCont){ e.preventDefault(); _this.modalOpen = false; _this.modalCont.hide(); return false; }\n\t\t});\n    },\n    listeners: {\n\n        newOrder: (e) => {\n\n\n        },\n        changeStatus: (e) => {\n\n            e.preventDefault();\n\n            // console.log(e.currentTarget.dataset.key);\n\n            let os = document.querySelector('#order-status');\n            if(e.currentTarget.dataset.key == \"\"){\n                os.innerHTML = __('All')\n                os.dataset.value = '';\n            }else{\n                os.innerHTML = _this.state.statuses[e.currentTarget.dataset.key].text;\n                os.dataset.value = e.currentTarget.dataset.key;\n            }\n\n            let list = [];\n\n            // clear previous classes\n            Object.keys(_this.state.statuses).forEach((key) => {\n                list = _this.state.statuses[key].class.split(' ');\n                list.forEach((key) => { \n                    os.classList.remove(key);\n                });    \n            });\n\n            // add new classes\n            if(e.currentTarget.dataset.key==''){\n                \n                os.classList.add('btn-primary');\n            }else{\n                list = _this.state.statuses[e.currentTarget.dataset.key].class.split(' ');\n                list.forEach((key) => { \n                    os.classList.add(key);\n                });\n            }\n\n            // reload table\n            _this.getData();\n        },\n        removeOrder: (e) => {\n\n            e.preventDefault();\n\n            let c = confirm( __('Completely remove this order?') );\n\n            if(!c) return;\n  \n            // send data\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: headers,\n                body: JSON.stringify({\n                    query: {\n                        product: {\n                            type:       'delete',\n                            key:        'ecommerce-order',   \n                            id:         e.currentTarget.dataset.id,  \n                            sid:        spaceID(),\n                        }\n                    }\n                })\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    // _this.modalCont.hide();\n\n                    _this.getData();\n\n                }else{\n\n                \n                    parseApiError(response);\n                }\n            })\n            .catch(error => {\n                parseApiError(error);\n            });\n        },\n        // printOrder: (e) => {\n\n\n        // },\n        searchOrders: (e) => {\n\n            e.preventDefault();\n\n            // _this.playSound();\n\n            _this.getData();\n\n            // console.log('search products ' +e.currentTarget.value);\n        },\n        \n        modalSuccessBtn: (e) => {\n            \n            _this.listeners.modalSuccessBtnFunc(e);\n        },\n\n        modalSuccessBtnFunc: null\n    },\n    \n    updateOrder: (i, id) => {\n\n        let modal = document.querySelector(\".modal\");\n        if(modal.querySelector(\".btn-confirm\").dataset.loading === 'true') return;\n\n        modal.querySelector(\".btn-confirm\").dataset.loading = true;\n        modal.querySelector(\".btn-confirm\").innerHTML = '<span class=\"spinner-border spinner-border-sm me-2\" role=\"status\" aria-hidden=\"true\"></span>' + __('Loading..');\n\n        let data = {};\n\n        // iterate through all fields\n        for(let s of document.querySelectorAll('.order-form')){\n\n            switch(s.dataset.type){\n          \n                // case 'html': data[s.dataset.id] = s.innerHTML; break;\n                case 'key': \n                    data[s.dataset.id] = s.dataset.value; \n                    break;\n                case 'key-number': \n                    data[s.dataset.id] = makeNumber(s.dataset.value); \n                    break;\n                case 'items':   \n\n                    // data['items'] = {};\n                    data['items'] = [];\n                    for(let item of document.querySelectorAll('.order-item-row-active')){\n\n                        let vars = JSON.parse(unescape(item.dataset.vars));\n                        // data['items'][item.dataset.id] =\n                        data['items'].push(\n                            {\n                                \"id\": item.dataset.id,\n                                \"qty\": parseInt(item.querySelector('.item-qty').dataset.value),\n                                \"note\": item.querySelector('.item-note').innerHTML,\n                                \"type\": \"new\",\n                                \"index\": \"0\",\n                                \"price\": parseFloat(item.querySelector('.item-total').dataset.price),\n                                \"sdesc\": item.querySelector('.item-title').dataset.sdesc,\n                                \"title\": item.querySelector('.item-title').dataset.value,\n                                // \"priceF\": parseFloat(item.querySelector('.item-total').dataset.value),\n                                \"total\": parseFloat(item.querySelector('.item-total').dataset.value),\n                                \"variations\": id == 'new' ? [] : vars ? vars : [],\n                            }\n                        );\n                    }\n                    \n                break\n                case 'text':   \n                    data[s.dataset.id] = s.innerHTML;\n                    break;\n                case 'email':  \n                case 'emails':  \n                case 'select':\n                case 'textarea': \n                    data[s.id] = s.value; \n                    break;\n                case 'radio': \n                    data[s.id] = s.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector('input:checked').value; \n                    break;\n            }\n        }\n\n\n        // we use this data to generate analytical reports\n        let dateObj = new Date();\n        data['created_ymd'] = dateObj.getUTCFullYear() + '' + mt(dateObj.getUTCMonth() + 1) + '' + mt(dateObj.getUTCDate());\n        data['created_ym'] = dateObj.getUTCFullYear() + '' + mt(dateObj.getUTCMonth() + 1);\n        data['created_y'] = dateObj.getUTCFullYear() + '';\n\n        // console.log(data);\n\n        // create new order\n        if(id == 'new'){\n\n            // additional required fields\n            data['name'] = data['from'];\n            data['customer'] = {\n                \"first_name\": data['from'],\n                \"last_name\": \"\",\n                \"kid\": 0,\n            };\n            \n            // get last order ID number\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: headers,\n                body: JSON.stringify({\n                    query: {\n                        settings: {\n                            type:       'get',\n                            key:        'ecommerce-settings',\n                            fields:     ['last_order_id'],\n                        }\n                    }\n                })\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    data['id'] = makeNumber(response.settings.last_order_id) + 1;\n\n                    // console.log(\"number: \" + data['id']);\n\n                    // create new order\n                    fetch('https://api-v1.kenzap.cloud/', {\n                        method: 'post',\n                        headers: headers,\n                        body: JSON.stringify({\n                            query: {\n                                order: {\n                                    type:       'create',\n                                    key:        'ecommerce-order',        \n                                    sid:        spaceID(),\n                                    data:       data\n                                }\n                            }\n                        })\n                    })\n                    .then(response => response.json())\n                    .then(response => {\n\n                        if (response.success){\n\n                            _this.modalCont.hide();\n\n                            toast( __('Order created') );\n\n                            if(_this.state.printLink) _this.state.printLink = printReceipt(_this, data);\n\n                            _this.getData();\n\n                        }else{ parseApiError(response); }\n                    })\n                    .catch(error => { parseApiError(error); });\n\n                    // save next assigned number\n                    fetch('https://api-v1.kenzap.cloud/', {\n                        method: 'post',\n                        headers: headers,\n                        body: JSON.stringify({\n                            query: {\n                                settings: {\n                                    type:       'set',\n                                    key:        'ecommerce-settings',        \n                                    sid:        spaceID(),\n                                    data:       {\n                                        last_order_id: data['id']\n                                    }\n                                }\n                            }\n                        })\n                    })\n                    .then(response => response.json())\n                    .then(response => { if (!response.success){ parseApiError(response); } })\n                    .catch(error => {  parseApiError(error); });   \n                \n                }else{ parseApiError(response); }\n            })\n            .catch(error => { parseApiError(error); });\n\n        // update existing order\n        }else{\n\n            // send data\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: headers,\n                body: JSON.stringify({\n                    query: {\n                        order: {\n                            type:       'update',\n                            key:        'ecommerce-order',        \n                            sid:        spaceID(),\n                            id:         id,\n                            data:       data\n                        }\n                    }\n                })\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    _this.modalCont.hide();\n\n                    toast( __('Order updated') );\n\n                    if(_this.state.printLink) _this.state.printLink = printReceipt(_this, data);\n                    \n                    _this.getData();\n\n                }else{\n\n                    parseApiError(response);\n                }\n            })\n            .catch(error => {\n                parseApiError(error);\n            });\n        }\n    },\n    initFooter: () => {\n        \n        initFooter(__('Created by %1$Kenzap%2$. ❤️ Licensed %3$GPL3%4$.', '<a class=\"text-muted\" href=\"https://kenzap.com/\" target=\"_blank\">', '</a>', '<a class=\"text-muted\" href=\"https://github.com/kenzap/ecommerce\" target=\"_blank\">', '</a>'), '');\n        // initFooter(__('Copyright © %1$ %2$ Kenzap%3$. All rights reserved.', new Date().getFullYear(), '<a class=\"text-muted\" href=\"https://kenzap.com/\" target=\"_blank\">', '</a>'), __('Kenzap Cloud Services - Dashboard'));\n    }\n}\n\n_this.init();"],"names":["mt","val","length","getPageNumber","urlParams","URLSearchParams","window","location","search","page","get","parseInt","priceFormat","_this","price","makeNumber","Math","round","parseFloat","toFixed","state","settings","currency_symb_loc","currency_symb","timeConverterAgo","__","now","time","past","a","Date","months","year","getFullYear","month","getMonth","date","getDate","getHours","getMinutes","getSeconds","parseVariations","product","html_vars","variations","v","type","title","required","d","data","checked","escape","htmlStr","replace","unescape","printReceipt","order","o","row","txt","end_ofst","output","max_char","max_ofst","ofst_prev","ofst","ci","i","ceil","e","substr","debug","print","receipt_template","console","log","id","toLocaleString","dateStyle","timeStyle","items","total","qty","l","list","endsWith","substring","note","tax_total","discount_total","grand_total","order_totals","fee_total","fee_display","tax_display","qr_settings","slug","document","querySelector","value","str","encodeURIComponent","JSON","stringify","preview","renderOrder","modal","modalCont","bootstrap","Modal","modalOpen","currentTarget","dataset","index","history","pushState","pageID","pathname","addEventListener","href","indexOf","orderSingle","_id","created","from","idd","kid","name","sid","spaceID","status","step","table","updated","orders","Object","keys","statuses","forEach","key","text","statusSelect","classList","add","innerHTML","loading","html","fields","editable","fname","lname","bios","avatar","email","countryr","cityr","addr1","addr2","post","c1","c2","c3","c4","c5","x","undefined","field","renderField","show","tableOrderItemListeners","suggestOrderItem","setTimeout","toggle","addOrderItem","refreshTotals","focus","onClick","preventDefault","simulateClick","printLink","listeners","modalSuccessBtnFunc","updateOrder","osm","split","remove","newOrder","viewOrder","item","structOrderItemTable","itemOptions","options","isNew","vars","sdesc","onKeyUp","keyCode","charCode","s","scrollTo","top","getBoundingClientRect","behavior","activeElement","fetch","method","headers","body","query","products","limit","slist","term","relation","offset","sortby","then","response","json","hideLoader","success","productsSuggestions","calcItemTotal","isNaN","which","String","fromCharCode","select","parseApiError","error","noteEl","parentElement","totals","amount","total_tax","total_with_tax","querySelectorAll","tax","display","tax_rate","insertAdjacentHTML","itemArr","count","inp","titlev","alert","push","itemRow","entity","toast","HTMLContent","firstLoad","firstTouch","playSoundNow","newOrderCount","orderIDs","playTitleTimer","refreshTimer","audio","Audio","slistLimit","init","getData","setInterval","getDataNew","showLoader","user","token","getCookie","locale","source","initHeader","loadPageStructure","renderPage","initListeners","initFooter","authUser","initBreadcrumbs","link","orderIDsTemp","count_new","applink","classN","includes","getStatus","meta","playSound","play","playTitle","msg","removeOrder","changeStatus","modalSuccessBtn","searchOrders","pause","currentTime","clearInterval","hide","os","c","confirm","parse","dateObj","getUTCFullYear","getUTCMonth","getUTCDate","last_order_id"],"mappings":"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"}